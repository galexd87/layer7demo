{
  "goid": "e001cfd0c1c1ffaa18e187b5e72fe738",
  "guid": "2c3577d7-151c-468a-9274-7f1c983fc902",
  "name": "OAuth 2.0 Client Helper - REST STS",
  "resolutionPath": "/oauth/v2/samlTokenServer*",
  "serviceType": "WEB_API",
  "checksum": "a79a3069847138da127d36ef34cd518517dacb63",
  "enabled": true,
  "folderPath": "/OTK/Server/Internal/Tools/OAuth 2.0 Test Clients",
  "methodsAllowed": [
    "GET",
    "POST",
    "PUT",
    "DELETE"
  ],
  "tracingEnabled": false,
  "wssProcessingEnabled": false,
  "laxResolution": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"This is a SAML token server used by SAML grant type test client\"/>\n        </L7p:CommentAssertion>\n        <L7p:SslAssertion/>\n        <L7p:HttpBasic/>\n        <L7p:Authentication>\n            <L7p:IdentityProviderOid goidValue=\"0000000000000000fffffffffffffffe\"/>\n        </L7p:Authentication>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6\"/>\n            <L7p:PolicyName stringValue=\"OTK Security Header Extension\"/>\n        </L7p:Include>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:AddHeader>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"HTTPS only\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Inform the browser to only accept SSL connections\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:HeaderName stringValue=\"Content-Security-Policy\"/>\n                <L7p:HeaderValue stringValue=\"default-src 'self'; script-src 'unsafe-inline'; img-src * data:; style-src 'unsafe-inline'; font-src * data:; require-trusted-types-for 'script'; object-src 'none';\"/>\n                <L7p:RemoveExisting booleanValue=\"true\"/>\n                <L7p:Target target=\"RESPONSE\"/>\n            </L7p:AddHeader>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Override OTK Security Header Extension\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\" Audience restriction must be created in advance as multiple variables are used\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmF1ZGllbmNlX3JlY2lwaWVudF9yZXN0cmljdGlvbn0=\"/>\n            <L7p:VariableToSet stringValue=\"audience_recipient_restriction\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${audience_recipient_restriction}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\" Audience restriction must be created in advance as multiple variables are used\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9\"/>\n                <L7p:VariableToSet stringValue=\"audience_recipient_restriction\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"==DEFAULT\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// if audience_recipient_restriction is empty, set it to ${request.url.protocol}://${request.url.host}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LnVybH0=\"/>\n            <L7p:VariableToSet stringValue=\"samlVersion\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:Expression1 stringValue=\"${samlVersion}\"/>\n                <L7p:Expression2 stringValue=\"saml1\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"CONTAINS\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"CONTAINS\"/>\n                        <L7p:RightValue stringValue=\"saml1\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SamlIssuer>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\" Variable for audience and recipient restriction must be created in advance if more than one variable is referenced\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:AudienceRestriction stringValue=\"${audience_recipient_restriction}\"/>\n                <L7p:AuthenticationStatement samlAuthenticationInfo=\"included\">\n                    <L7p:AuthenticationMethods stringArrayValue=\"included\"/>\n                    <L7p:IncludeAuthenticationContextDeclaration booleanValue=\"false\"/>\n                </L7p:AuthenticationStatement>\n                <L7p:NameQualifier stringValue=\"\"/>\n                <L7p:SubjectConfirmationMethodUri stringValue=\"urn:oasis:names:tc:SAML:1.0:cm:bearer\"/>\n                <L7p:Version boxedIntegerValue=\"1\"/>\n            </L7p:SamlIssuer>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"//generate saml1\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:Expression1 stringValue=\"${samlVersion}\"/>\n                <L7p:Expression2 stringValue=\"saml1\"/>\n                <L7p:Operator operator=\"CONTAINS\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:Operator operator=\"CONTAINS\"/>\n                        <L7p:RightValue stringValue=\"saml1\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SamlIssuer>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\" Variable for audience and recipient restriction must be created in advance if more than one variable is referenced\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:AudienceRestriction stringValue=\"${audience_recipient_restriction}\"/>\n                <L7p:AuthenticationStatement samlAuthenticationInfo=\"included\">\n                    <L7p:AuthenticationMethods stringArrayValue=\"included\"/>\n                    <L7p:IncludeAuthenticationContextDeclaration booleanValue=\"false\"/>\n                </L7p:AuthenticationStatement>\n                <L7p:NameQualifier stringValue=\"\"/>\n                <L7p:SubjectConfirmationMethodUri stringValue=\"urn:oasis:names:tc:SAML:1.0:cm:bearer\"/>\n                <L7p:Version boxedIntegerValue=\"2\"/>\n            </L7p:SamlIssuer>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"//generate saml2\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:EncodeDecode>\n            <L7p:SourceVariableName stringValue=\"issuedSamlAssertion\"/>\n            <L7p:TargetDataType variableDataType=\"string\"/>\n            <L7p:TargetVariableName stringValue=\"samlBase64\"/>\n            <L7p:TransformType transformType=\"BASE64_ENCODE\"/>\n        </L7p:EncodeDecode>\n        <L7p:HardcodedResponse>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"200\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"SAML token response\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64ResponseBody stringValue=\"PGh0bWw+CjxIRUFEPjxNRVRBIEhUVFAtRVFVSVY9J1BSQUdNQScgQ09OVEVOVD0nTk8tQ0FDSEUnPjxNRVRBIEhUVFAtRVFVSVY9J0NBQ0hFLUNPTlRST0wnIENPTlRFTlQ9J05PLUNBQ0hFJz48VElUTEU+U0FNTCAyLjAgQXV0by1QT1NUIGZvcm08L1RJVExFPjwvSEVBRD4KICAgPGJvZHkgb25Mb2FkPSJkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+CjxOT1NDUklQVD5Zb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBKYXZhU2NyaXB0LiAgUGxlYXNlIGNsaWNrIHRoZSAnQ29udGludWUnIGJ1dHRvbiBiZWxvdyB0byBwcm9jZWVkLiA8YnI+PGJyPjwvTk9TQ1JJUFQ+CiAgICAgIDxmb3JtIGFjdGlvbj0iJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlZGlyZWN0X3VyaX0iIG1ldGhvZD0iUE9TVCI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9IlNBTUxSZXNwb25zZSIgdmFsdWU9IiR7c2FtbEJhc2U2NH0iPgo8Tk9TQ1JJUFQ+PElOUFVUIFRZUEU9IlNVQk1JVCIgVkFMVUU9IkNvbnRpbnVlIj48L05PU0NSSVBUPgogICAgICA8L2Zvcm0+CiAgIDwvYm9keT4KPC9odG1sPg==\"/>\n            <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n        </L7p:HardcodedResponse>\n    </wsp:All>\n</wsp:Policy>"
  }
}