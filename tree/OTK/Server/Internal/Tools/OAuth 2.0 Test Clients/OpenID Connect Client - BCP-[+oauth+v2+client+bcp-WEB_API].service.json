{
  "goid": "e001cfd0c1c1ffaa18e187b5e72fe840",
  "guid": "8492b403-c346-4121-b01e-97a50fda848e",
  "name": "OpenID Connect Client - BCP",
  "resolutionPath": "/oauth/v2/client/bcp",
  "serviceType": "WEB_API",
  "checksum": "de35e7c4841a3fba81c608708e76d192949a5e3a",
  "enabled": true,
  "folderPath": "/OTK/Server/Internal/Tools/OAuth 2.0 Test Clients",
  "methodsAllowed": [
    "GET",
    "POST",
    "PUT",
    "DELETE"
  ],
  "tracingEnabled": false,
  "wssProcessingEnabled": false,
  "laxResolution": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:SslAssertion/>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6\"/>\n            <L7p:PolicyName stringValue=\"OTK Security Header Extension\"/>\n        </L7p:Include>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:AddHeader>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"HTTPS only\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Inform the browser to only accept SSL connections\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:HeaderName stringValue=\"Content-Security-Policy\"/>\n                <L7p:HeaderValue stringValue=\"default-src 'self'; script-src  'unsafe-inline'; img-src * data:; style-src 'unsafe-inline'; font-src * data:; object-src 'none'; require-trusted-types-for 'script';\"/>\n                <L7p:RemoveExisting booleanValue=\"true\"/>\n                <L7p:Target target=\"RESPONSE\"/>\n            </L7p:AddHeader>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Override OTK Security Header Extension\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <L7p:CustomizeErrorResponse>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"HTML\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Return HTML error response\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Content stringValueReference=\"inline\"><![CDATA[${htmlTemplateTop}\n<h1>Grant type: Authorization code with OpenID Connect</h1>\n<pre>${error.msg}</pre>\n${htmlTemplateBottom}]]></L7p:Content>\n            <L7p:ContentType stringValue=\"text/html;charset=UTF-8\"/>\n            <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Pragma\"/>\n                    <L7p:Value stringValue=\"no-cache\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Cache-Control\"/>\n                    <L7p:Value stringValue=\"no-store\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"x-ca-err\"/>\n                    <L7p:Value stringValue=\"${error.code}\"/>\n                </L7p:item>\n            </L7p:ExtraHeaders>\n            <L7p:HttpStatus stringValue=\"${status}\"/>\n        </L7p:CustomizeErrorResponse>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"51740c0b-11c5-455e-92a0-a1f915264eb0\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Client Context Variables\"/>\n        </L7p:Encapsulated>\n        <L7p:Encapsulated>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"return false if the XSS tag is found\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"2be8eaf2-9b42-4173-ace9-3fdb471fb407\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"API XSS Protection\"/>\n            <L7p:Parameters mapValue=\"included\">\n                <L7p:entry>\n                    <L7p:key stringValue=\"allinput\"/>\n                    <L7p:value stringValue=\"${request.mainpart}${request.url}\"/>\n                </L7p:entry>\n            </L7p:Parameters>\n        </L7p:Encapsulated>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${request.http.parameter.access_token}\"/>\n                    <L7p:Expression2 stringValue=\"\"/>\n                    <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                    <L7p:Negate booleanValue=\"true\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${request.http.parameter.state}\"/>\n                    <L7p:Expression2 stringValue=\"pr\"/>\n                    <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"pr\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:HttpRoutingAssertion>\n                    <L7p:ProtectedServiceUrl stringValue=\"${location_resourceendpoint}?access_token=${request.http.parameter.access_token}\"/>\n                    <L7p:ProxyPassword stringValueNull=\"null\"/>\n                    <L7p:ProxyUsername stringValueNull=\"null\"/>\n                    <L7p:RequestHeaderRules httpPassthroughRuleSet=\"included\">\n                        <L7p:Rules httpPassthroughRules=\"included\"/>\n                    </L7p:RequestHeaderRules>\n                    <L7p:RequestParamRules httpPassthroughRuleSet=\"included\">\n                        <L7p:Rules httpPassthroughRules=\"included\"/>\n                    </L7p:RequestParamRules>\n                    <L7p:ResponseHeaderRules httpPassthroughRuleSet=\"included\">\n                        <L7p:Rules httpPassthroughRules=\"included\">\n                            <L7p:item httpPassthroughRule=\"included\">\n                                <L7p:Name stringValue=\"Set-Cookie\"/>\n                            </L7p:item>\n                        </L7p:Rules>\n                    </L7p:ResponseHeaderRules>\n                    <L7p:SamlAssertionVersion intValue=\"2\"/>\n                </L7p:HttpRoutingAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"Call the protected resource endpoint\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${request.url.path}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item regex=\"included\">\n                            <L7p:Pattern stringValue=\".+/bcp\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjbGllbnRfc2VjcmV0X2JjcH0=\"/>\n                        <L7p:VariableToSet stringValue=\"client_secret_display\"/>\n                    </L7p:SetVariable>\n                    <L7p:Regex>\n                        <L7p:AutoTarget booleanValue=\"false\"/>\n                        <L7p:CaptureVar stringValue=\"client_secret_front\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"client_secret_display\"/>\n                        <L7p:Regex stringValue=\"^(.{5})\"/>\n                        <L7p:Replace booleanValue=\"true\"/>\n                        <L7p:Replacement stringValue=\"\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:Regex>\n                    <L7p:Regex>\n                        <L7p:AutoTarget booleanValue=\"false\"/>\n                        <L7p:CaptureVar stringValue=\"client_secret_end\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"client_secret_display\"/>\n                        <L7p:Regex stringValue=\"(.{5})$\"/>\n                        <L7p:Replace booleanValue=\"true\"/>\n                        <L7p:Replacement stringValue=\"\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:Regex>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjbGllbnRfc2VjcmV0X2Zyb250WzFdfSAuLi4gJHtjbGllbnRfc2VjcmV0X2VuZFsxXX0=\"/>\n                        <L7p:VariableToSet stringValue=\"client_secret_display\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Compute the client_secret for display\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y29kZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"response_type\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNvZGV9\"/>\n                    <L7p:VariableToSet stringValue=\"code\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.state}\"/>\n                            <L7p:Expression2 stringValue=\"view\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"view\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${code}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"300\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"tokenResult\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${code}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                </L7p:ResponseXpathAssertion>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                                    <L7p:TargetContentType stringValue=\"text/html;charset=UTF-8\"/>\n                                    <L7p:TargetDataType variableDataType=\"message\"/>\n                                    <L7p:TargetVariableName stringValue=\"tokenResult\"/>\n                                    <L7p:TransformType transformType=\"URL_DECODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:HardcodedResponse>\n                                    <L7p:Base64ResponseBody stringValue=\"JHtodG1sVGVtcGxhdGVUb3B9CjxoMT5HcmFudCB0eXBlOiBBdXRob3JpemF0aW9uIGNvZGUgd2l0aCBQS0NFPC9oMT4KJHt0b2tlblJlc3VsdC5tYWlucGFydH0KJHtodG1sVGVtcGxhdGVCb3R0b219\"/>\n                                    <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                                </L7p:HardcodedResponse>\n                            </wsp:All>\n                            <L7p:HardcodedResponse>\n                                <L7p:Base64ResponseBody stringValue=\"JHtodG1sVGVtcGxhdGVUb3B9DQo8aDE+R3JhbnQgdHlwZTogQXV0aG9yaXphdGlvbiBjb2RlIHdpdGggUEtDRTwvaDE+CjxwPlNvcnJ5LCBidXQgdGhlIGF1dGhvcml6YXRpb25fY29kZSBoYXMgYmVlbiBwcm9jZXNzZWQgYWxyZWFkeSBvciB0aGUgbGlmZXRpbWUgZm9yIHRoaXMgcGFnZSBoYXMgZXhwaXJlZC48L3A+DQo8cD48YSBocmVmPSIke2xvY2F0aW9uX2FwcH0iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPlJlcGVhdCBSZXF1ZXN0PC9hPjwvcD4NCiR7aHRtbFRlbXBsYXRlQm90dG9tfQ==\"/>\n                                <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            </L7p:HardcodedResponse>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"DISPLAY results\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.auth}\"/>\n                            <L7p:Expression2 stringValue=\"done\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"done\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.error}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:HardcodedResponse>\n                            <L7p:Base64ResponseBody stringValue=\"JHtodG1sVGVtcGxhdGVUb3B9DQo8aDE+R3JhbnQgdHlwZTogQXV0aG9yaXphdGlvbiBjb2RlIHdpdGggT3BlbklEIENvbm5lY3Q8L2gxPgo8IS0tID09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICAtLT4NCjxwPlRoZSBjbGllbnQgYWNjZXNzIHdhcyBkZW5pZWQgYnkgdGhlIHJlc291cmNlIG93bmVyLjwvcD4NCjxwPlRoZSBhdXRob3JpemF0aW9uIHNlcnZlciBoYXMgdmFsaWRhdGVkIHRoZSByZXF1ZXN0IGFuZCByZXR1cm5lZCB0aGlzIGVycm9yIHRvIHRoZSBjbGllbnQgYXMgVVJMIHBhcmFtZXRlcjo8L3A+DQo8cHJlPkVycm9yOiAke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuZXJyb3J9PC9wcmU+DQo8cD48YSBocmVmPSIke2xvY2F0aW9uX2FwcH0iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPlJlcGVhdCBSZXF1ZXN0PC9hPjwvcD4NCjwhLS0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gIC0tPg0KJHtodG1sVGVtcGxhdGVCb3R0b219\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"DENIED\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.state}\"/>\n                            <L7p:Expression2 stringValue=\"refresh\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"refresh\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"request.http.parameter.scope\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"scope_refresh\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"request.http.parameter.refresh_token\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"refresh_token\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"oauth2_resource\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"oauth2_resource\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"Z3JhbnRfdHlwZT1yZWZyZXNoX3Rva2VuJnJlZnJlc2hfdG9rZW49JHtyZWZyZXNoX3Rva2VufSZzY29wZT0ke3Njb3BlX3JlZnJlc2h9JnJlc291cmNlPSR7b2F1dGgyX3Jlc291cmNlfQ==\"/>\n                            <L7p:ContentType stringValue=\"application/x-www-form-urlencoded\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"toServer\"/>\n                        </L7p:SetVariable>\n                        <L7p:HttpRoutingAssertion>\n                            <L7p:FailOnErrorStatus booleanValue=\"false\"/>\n                            <L7p:HttpMethod httpMethod=\"POST\"/>\n                            <L7p:Login stringValue=\"${client_id_bcp}\"/>\n                            <L7p:Password stringValue=\"${client_secret_bcp}\"/>\n                            <L7p:ProtectedServiceUrl stringValue=\"${location_tokenserver}\"/>\n                            <L7p:ProxyPassword stringValueNull=\"null\"/>\n                            <L7p:ProxyUsername stringValueNull=\"null\"/>\n                            <L7p:RequestHeaderRules httpPassthroughRuleSet=\"included\">\n                                <L7p:Rules httpPassthroughRules=\"included\">\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"Cookie\"/>\n                                    </L7p:item>\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"SOAPAction\"/>\n                                    </L7p:item>\n                                </L7p:Rules>\n                            </L7p:RequestHeaderRules>\n                            <L7p:RequestMsgSrc stringValue=\"toServer\"/>\n                            <L7p:RequestParamRules httpPassthroughRuleSet=\"included\">\n                                <L7p:ForwardAll booleanValue=\"true\"/>\n                                <L7p:Rules httpPassthroughRules=\"included\"/>\n                            </L7p:RequestParamRules>\n                            <L7p:ResponseHeaderRules httpPassthroughRuleSet=\"included\">\n                                <L7p:Rules httpPassthroughRules=\"included\">\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"Set-Cookie\"/>\n                                    </L7p:item>\n                                </L7p:Rules>\n                            </L7p:ResponseHeaderRules>\n                            <L7p:ResponseMsgDest stringValue=\"authServerResponse\"/>\n                            <L7p:SamlAssertionVersion intValue=\"2\"/>\n                        </L7p:HttpRoutingAssertion>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"access_token\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"authServerResponse\"/>\n                            <L7p:Regex stringValue=\"\\&quot;access_token\\&quot;:\\&quot;([^&quot;]*)\\&quot;\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthY2Nlc3NfdG9rZW5bMV19\"/>\n                            <L7p:VariableToSet stringValue=\"access_token\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:CaptureVar stringValue=\"refresh_token\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"authServerResponse\"/>\n                                    <L7p:Regex stringValue=\"\\&quot;refresh_token\\&quot;:\\&quot;([^&quot;]{1,60})\\&quot;\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:Regex>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZWZyZXNoX3Rva2VuWzFdfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"refresh_token\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGJyLz4NCjxoci8+DQo8cD48Yj5OZXcgUmVmcmVzaCBUb2tlbiBSZWNlaXZlZDwvYj48L3A+DQo8cD5Vc2luZyB0aGUgcmVmcmVzaF90b2tlbiB0byByZXF1ZXN0IGEgbmV3IGFjY2Vzc190b2tlbiwgYSBuZXcgcmVmcmVzaF90b2tlbiB3YXMgcmVjZWl2ZWQgaW4gdGhlIHByb2Nlc3MuICBBIG5ldyBpZF90b2tlbiB3YXMgbm90IHJlY2VpdmVkLCBhcyB3ZSBhcmUgcmVuZXdpbmcgYWNjZXNzLCBub3QgaWRlbnRpZmljYXRpb24uPC9wPg0KPHA+VG8gcmVmcmVzaCB0aGUgYWNjZXNzIHRva2VuIG9uY2UgYWdhaW4sIHRoZSBjbGllbnQgbmVlZHMgdG8gaW5jbHVkZSB0aGUgcGFyYW1ldGVycyBsaXN0ZWQgYmVsb3cuIEl0IGFsc28gbmVlZHMgdG8gYXV0aGVudGljYXRlIGl0c2VsZiB1c2luZyBjbGllbnRfaWQgYW5kIGNsaWVudF9zZWNyZXQuPC9wPg0KPGZvcm0gYWN0aW9uPSIke2xvY2F0aW9uX2FwcH0iIG1ldGhvZD0iUE9TVCI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiIHZhbHVlPSJyZWZyZXNoIj48YnIvPg0KICAgIDx0YWJsZSBjbGFzcz0idGFibGUtZm9ybSI+DQogICAgIDx0cj48dGQ+cmVmcmVzaF90b2tlbjogPC90ZD48dGQ+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InJlZnJlc2hfdG9rZW4iIHZhbHVlPSIke3JlZnJlc2hfdG9rZW59IiByZWFkb25seT0icmVhZG9ubHkiPjwvdGQ+PC90cj4NCiAgICAgPHRyPjx0ZD5ncmFudF90eXBlOiA8L3RkPjx0ZD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iZ3JhbnRfdHlwZSIgdmFsdWU9InJlZnJlc2hfdG9rZW4iIHJlYWRvbmx5PSJyZWFkb25seSI+PC90ZD48L3RyPg0KICAgICA8dHI+PHRkPnNjb3BlOiA8L3RkPjx0ZD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0ic2NvcGUiIHZhbHVlPSIke3Njb3BlfSIgcmVhZG9ubHk9InJlYWRvbmx5Ij48L3RkPjwvdHI+DQogICAgIDx0cj48dGQ+VXNlIHRoZSByZWZyZXNoX3Rva2VuOiA8L3RkPjx0ZD48YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkgYnRuLW1pbmkiIHR5cGU9InN1Ym1pdCIgdmFsdWU9IlJlZnJlc2giPlJlZnJlc2g8L2J1dHRvbj48L3RkPjwvdHI+DQogICAgPC90YWJsZT4NCjwvZm9ybT4NCjxici8+\"/>\n                                    <L7p:VariableToSet stringValue=\"refresh_token_display\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"-- did we receive another refresh token?\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"PGJyLz4NCjxoci8+DQo8cD48Yj5OZXcgUmVmcmVzaCBUb2tlbiBEZWNsaW5lZDwvYj48L3A+DQo8cD5Vc2luZyB0aGUgcmVmcmVzaF90b2tlbiB0byByZXF1ZXN0IGEgbmV3IGFjY2Vzc190b2tlbiwgYSBuZXcgcmVmcmVzaCB0b2tlbiB3YXMgTk9UIHJlY2VpdmVkLjwvcD4NCjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"refresh_token_display\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"PHA+PGI+UmVmcmVzaCBUb2tlbiBIYXMgQmVlbiBBdXRob3JpemVkPC9iPiA8L3A+DQo8cD5UaGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXIgaGFzIHZhbGlkYXRlZCB0aGUgcmVmcmVzaF90b2tlbiBhbmQgcmV0dXJuZWQgdGhpcyByZXN1bHQgdG8gdGhlIGNsaWVudDo8L3A+DQo8cHJlPiR7YXV0aFNlcnZlclJlc3BvbnNlLm1haW5wYXJ0fTwvcHJlPg0KPGJyLz4NCjxwPjxiPlRoZSB0b2tlbnMgc2hvdWxkIG5vdCBiZSBleHBvc2VkIHRvIHRoZSB1c2VyLWFnZW50IGluIGEgcmVhbCBsaWZlIHNjZW5hcmlvITwvYj48L3A+DQo8cD5UaGlzIHRva2VuLCBhbG9uZyB3aXRoIHRoZSBwcmV2aW91c2x5IGdyYW50ZWQgaWRfdG9rZW4sIGNhbiBub3cgYmUgdXNlZCB0byBhY2Nlc3MgdGhlIHVzZXJzIHJlc291cmNlcyBvciB0aGUgJy91c2VyaW5mbycgZW5kcG9pbnQgdG8gcmVxdWVzdCBjbGFpbXMgYWJvdXQgdGhlIHVzZXIuPC9wPg0KPHA+Qm90aCByZXF1ZXN0cyB3aWxsIHVzZSBIVFRQICdQT1NUJyBhbmQgdGhlIHBhcmFtZXRlciAnYWNjZXNzX3Rva2VuJyB3aGljaCwgb2YgY291cnNlLCBpbmNsdWRlcyB0aGUgYWNjZXNzIHRva2VuLjwvcD4NCjxwPjxiPmFjY2Vzc190b2tlbjo8L2I+ICR7YWNjZXNzX3Rva2VufTwvcD4NCjxwPkdvIGFoZWFkIGFuZCB1c2UgdGhlIDxiPmFjY2Vzc190b2tlbjwvYj46PC9wPg0KPGZvcm0gYWN0aW9uPSIke2xvY2F0aW9uX2FwcH0iIHRhcmdldD0icmVzdWx0IiBtZXRob2Q9IlBPU1QiPg0KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjY2Vzc190b2tlbiIgdmFsdWU9IiR7YWNjZXNzX3Rva2VufSI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiIHZhbHVlPSJwciI+DQogICAgUmVxdWVzdCByZXNvdXJjZXM6IDxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSBidG4tbWluaSIgdHlwZT0ic3VibWl0IiB2YWx1ZT0iUmVzb3VyY2VzIj5SZXNvdXJjZXM8L2J1dHRvbj4gKCR7bG9jYXRpb25fcmVzb3VyY2VlbmRwb2ludH0pDQo8L2Zvcm0+DQo8YnIvPg0KPHA+VG8gYWNjZXNzIHRoZSAvdXNlcmluZm8gZW5kcG9pbnQgdGhlIGFkZGl0aW9uYWwgcGFyYW1ldGVyLXZhbHVlIHBhaXIgJ3NjaGVtYT1vcGVuaWQnIGlzIHJlcXVpcmVkITwvcD4NCjxmb3JtIGFjdGlvbj0iJHtsb2NhdGlvbl91c2VyaW5mb2VuZHBvaW50fSIgdGFyZ2V0PSJyZXN1bHQiIG1ldGhvZD0iUE9TVCI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic2NoZW1hIiB2YWx1ZT0ib3BlbmlkIj4NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhY2Nlc3NfdG9rZW4iIHZhbHVlPSIke2FjY2Vzc190b2tlbn0iPg0KICAgIFJlcXVlc3QgdXNlciBjbGFpbXM6IDxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSBidG4tbWluaSIgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2xhaW1zIj5DbGFpbXM8L2J1dHRvbj4gKCR7bG9jYXRpb25fdXNlcmluZm9lbmRwb2ludH0pDQo8L2Zvcm0+DQo8cD5SZXN1bHQgYWZ0ZXIgYWNjZXNzaW5nIHJlc291cmNlcyBvciB0aGUgdXNlcmluZm8gZW5kcG9pbnQ6PC9wPg0KPGlmcmFtZSBpZD0icmVzdWx0IiBuYW1lPSJyZXN1bHQiIHdpZHRoPSI2MDAiPjwvaWZyYW1lPg0KJHtyZWZyZXNoX3Rva2VuX2Rpc3BsYXl9DQo8cD48YSBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IiBocmVmPSIke2xvY2F0aW9uX2FwcH0iPlJlcGVhdCBSZXF1ZXN0PC9hPjwvcD4=\"/>\n                            <L7p:ContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"tokenResult\"/>\n                        </L7p:SetVariable>\n                        <L7p:UUIDGenerator>\n                            <L7p:MaximumQuantity intValue=\"1\"/>\n                            <L7p:TargetVariable stringValue=\"key\"/>\n                        </L7p:UUIDGenerator>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"dd360775-0fec-47db-8b45-059d995b262d\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Store\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"300\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"tokenResult\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${key[0]}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxEntries\"/>\n                                    <L7p:value stringValue=\"1000\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxSize\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"dbAge\"/>\n                                    <L7p:value stringValue=\"300\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value stringValue=\"${tokenResult.mainpart}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:HardcodedResponse>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Location\"/>\n                            <L7p:HeaderValue stringValue=\"${location_app}?state=view&amp;code=${key[0]}\"/>\n                            <L7p:RemoveExisting booleanValue=\"true\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"REFRESH the access_token and refresh Token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.state}\"/>\n                            <L7p:Expression2 stringValue=\"call\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"call\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.auth}\"/>\n                            <L7p:Expression2 stringValue=\"done\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"done\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${code}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:WssReplayProtection>\n                                    <L7p:CustomExpiryTime intValue=\"300000\"/>\n                                    <L7p:CustomIdentifierVariable stringValue=\"code\"/>\n                                    <L7p:CustomProtection booleanValue=\"true\"/>\n                                    <L7p:CustomScope stringValue=\"myendpoiint\"/>\n                                </L7p:WssReplayProtection>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtnYXRld2F5LnRpbWUueXl5eU1NZGRISG1tc3NTU1N9\"/>\n                                    <L7p:VariableToSet stringValue=\"state\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PHA+VGhlIGNsaWVudCBoYXMgcmVjZWl2ZWQgYSAnY29kZScgYWZ0ZXIgdGhlIHVzZXIgZ3JhbnRlZCBhY2Nlc3MgdG8gaGlzIHJlc291cmNlczwvcD4NCjxwPlRoZXNlIHZhbHVlcyB3ZXJlIHJlY2VpdmVkIHdpdGhpbiB0aGUgVVJMOjwvcD4NCjx0YWJsZSBjbGFzcz0idGFibGUtc3RyaXBlZCB0YWJsZS1ob3ZlciI+DQogICAgPHRyPjx0aD5QYXJhbWV0ZXI8L3RoPjx0aD5WYWx1ZTwvdGg+PHRoPkNvbW1lbnQ8L3RoPjwvdHI+DQogICAgPHRyPjx0ZD5jb2RlPC90ZD48dGQ+JHtjb2RlfTwvdGQ+PHRkPlRoaXMgdmFsdWUgaXMgdXNlZCB0byBleGNoYW5nZSBpdCBmb3IgdG9rZW5zIGF0IHRoZSAvdG9rZW4gZW5kcG9pbnQgb2YgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyPC90ZD48L3RyPg0KICAgIDx0cj48dGQ+c2NvcGU8L3RkPjx0ZD4ke3Njb3BlfTwvdGQ+PHRkPlRoZSBncmFudGVkIGFuZCBhY2NlcHRlZCBzY29wZSBmb3IgdGhpcyBjbGllbnQ8L3RkPjwvdHI+DQogICAgPHRyPjx0ZD5zdGF0ZTwvdGQ+PHRkPiR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5zdGF0ZX08L3RkPjx0ZD5UaGUgdmFsdWUgdGhhdCB3YXMgc2VudCBieSB0aGUgY2xpZW50PC90ZD48L3RyPg0KPC90YWJsZT4NCjxici8+DQo8cD5UbyBleGNoYW5nZSB0aGUgJ2NvZGUnIGZvciB0b2tlbnMgdGhlIGNsaWVudCBwcmVwYXJlZCB0aGUgbmV4dCByZXF1ZXN0IHVzaW5nIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczo8L3A+DQo8dGFibGUgY2xhc3M9InRhYmxlLXN0cmlwZWQgdGFibGUtaG92ZXIiPg0KICAgIDx0cj48dGg+UGFyYW1ldGVyPC90aD48dGg+VmFsdWU8L3RoPjx0aD5SZXF1aXJlZDwvdGg+PHRoPkhpZGRlbjwvdGg+PHRoPkNvbW1lbnQ8L3RoPjwvdHI+DQogICAgPHRyPjx0ZD5jbGllbnRfaWQ8L3RkPjx0ZD4ke2NsaWVudF9pZF9iY3B9PC90ZD48dGQ+WWVzPC90ZD48dGQ+WWVzPC90ZD48dGQ+TVVTVCBiZSBrbm93biBhdCB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXI8L3RkPjwvdHI+DQogICAgPHRyPjx0ZD5jbGllbnRfc2VjcmV0PC90ZD48dGQ+JHtjbGllbnRfc2VjcmV0X2Rpc3BsYXl9PC90ZD48dGQ+WWVzPC90ZD48dGQ+WWVzPC90ZD48dGQ+TVVTVCBiZSBrbm93biBhdCB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXI8L3RkPjwvdHI+DQogICAgPHRyPjx0ZD5ncmFudF90eXBlPC90ZD48dGQ+YXV0aG9yaXphdGlvbl9jb2RlPC90ZD48dGQ+WWVzPC90ZD48dGQ+Tm88L3RkPjx0ZD5NVVNUIGJlIHNldCB0byAnYXV0aG9yaXphdGlvbl9jb2RlJzwvdGQ+PC90cj4NCiAgICA8dHI+PHRkPmNvZGVfdmVyaWZpZXI8L3RkPjx0ZD4ke2NvZGVfdmVyaWZpZXJ9PC90ZD48dGQ+WWVzPC90ZD48dGQ+Tm88L3RkPjx0ZD5UaGUgQ29kZSBWZXJpZmllcjwvdGQ+PC90cj4NCiAgICA8dHI+PHRkPmNvZGU8L3RkPjx0ZD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuY29kZX08L3RkPjx0ZD5ZZXM8L3RkPjx0ZD5ObzwvdGQ+PHRkPlRoZSAnYXV0aG9yaXphdGlvbl9jb2RlJyB0aGF0IHdhcyByZWNlaXZlZDwvdGQ+PC90cj4NCiAgICA8dHI+PHRkPnJlZGlyZWN0X3VyaTwvdGQ+PHRkPiR7cmVkaXJlY3RfdXJpfTwvdGQ+PHRkPlllczwvdGQ+PHRkPk5vPC90ZD48dGQ+TVVTVCBiZSBwcmUtcmVnaXN0ZXJlZCB3aXRoIHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciBhbmQgdGhlIHNhbWUgYXMgdXNlZCBhdCB0aGUgaW5pdGlhbCByZXF1ZXN0PC90ZD48L3RyPg0KICAgIDx0cj48dGQ+c3RhdGU8L3RkPjx0ZD4ke3N0YXRlfTwvdGQ+PHRkPk5vPC90ZD48dGQ+Tm88L3RkPjx0ZD5BIHZhbHVlIG9wYXF1ZSB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXI7IHdpbGwgYmUgcGFzc2VkIGJhY2sgdG8gdGhlIGNsaWVudDwvdGQ+PC90cj4NCiAgICA8dHI+PHRkPnJlc291cmNlPC90ZD48dGQ+JHtvYXV0aDJfcmVzb3VyY2V9PC90ZD48dGQ+Tm88L3RkPjx0ZD5ObzwvdGQ+PHRkPlRoZSByZXNvdXJjZSB0aGUgdG9rZW5zIGFyZSB0byBiZSBpc3N1ZWQgZm9yPC90ZD48L3RyPg0KPC90YWJsZT4NCjxici8+DQo8cD5UaGUgY2xpZW50IGhhcyBzZW50IHRoZSByZXF1ZXN0IHRvIHRoZSBhdXRob3JpemF0aW9uIHNlcnZlcidzIHRva2VuIGVuZHBvaW50IHVzaW5nIEhUVFAgJ1BPU1QnOjxici8+PGI+JHtsb2NhdGlvbl90b2tlbnNlcnZlcn08L2I+LiBUaGUgcGFyYW1ldGVycyB3ZXJlICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnIGVuY29kZWQuPC9wPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"codeRequestResponse\"/>\n                                </L7p:SetVariable>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"redirect_uri\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"redirect_uri_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"oauth2_resource\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"resource\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"cmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RfdXJpX2VuY29kZWR9JmNvZGU9JHtjb2RlfSZncmFudF90eXBlPWF1dGhvcml6YXRpb25fY29kZSZzdGF0ZT0ke3N0YXRlfSZjbGllbnRfaWQ9JHtjbGllbnRfaWRfYmNwfSZjbGllbnRfc2VjcmV0PSR7Y2xpZW50X3NlY3JldF9iY3B9JnJlc291cmNlPSR7cmVzb3VyY2V9JmNvZGVfdmVyaWZpZXI9JHtjb2RlX3ZlcmlmaWVyfQ==\"/>\n                                    <L7p:ContentType stringValue=\"application/x-www-form-urlencoded\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"toServer\"/>\n                                </L7p:SetVariable>\n                                <L7p:HttpRoutingAssertion>\n                                    <L7p:FailOnErrorStatus booleanValue=\"false\"/>\n                                    <L7p:HttpMethod httpMethod=\"POST\"/>\n                                    <L7p:ProtectedServiceUrl stringValue=\"${location_tokenserver}\"/>\n                                    <L7p:ProxyPassword stringValueNull=\"null\"/>\n                                    <L7p:ProxyUsername stringValueNull=\"null\"/>\n                                    <L7p:RequestHeaderRules httpPassthroughRuleSet=\"included\">\n                                    <L7p:Rules httpPassthroughRules=\"included\">\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"Cookie\"/>\n                                    </L7p:item>\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"SOAPAction\"/>\n                                    </L7p:item>\n                                    </L7p:Rules>\n                                    </L7p:RequestHeaderRules>\n                                    <L7p:RequestMsgSrc stringValue=\"toServer\"/>\n                                    <L7p:RequestParamRules httpPassthroughRuleSet=\"included\">\n                                    <L7p:ForwardAll booleanValue=\"true\"/>\n                                    <L7p:Rules httpPassthroughRules=\"included\"/>\n                                    </L7p:RequestParamRules>\n                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet=\"included\">\n                                    <L7p:Rules httpPassthroughRules=\"included\">\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"Set-Cookie\"/>\n                                    </L7p:item>\n                                    </L7p:Rules>\n                                    </L7p:ResponseHeaderRules>\n                                    <L7p:ResponseMsgDest stringValue=\"authServerResponse\"/>\n                                    <L7p:SamlAssertionVersion intValue=\"2\"/>\n                                </L7p:HttpRoutingAssertion>\n                                <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:CaptureVar stringValue=\"access_token\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"authServerResponse\"/>\n                                    <L7p:Regex stringValue=\"\\&quot;access_token\\&quot;:\\&quot;([^&quot;]*)\\&quot;\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:Regex>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthY2Nlc3NfdG9rZW5bMV19\"/>\n                                    <L7p:VariableToSet stringValue=\"access_token\"/>\n                                </L7p:SetVariable>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:CaptureVar stringValue=\"refresh_token\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"authServerResponse\"/>\n                                    <L7p:Regex stringValue=\"\\&quot;refresh_token\\&quot;:\\&quot;([^&quot;]{1,60})\\&quot;\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZWZyZXNoX3Rva2VuWzFdfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"refresh_token\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGJyLz4NCjxoci8+DQo8cD48Yj5SZWZyZXNoPC9iPjwvcD4NCjxwPlVzZSB0aGUgcmVmcmVzaF90b2tlbiB0byByZXF1ZXN0IGEgbmV3IGFjY2Vzc190b2tlbiBhbmQgcmVmcmVzaF90b2tlbjxici8+KGl0IGNhbm5vdCBiZSBleGNoYW5nZWQgZm9yIGEgbmV3IGlkX3Rva2VuKTwvcD4NCjxwPlRoZSBjbGllbnQgbmVlZHMgdG8gaW5jbHVkZSB0aGUgcGFyYW1ldGVycyBsaXN0ZWQgYmVsb3cuIEl0IGFsc28gbmVlZHMgdG8gYXV0aGVudGljYXRlIGl0c2VsZiB1c2luZyBjbGllbnRfaWQgYW5kIGNsaWVudF9zZWNyZXQuPC9wPg0KPGZvcm0gYWN0aW9uPSIke2xvY2F0aW9uX2FwcH0iIG1ldGhvZD0iUE9TVCI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiIHZhbHVlPSJyZWZyZXNoIj48YnIvPg0KPHRhYmxlIGNsYXNzPSJ0YWJsZS1mb3JtIj4NCjx0cj4gICAgDQo8dGQ+cmVmcmVzaF90b2tlbjwvdGQ+PHRkPjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJyZWZyZXNoX3Rva2VuIiB2YWx1ZT0iJHtyZWZyZXNoX3Rva2VufSIgcmVhZG9ubHk9InJlYWRvbmx5Ij48L3RkPg0KPC90cj4NCjx0cj4NCjx0ZD5ncmFudF90eXBlPC90ZD48dGQ+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImdyYW50X3R5cGUiIHZhbHVlPSJyZWZyZXNoX3Rva2VuIiByZWFkb25seT0icmVhZG9ubHkiPjwvdGQ+DQo8L3RyPg0KPHRyPg0KPHRkPnNjb3BlPC90ZD48dGQ+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InNjb3BlIiB2YWx1ZT0iJHtzY29wZX0iIHJlYWRvbmx5PSJyZWFkb25seSI+PC90ZD4NCjwvdHI+DQo8dHI+DQo8dGQ+VXNlIHRoZSByZWZyZXNoX3Rva2VuPC90ZD48dGQ+PGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IGJ0bi1taW5pIiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJSZWZyZXNoIj5SZWZyZXNoPC9idXR0b24+PC90ZD4NCjwvdHI+DQo8L3RhYmxlPg0KPC9mb3JtPg0KPGJyLz4=\"/>\n                                    <L7p:VariableToSet stringValue=\"refresh_token_display\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"refresh_token_display\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Check for a refresh_token\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:CaptureVar stringValue=\"id_token\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"authServerResponse\"/>\n                                    <L7p:Regex stringValue=\"\\&quot;id_token\\&quot;:\\&quot;([^&quot;]+)\\&quot;\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtpZF90b2tlblsxXX0=\"/>\n                                    <L7p:VariableToSet stringValue=\"id_token\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:CommentAssertion>\n                                    <L7p:Comment stringValue=\"Below validation is a sample which simply succeeds if one  method works.\"/>\n                                    </L7p:CommentAssertion>\n                                    <L7p:CommentAssertion>\n                                    <L7p:Comment stringValue=\"A real world client would have to validate the id_token dependant on the 'iss' (issuer)\"/>\n                                    </L7p:CommentAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:DecodeJsonWebToken>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"HS256\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// validation using a shared secret (client_secret)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:KeyType stringValue=\"Certificate\"/>\n\n                                    <L7p:PrivateKeySource stringValue=\"client_secret_bcp\"/>\n                                    <L7p:SignatureSecret stringValue=\"${client_secret_bcp}\"/>\n                                    <L7p:SourcePayload stringValue=\"${id_token}\"/>\n\n                                    <L7p:TargetVariablePrefix stringValue=\"jwt\"/>\n                                    <L7p:ValidationType stringValue=\"Using Secret\"/>\n                                    </L7p:DecodeJsonWebToken>\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${jwt.valid}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// HS256\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:DecodeJsonWebToken>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"RS256\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// validation using a public key\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:KeyGoid goidValue=\"0000000000000000ffffffffffffffff\"/>\n                                    <L7p:SourcePayload stringValue=\"${id_token}\"/>\n\n                                    <L7p:TargetVariablePrefix stringValue=\"jwt\"/>\n                                    <L7p:ValidationType stringValue=\"Using Recipient Key From List\"/>\n                                    </L7p:DecodeJsonWebToken>\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${jwt.valid}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// RS256\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// validate id_token signature\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"68ce345d-8f7e-41a0-8f0a-81ec59096884\"/>\n                                    <L7p:PolicyName stringValue=\"#OTK id_token Allowed Custom Claims\"/>\n                                    </L7p:Include>\n                                    <L7p:CustomAssertion>\n                                    <L7p:base64SerializedValue>rO0ABXNyADFjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uQ3VzdG9tQXNzZXJ0aW9uSG9sZGVyZtcreFwddTICAAlaAAxpc1VpQXV0b09wZW5MAApjYXRlZ29yaWVzdAAPTGphdmEvdXRpbC9TZXQ7TAAIY2F0ZWdvcnl0ACpMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DYXRlZ29yeTtMAA9jdXN0b21Bc3NlcnRpb250ADFMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DdXN0b21Bc3NlcnRpb247TAAUY3VzdG9tTW9kdWxlRmlsZU5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMAA9kZXNjcmlwdGlvblRleHRxAH4ABEwAD3BhbGV0dGVOb2RlTmFtZXEAfgAETAAOcG9saWN5Tm9kZU5hbWVxAH4ABEwAHnJlZ2lzdGVyZWRDdXN0b21GZWF0dXJlU2V0TmFtZXEAfgAEeHIAJWNvbS5sN3RlY2gucG9saWN5LmFzc2VydGlvbi5Bc3NlcnRpb27bX2OZPL2isQIAAloAB2VuYWJsZWRMABBhc3NlcnRpb25Db21tZW50dAAvTGNvbS9sN3RlY2gvcG9saWN5L2Fzc2VydGlvbi9Bc3NlcnRpb24kQ29tbWVudDt4cAFwAXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyAChjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uZXh0LkNhdGVnb3J5WrCcZaFE/jUCAAJJAAVteUtleUwABm15TmFtZXEAfgAEeHAAAAAHdAAfTWVzc2FnZVZhbGlkYXRpb25UcmFuc2Zvcm1hdGlvbnhwc3IARGNvbS5sN3RlY2guY3VzdG9tLm9wZW5pZGNvbm5lY3QuRGVjb2RlSURUb2tlbi5JRFRva2VuRGVjb2RlQXNzZXJ0aW9uxl6qBXO//LkCABNaAAlleHBvcnRBY3JaAAlleHBvcnRBbGxaAAxleHBvcnRBdEhhc2haAAlleHBvcnRBdWRaAA5leHBvcnRBdXRoVGltZVoACWV4cG9ydEF6cFoAC2V4cG9ydENIYXNoWgAQZXhwb3J0RXhwaXJhdGlvbloACWV4cG9ydElhdFoACWV4cG9ydElzc1oAC2V4cG9ydE5vbmNlWgARZXhwb3J0T3RoZXJDbGFpbXNaAAtleHBvcnRTSGFzaFoACWV4cG9ydFN1YloADnZhbGlkYXRlQ2xhaW1zWgASdmFsaWRhdGVFeHBpcmF0aW9uTAATYWxsb3dlZEN1c3RvbUNsYWltc3EAfgAETAAOZXhwb3J0VmFyaWFibGVxAH4ABEwAB3BheWxvYWRxAH4ABHhwAQEBAQEBAQEBAQEBAQEBAXQAGCR7YWxsb3dlZF9jdXN0b21fY2xhaW1zfXQABGRpZHR0AA4ke2p3dC5wYXlsb2FkfXQAGk9wZW5JRENvbm5lY3RBc3NlcnRpb24uamFydAAuRGVjb2RlcyBhbiBJRCBUb2tlbiBwYXNzZWQgaW4gYXMgSlNPTiBtZXNzYWdlLnBwcA==</L7p:base64SerializedValue>\n                                    </L7p:CustomAssertion>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"d881a6b7-113c-4688-8a9c-17f5c0426972\"/>\n                                    <L7p:PolicyName stringValue=\"#OTK id_token Validate Custom Claims\"/>\n                                    </L7p:Include>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${didt.aud}\"/>\n                                    <L7p:Expression2 stringValue=\"${client_id_bcp}\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:RightValue stringValue=\"${client_id_bcp}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"dmFsaWQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"verified\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"aW52YWxpZA==\"/>\n                                    <L7p:VariableToSet stringValue=\"verified\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PHA+VGhlIGlkX3Rva2VuIHBheWxvYWQgbG9va3MgbGlrZSB0aGlzOjwvcD4NCjxwcmU+JHtqd3QucGF5bG9hZH08L3ByZT4NCjxvbD4NCiAgICA8bGk+VmVyaWZ5IHRoZSBJRF9UT0tFTiBtZW1iZXIgJ2F1ZCcuIEl0IG11c3QgYmUgdGhlIGNsaWVudF9pZDwvbGk+DQogICAgPGxpPlZlcmlmeSB0aGUgSURfVE9LRU4gbWVtYmVyICdleHAnLiBJdCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiB0aGUgdGltZSAnbm93JyBpbiBVVEMgdGltZXpvbmU8L2xpPg0KICAgIDxsaT5Nb3JlIHZlcmlmaWNhdGlvbnMgYXJlIG9wdGlvbmFsPC9saT4NCjwvb2w+DQo8cD48Yj5WZXJpZmljYXRpb24gcmVzdWx0OiAke3ZlcmlmaWVkfTwvYj48L3A+DQo8cD48Yj5BZGRpdGlvbmFsIHNpZ25hdHVyZSB2YWxpZGF0aW9uOiB2YWxpZDwvYj48L3A+\"/>\n                                    <L7p:VariableToSet stringValue=\"idTokenIssued\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PHA+PGI+Tm8gSURfVE9LRU4gd2FzIGlzc3VlZDwvYj4uIFRoZXJlIGFyZSBzZXZlcmFsIHBvc3NpYmxlIHJlYXNvbnMgZm9yIHRoYXQ6PC9wPg0KPG9sPg0KPGxpPnRoZSB1c2VyIGRpZCBub3QgZ3JhbnQgaXQ8L2xpPg0KPGxpPnRoZSByZXF1ZXN0ZWQgU0NPUEUgZGlkIG5vdCBpbmNsdWRlICdvcGVuaWQnPC9saT4NCjxsaT50aGUgY2xpZW50IHdhcyBub3QgcmVnaXN0ZXJlZCBhcyBhIHZhbGlkIE9wZW5JRCBDb25uZWN0IGNsaWVudDwvbGk+DQo8bGk+YSByZWZyZXNoX3Rva2VuIHdhcyB1c2VkIHRvIHJlcXVlc3QgbmV3IHRva2VucyBidXQgYSByZWZyZXNoX3Rva2VuIGNhbm5vdCBiZSB1c2VkIHRvIHJlcXVlc3QgYSBuZXcgaWRfdG9rZW48L2xpPg0KPC9vbD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"idTokenIssued\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Check for an id_token\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjb2RlUmVxdWVzdFJlc3BvbnNlfQ0KPHA+VGhlIGF1dGhvcml6YXRpb24gc2VydmVyIGhhcyB2YWxpZGF0ZWQgdGhlIHJlcXVlc3QgYW5kIHJldHVybmVkIHRoaXMgcmVzdWx0IHRvIHRoZSBjbGllbnQ6PC9wPg0KPHByZT4ke2F1dGhTZXJ2ZXJSZXNwb25zZS5tYWlucGFydH08L3ByZT4NCjxici8+DQo8cD48Yj5UaGUgdG9rZW5zIHNob3VsZCBub3QgYmUgZXhwb3NlZCB0byB0aGUgdXNlci1hZ2VudCBpbiBhIHJlYWwgbGlmZSBzY2VuYXJpbyE8L2I+PC9wPg0KPHA+PGI+SW1wb3J0YW50OjwvYj4gVGhlIGNsaWVudCBoYXMgdG8gdmVyaWZ5IHRoZSBjb250ZW50IG9mIHRoZSBJRF9UT0tFTiBhbmQgbm90IHVzZSBpZiB0aGUgdmVyaWZpY2F0aW9uIGZhaWxzITwvcD4NCiR7aWRUb2tlbklzc3VlZH0NCjxwPlRoZSBpbmNsdWRlZCB0b2tlbnMgY2FuIG5vdyBiZSB1c2VkIHRvIGFjY2VzcyB0aGUgdXNlcnMgcmVzb3VyY2VzIG9yIHRoZSAnL3VzZXJpbmZvJyBlbmRwb2ludCB0byByZXF1ZXN0IGNsYWltcyBhYm91dCB0aGUgdXNlci48L3A+DQo8cD5Cb3RoIHJlcXVlc3RzIHdpbGwgdXNlIEhUVFAgJ1BPU1QnIGFuZCB0aGUgcGFyYW1ldGVyICdhY2Nlc3NfdG9rZW4nIHdoaWNoLCBvZiBjb3Vyc2UsIGluY2x1ZGVzIHRoZSBhY2Nlc3MgdG9rZW4uPC9wPg0KPHA+PGI+YWNjZXNzX3Rva2VuOjwvYj4gJHthY2Nlc3NfdG9rZW59PC9wPg0KPHA+R28gYWhlYWQgYW5kIHVzZSB0aGUgPGI+YWNjZXNzX3Rva2VuPC9iPjo8L3A+DQo8Zm9ybSBhY3Rpb249IiR7bG9jYXRpb25fYXBwfSIgdGFyZ2V0PSJyZXN1bHQiIG1ldGhvZD0iUE9TVCI+DQogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYWNjZXNzX3Rva2VuIiB2YWx1ZT0iJHthY2Nlc3NfdG9rZW59Ij4NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIgdmFsdWU9InByIj4NCiAgICBSZXF1ZXN0IHJlc291cmNlczogPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IGJ0bi1taW5pIiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJSZXNvdXJjZXMiPlJlc291cmNlczwvYnV0dG9uPiAoJHtsb2NhdGlvbl9yZXNvdXJjZWVuZHBvaW50fSkNCjwvZm9ybT4NCjxici8+DQo8cD5UbyBhY2Nlc3MgdGhlIC91c2VyaW5mbyBlbmRwb2ludCB0aGUgYWRkaXRpb25hbCBwYXJhbWV0ZXItdmFsdWUgcGFpciAnc2NoZW1hPW9wZW5pZCcgaXMgcmVxdWlyZWQhPC9wPg0KPGZvcm0gYWN0aW9uPSIke2xvY2F0aW9uX3VzZXJpbmZvZW5kcG9pbnR9IiB0YXJnZXQ9InJlc3VsdCIgbWV0aG9kPSJQT1NUIj4NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzY2hlbWEiIHZhbHVlPSJvcGVuaWQiPg0KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjY2Vzc190b2tlbiIgdmFsdWU9IiR7YWNjZXNzX3Rva2VufSI+DQogICAgUmVxdWVzdCB1c2VyIGNsYWltczogPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IGJ0bi1taW5pIiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJDbGFpbXMiPkNsYWltczwvYnV0dG9uPiAoJHtsb2NhdGlvbl91c2VyaW5mb2VuZHBvaW50fSkNCjwvZm9ybT4NCjxwPlJlc3VsdCBhZnRlciBhY2Nlc3NpbmcgcmVzb3VyY2VzIG9yIHRoZSB1c2VyaW5mbyBlbmRwb2ludDo8L3A+DQo8aWZyYW1lIGlkPSJyZXN1bHQiIG5hbWU9InJlc3VsdCIgd2lkdGg9IjYwMCI+PC9pZnJhbWU+DQoke3JlZnJlc2hfdG9rZW5fZGlzcGxheX0NCjxwPjxhIGhyZWY9IiR7bG9jYXRpb25fYXBwfSIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+UmVwZWF0IFJlcXVlc3Q8L2E+PC9wPg==\"/>\n                                    <L7p:ContentType stringValue=\"text/html;charset=UTF-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"tokenResult\"/>\n                                </L7p:SetVariable>\n                                <L7p:UUIDGenerator>\n                                    <L7p:MaximumQuantity intValue=\"1\"/>\n                                    <L7p:TargetVariable stringValue=\"key\"/>\n                                </L7p:UUIDGenerator>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"dd360775-0fec-47db-8b45-059d995b262d\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Store\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"300\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"tokenResult\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${key[0]}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxEntries\"/>\n                                    <L7p:value stringValue=\"1000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxSize\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"dbAge\"/>\n                                    <L7p:value stringValue=\"300\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value stringValue=\"${tokenResult.mainpart}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:HardcodedResponse>\n                                    <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"302\"/>\n                                </L7p:HardcodedResponse>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Location\"/>\n                                    <L7p:HeaderValue stringValue=\"${location_app}?state=view&amp;code=${key[0]}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                            </wsp:All>\n                            <L7p:HardcodedResponse>\n                                <L7p:Base64ResponseBody stringValue=\"JHtodG1sVGVtcGxhdGVUb3B9DQo8cD5Tb3JyeSwgYnV0IHRoZSBhdXRob3JpemF0aW9uX2NvZGUgaGFzIGJlZW4gcHJvY2Vzc2VkIGFscmVhZHkuPC9wPg0KPHA+PGEgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgaHJlZj0iJHtsb2NhdGlvbl9hcHB9Ij5SZXBlYXQgUmVxdWVzdDwvYT48L3A+DQoke2h0bWxUZW1wbGF0ZUJvdHRvbX0=\"/>\n                                <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            </L7p:HardcodedResponse>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"GRANTED\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.parameter.state}\"/>\n                            <L7p:Expression2 stringValue=\"init\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"init\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"Y2FsbA==\"/>\n                            <L7p:VariableToSet stringValue=\"state\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"Y2FsbA==\"/>\n                            <L7p:VariableToSet stringValue=\"state\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"client_id_bcp\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"client_id\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"scope\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"scope\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"oauth2_resource\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"resource\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"response_type\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"response_type\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"redirect_uri\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"redirect_uri\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"display\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"display\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"prompt\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"prompt\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"state\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"state\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"request.http.parameter.nonce\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"nonce\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"request.http.parameter.code_challenge\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"code_challenge\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"request.http.parameter.code_challenge_method\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"code_challenge_method\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"Y2xpZW50X2lkPSR7Y2xpZW50X2lkfSZyZXNwb25zZV90eXBlPSR7cmVzcG9uc2VfdHlwZX0mc2NvcGU9JHtzY29wZX0mcmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RfdXJpfSZkaXNwbGF5PSR7ZGlzcGxheX0mcHJvbXB0PSR7cHJvbXB0fSZzdGF0ZT0ke3N0YXRlfSZub25jZT0ke25vbmNlfSZyZXNvdXJjZT0ke3Jlc291cmNlfSZjb2RlX2NoYWxsZW5nZT0ke2NvZGVfY2hhbGxlbmdlfSZjb2RlX2NoYWxsZW5nZV9tZXRob2Q9JHtjb2RlX2NoYWxsZW5nZV9tZXRob2R9\"/>\n                            <L7p:VariableToSet stringValue=\"authRequestParameters\"/>\n                        </L7p:SetVariable>\n                        <L7p:HardcodedResponse>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Location\"/>\n                            <L7p:HeaderValue stringValue=\"${location_authserver}?${authRequestParameters}\"/>\n                            <L7p:RemoveExisting booleanValue=\"true\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Create auth-request and redirect client\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"aW5pdA==\"/>\n                            <L7p:VariableToSet stringValue=\"state\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"state\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"state\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"gateway.time.HHssmmSSS\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"nonce\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"czI1Ng==\"/>\n                            <L7p:VariableToSet stringValue=\"code_challenge_method\"/>\n                        </L7p:SetVariable>\n                        <L7p:GenerateSecurityHash>\n                            <L7p:Algorithm stringValue=\"SHA-256\"/>\n                            <L7p:Base64Data stringValue=\"JHtjb2RlX3ZlcmlmaWVyfQ==\"/>\n                            <L7p:LineBreak lineBreak=\"CR-LF\"/>\n                            <L7p:TargetOutputVariable stringValue=\"hashedValue\"/>\n                        </L7p:GenerateSecurityHash>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"bed74d70-cc8b-46b8-8efc-f5a8a995b2f3\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Encode base64url\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"base64_encoded\"/>\n                                    <L7p:value stringValue=\"${hashedValue}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:HardcodedResponse>\n                            <L7p:Base64ResponseBody stringValue=\"JHtodG1sVGVtcGxhdGVUb3B9CjxoMT5HcmFudCB0eXBlOiBBdXRob3JpemF0aW9uIGNvZGUgd2l0aCBQS0NFPC9oMT4KPHA+VGhpcyBjbGllbnQgaXMgZ29pbmcgdG8gcmVxdWVzdCBhbiBPQXV0aCAyLjAgYWNjZXNzX3Rva2VuLCByZWZyZXNoX3Rva2VuIGFuZCBhbiBPcGVuSUQgQ29ubmVjdCBpZF90b2tlbi48L3A+CjxwPlRoZSBjbGllbnQgaXMgdXNpbmcgdGhlIDxiPnJlc3BvbnNlX3R5cGU9Y29kZTwvYj48L3A+CjxwPlRoaXMgY2xpZW50IGlzIGV4cG9zaW5nIHNvbWUgdmFsdWVzIE9OTFkgdG8gZGlzcGxheSB3aGF0IGlzIGdvaW5nIG9uIGJlaGluZCB0aGUgc2NlbmVzLiAnSGlkZGVuJyBpbiB0aGUgdGFibGUgYmVsb3cKICAgIHJlZmVycyB0byB2YWx1ZXMgdGhhdCBzaG91bGQgbm90LyBkbyBub3QgaGF2ZSB0byBiZSBleHBvc2VkIHRvIHRoZSB1c2VyLWFnZW50IGluIGEgcmVhbC13b3JsZCBzY2VuYXJpbzwvcD4KPHA+Rm9yIGFueSBtb3JlIGRldGFpbHMgcGxlYXNlIHJlZmVyIHRvIHRoaXMgd2Vic2l0ZTogPGEgaHJlZj0iaHR0cDovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtYmFzaWMtMV8wLmh0bWwiIHRhcmdldD0iX2JsYW5rIj5vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWJhc2ljLTFfMC5odG1sPC9hPjwvcD4KPHA+V2l0aCB0aGlzIHJlc3BvbnNlX3R5cGUgdGhlIGNsaWVudCBoYXMgdG8gYnVpbGQgdXAgYSByZXF1ZXN0IHVzaW5nIGZvbGxvd2luZyB2YWx1ZXM6PC9wPgo8dGFibGU+CiAgICA8dHI+PHRoPlBhcmFtZXRlcjwvdGg+PHRoPlZhbHVlPC90aD48dGg+UmVxdWlyZWQ8L3RoPjx0aD5IaWRkZW48L3RoPjx0aD5Db21tZW50PC90aD48L3RyPgogICAgPHRyPjx0ZD5jbGllbnRfaWQ8L3RkPjx0ZD4ke2NsaWVudF9pZF9iY3B9PC90ZD48dGQ+WWVzPC90ZD48dGQ+Tm88L3RkPjx0ZD5NVVNUIGJlIGtub3duIGF0IHRoZSBhdXRob3JpemF0aW9uIHNlcnZlcjwvdGQ+PC90cj4KICAgIDx0cj48dGQ+c2NvcGU8L3RkPjx0ZD4ke3Njb3BlfTwvdGQ+PHRkPlllczwvdGQ+PHRkPk5vPC90ZD48dGQ+TVVTVCBpbmNsdWRlICdvcGVuaWQnIHRvIG1ha2UgaXQgYSB2YWxpZCBPcGVuSUQgQ29ubmVjdCByZXF1ZXN0PC90ZD48L3RyPgogICA8dHI+PHRkPnJlc291cmNlPC90ZD48dGQ+JHtvYXV0aDJfcmVzb3VyY2V9PC90ZD48dGQ+Tm88L3RkPjx0ZD5ZZXM8L3RkPjx0ZD5Gb3Igb2F1dGggMi4wLCB0aGUgcmVzb3VyY2VzIGdyYW50ZWQgaW4gdGhlIHRva2VuPC90ZD48L3RyPgogICAgPHRyPjx0ZD5yZXNwb25zZV90eXBlPC90ZD48dGQ+JHtyZXNwb25zZV90eXBlfTwvdGQ+PHRkPlllczwvdGQ+PHRkPk5vPC90ZD48dGQ+TVVTVCBiZSBzZXQgdG8gJ2NvZGUnPC90ZD48L3RyPgogICAgPHRyPjx0ZD5yZWRpcmVjdF91cmk8L3RkPjx0ZD4ke3JlZGlyZWN0X3VyaX08L3RkPjx0ZD5ZZXM8L3RkPjx0ZD5ObzwvdGQ+PHRkPk1VU1QgYmUgcHJlLXJlZ2lzdGVyZWQgd2l0aCB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXI8L3RkPjwvdHI+CiAgICA8dHI+PHRkPm5vbmNlPC90ZD48dGQ+JHtub25jZX08L3RkPjx0ZD5ZZXM8L3RkPjx0ZD5ObzwvdGQ+PHRkPkEgcmFuZG9tIHZhbHVlIG9wYXF1ZSB0byB0aGUgc2VydmVyLiBJdCBoYXMgdG8gYXBwZWFyIHdpdGhpbiBpZF90b2tlbjwvdGQ+PC90cj4KICAgIDx0cj48dGQ+c3RhdGU8L3RkPjx0ZD4ke3N0YXRlfTwvdGQ+PHRkPk5vPC90ZD48dGQ+Tm88L3RkPjx0ZD5BIHZhbHVlIG9wYXF1ZSB0byB0aGUgYXV0aG9yaXphdGlvbiBzZXJ2ZXI7IHdpbGwgYmUgcGFzc2VkIGJhY2sgdG8gdGhlIGNsaWVudDwvdGQ+PC90cj4KICAgIDx0cj48dGQ+Y29kZV9jaGFsbGVuZ2U8L3RkPjx0ZD4ke2Jhc2U2NHVybF9lbmNvZGVkfTwvdGQ+PHRkPk5vPC90ZD48dGQ+Tm88L3RkPjx0ZD5IYXNoZWQgdmFsdWUgb2YgY29kZV92ZXJpZmllciBiYXNlZCBvbiBjb2RlX2NoYWxsZW5nZV9tZXRob2Q8L3RkPjwvdHI+CiAgICA8dHI+PHRkPmNvZGVfY2hhbGxlbmdlX21ldGhvZDwvdGQ+PHRkPiR7Y29kZV9jaGFsbGVuZ2VfbWV0aG9kfTwvdGQ+PHRkPlllczwvdGQ+PHRkPk5vPC90ZD48dGQ+TWV0aG9kIHVzZWQgdG8gZ2VuZXJhdGUgY29kZSBjaGFsbGVuZ2UgdmFsdWUgKHBsYWluLCBTMjU2KTwvdGQ+PC90cj4KICAgIDx0cj48dGQ+ZGlzcGxheTwvdGQ+PHRkPiR7ZGlzcGxheX08L3RkPjx0ZD5ObzwvdGQ+PHRkPk5vPC90ZD48dGQ+VmFsaWQgdmFsdWVzIHRoYXQgc3BlY2lmeSBob3cgdGhlIGF1dGhvcml6YXRpb24gc2VydmVyIHNob3VsZCBkaXNwbGF5IHRoZSBhdXRob3JpemF0aW9uIHBhZ2U6ICdwYWdlJ3wncG9wdXAnfCd0b3VjaCd8J3dhcCc8L3RkPjwvdHI+CiAgICA8dHI+PHRkPnByb21wdDwvdGQ+PHRkPiR7cHJvbXB0fTwvdGQ+PHRkPk5vPC90ZD48dGQ+Tm88L3RkPjx0ZD5WYWxpZCB2YWx1ZXMgdGhhdCBzcGVjaWZ5IGlmIHRoZSBhdXRob3JpemF0aW9uIHNlcnZlciBzaG91bGQgKHJlLSlhdXRoZW50aWNhdGUgdGhlIHVzZXI6ICdub25lJ3wnbG9naW4nfCdjb25zZW50J3wnc2VsZWN0X2FjY291bnQnPC90ZD48L3RyPgo8L3RhYmxlPgo8L2JyPgo8cD5UaGUgY2xpZW50IGlzIHNlbmRpbmcgdGhlIHJlcXVlc3QgdG8gdGhpcyBhdXRob3JpemF0aW9uIHNlcnZlciB1c2luZyBIVFRQICdQT1NUJzo8L3A+PHByZT4ke2xvY2F0aW9uX2F1dGhzZXJ2ZXJ9PC9wcmU+Cjxici8+CjxwPlRoZSBwYXJhbWV0ZXIgdmFsdWVzIG11c3QgYmUgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgZW5jb2RlZDo8L3A+Cjxmb3JtIGFjdGlvbj0iJHtsb2NhdGlvbl9hcHB9Ij4KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InN0YXRlIiB2YWx1ZT0iaW5pdCIvPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ibm9uY2UiIHZhbHVlPSIke25vbmNlfSIvPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iY29kZV9jaGFsbGVuZ2UiIHZhbHVlPSIke2Jhc2U2NHVybF9lbmNvZGVkfSIvPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iY29kZV9jaGFsbGVuZ2VfbWV0aG9kIiB2YWx1ZT0iJHtjb2RlX2NoYWxsZW5nZV9tZXRob2R9Ii8+CiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJyZXNvdXJjZSIgIHZhbHVlPSIke29hdXRoMl9yZXNvdXJjZX0iLz4KICAgIDxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9InNlbmQiIHZhbHVlPSJzZW5kIi8+CjwvZm9ybT4KPHA+KFdoZW4geW91IGhpdCB0aGUgJ3NlbmQnIGJ1dHRvbiB0aGlzIHVzZXItYWdlbnQgc2VuZHMgYSByZXF1ZXN0IHRvIHRoZSBjbGllbnQsIHRoZSBjbGllbnQgcHJlcGFyZXMgdGhlIGF1dGhvcml6YXRpb24gcmVxdWVzdCBhbmQgZGlyZWN0cyB0aGlzIHVzZXItYWdlbnQgdG8gdGhlIHNlcnZlciBsb2NhdGlvbiB1c2luZyBhIHJlZGlyZWN0KTwvcD4KJHtodG1sVGVtcGxhdGVCb3R0b219\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"INITIAL\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                </wsp:OneOrMore>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"Basic Client Profile\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"response_type=code\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>"
  }
}