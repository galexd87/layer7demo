{
  "goid": "e001cfd0c1c1ffaa18e187b5e72fdec5",
  "guid": "d191e2e3-e68a-40ef-8899-0e1640e10041",
  "name": "auth/oauth/v2/authorize",
  "resolutionPath": "/auth/oauth/v2/authorize",
  "serviceType": "WEB_API",
  "checksum": "27ca7125e9e234ead28961293f9ed34c35dc4d03",
  "enabled": true,
  "folderPath": "/OTK/Server/DMZ/OAuth 2.0/AuthorizationServer",
  "methodsAllowed": [
    "GET",
    "POST",
    "PUT",
    "PATCH",
    "DELETE",
    "HEAD",
    "OPTIONS",
    "OTHER"
  ],
  "tracingEnabled": false,
  "wssProcessingEnabled": false,
  "laxResolution": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== *** THIS POLICY IS OVERWRITTEN DURING AN UPGRADE ***\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== Be aware that custom configuration made in this policy is overwritten during a solution kit upgrade.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== However, the older version of the policy is kept in the history and can be referenced.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== After upgrade, manually merge customizations from the old version of the policy to the new version.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"This policy issues an authorization grant or an token for 'token' response_type\"/>\n        </L7p:CommentAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${gateway.otk.enable_auditing}\"/>\n                <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:AuditAssertion/>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Audit the service policy execution\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:CustomizeErrorResponse>\n            <L7p:Content stringValue=\"${error.msg}\"/>\n            <L7p:ContentType stringValue=\"${content-type}\"/>\n            <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Cache-Control\"/>\n                    <L7p:Value stringValue=\"no-store\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Pragma\"/>\n                    <L7p:Value stringValue=\"no-cache\"/>\n                </L7p:item>\n            </L7p:ExtraHeaders>\n            <L7p:HttpStatus stringValue=\"${status}\"/>\n        </L7p:CustomizeErrorResponse>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbbc4f7d-cd06-41f3-8011-695bfad1d80b\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Configuration\"/>\n        </L7p:Encapsulated>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6\"/>\n            <L7p:PolicyName stringValue=\"OTK Security Header Extension\"/>\n        </L7p:Include>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"initialize\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"will be overridden in the case of an error\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"\"/>\n            <L7p:VariableToSet stringValue=\"error.code\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"initialize\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"will be overridden in the case of an error\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"\"/>\n            <L7p:VariableToSet stringValue=\"error.msg\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"API-ID 3000\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"47f768f4-b478-472b-a1ee-10f4b6e76f99\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Require SSL (with Client Certificate)\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"3000\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireClientCert\"/>\n                        <L7p:value stringValue=\"false\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"SSL\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Require SSL\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"POST GET\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b8822449-71ff-455b-8f10-39122e6c549b\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK HTTP Method Validation\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"custom\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"method\"/>\n                        <L7p:value stringValue=\"POST|GET|OPTIONS\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Method\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Checking the HTTP method\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// optional\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"bac17a37-0b06-47fd-910c-4faced9489c3\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK CORS\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"custom\"/>\n                        <L7p:value stringValue=\"{&quot;url_path_query&quot;:&quot;${request.url.path}${request.url.query}&quot;, &quot;http_method_allowed&quot;: &quot;${http_method_allowed}&quot;}\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"dynamic_origins\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireCORS\"/>\n                        <L7p:value stringValue=\"optional\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// error code produced in previous assertion\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"givenErrorCode\"/>\n                        <L7p:value stringValue=\"${error.code}\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"CORS\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Check for CORS\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${isPreflight}\"/>\n                    <L7p:MultivaluedComparison multivaluedComparison=\"FIRST\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlcXVlc3RfdXJpfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"request_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"request_uri_ref\"/>\n                            <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"request_uri\"/>\n                            <L7p:Regex stringValue=\"^(urn:ietf:params:oauth:request_uri:)(.*)\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X3VyaV9yZWZbMV19\"/>\n                            <L7p:VariableToSet stringValue=\"request_uri_reference\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsaWVudF9pZH0=\"/>\n                            <L7p:VariableToSet stringValue=\"client_id\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"isParRequest\"/>\n                        </L7p:SetVariable>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"isParRequest\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// check par request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${isParRequest}\"/>\n                        <L7p:Expression2 stringValue=\"true\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"2c24688c-9f1e-4523-b7da-819dfc388b1a\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid require_pushed_authorization_requests\"/>\n                        </L7p:Encapsulated>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${require_pushed_authorization_requests}\"/>\n                            <L7p:Expression2 stringValue=\"false\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                    </wsp:All>\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error.code 391\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"apiPrefix\"/>\n                                <L7p:value stringValue=\"3000\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"givenErrorCode\"/>\n                                <L7p:value stringValue=\"391\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// verify require_pushed_authorization_requests\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${isParRequest}\"/>\n                        <L7p:Expression2 stringValue=\"true\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:HtmlFormDataAssertion>\n                            <L7p:AllowGet booleanValue=\"true\"/>\n                            <L7p:AllowPost booleanValue=\"true\"/>\n                            <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"true\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"acr_values\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:MinOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"client_id\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"code_challenge\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"code_challenge_method\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"display\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"id_token_hint\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"login_hint\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"number\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"max_age\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"nonce\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"prompt\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"redirect_uri\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:MinOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"response_type\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"scope\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"state\"/>\n                                </L7p:item>\n                                <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"resource\"/>\n                                </L7p:item>\n                            </L7p:FieldSpecs>\n                        </L7p:HtmlFormDataAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsaWVudF9pZH0=\"/>\n                            <L7p:VariableToSet stringValue=\"client_id\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnN0YXRlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"state\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLm5vbmNlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"nonce\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmRpc3BsYXl9\"/>\n                            <L7p:VariableToSet stringValue=\"display\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmlkX3Rva2VuX2hpbnR9\"/>\n                            <L7p:VariableToSet stringValue=\"id_token_hint\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmxvZ2luX2hpbnR9\"/>\n                            <L7p:VariableToSet stringValue=\"login_hint\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNjb3BlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"scopeOriginal\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc291cmNlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"resourceOriginal\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNvZGVfY2hhbGxlbmdlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"codeChallenge\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNvZGVfY2hhbGxlbmdlX21ldGhvZH0=\"/>\n                            <L7p:VariableToSet stringValue=\"codeChallengeMethod\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLm1heF9hZ2V9\"/>\n                            <L7p:VariableToSet stringValue=\"maxAge\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc3BvbnNlX3R5cGV9\"/>\n                            <L7p:VariableToSet stringValue=\"response_type\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc3BvbnNlX21vZGV9\"/>\n                            <L7p:VariableToSet stringValue=\"response_mode\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXNwb25zZV9tb2RlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"response_mode_original\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnByb21wdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"prompt\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlZGlyZWN0X3VyaX0=\"/>\n                            <L7p:VariableToSet stringValue=\"redirect_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlcXVlc3R9\"/>\n                            <L7p:VariableToSet stringValue=\"authorize_request\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlcXVlc3RfdXJpfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"request_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFjcl92YWx1ZXN9\"/>\n                            <L7p:VariableToSet stringValue=\"acr_values\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsYWltc30=\"/>\n                            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"claims\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"acr_values_essential\"/>\n                        </L7p:SetVariable>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"355ca731-f92a-4d64-b41a-8533eedfa651\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Profile Configuration\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_advanced}\"/>\n                                <L7p:Expression2 stringValue=\"false\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${authorize_request}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${request_uri}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${claims.mainpart}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:EvaluateJsonPathExpressionV2>\n                                    <L7p:Expression stringValue=\"$.id_token.acr\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"claims\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:EvaluateJsonPathExpressionV2>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqc29uUGF0aC5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"acr_values\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:TrueAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//find &amp; set acr_values\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${claims.mainpart}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:EvaluateJsonPathExpressionV2>\n                                    <L7p:Expression stringValue=\"$.id_token.acr.essential\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"claims\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:EvaluateJsonPathExpressionV2>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqc29uUGF0aC5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"acr_values_essential\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:TrueAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// find &amp; sent acr essential\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${authorize_request}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${request_uri}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8b840599-e682-4027-99d7-aaac4d70c434\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Decode JWT Request Object\"/>\n                                </L7p:Encapsulated>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZXF1ZXN0LnBheWxvYWR9\"/>\n                                    <L7p:VariableToSet stringValue=\"authorizeRequestMessage\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjbGllbnRfaWR9\"/>\n                                    <L7p:VariableToSet stringValue=\"authzreq.client_id\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXNwb25zZV90eXBlfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"authzreq.response_type\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzY29wZU9yaWdpbmFsfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"authzreq.scope\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZWRpcmVjdF91cml9\"/>\n                                    <L7p:VariableToSet stringValue=\"authzreq.redirect_uri\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtub25jZX0=\"/>\n                                    <L7p:VariableToSet stringValue=\"authzreq.nonce\"/>\n                                </L7p:SetVariable>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8f9785e7-43f0-48ee-96cd-f2275d7048eb\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorize JWT Request Validation\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"authorizeRequestPayload\"/>\n                                    <L7p:value stringValue=\"${authorizeRequestMessage}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"clientId\"/>\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"responseType\"/>\n                                    <L7p:value stringValue=\"${response_type}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//extract request object claims if present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Validate and extract params from request\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//default error code for invalid parameter\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"MTAz\"/>\n                                    <L7p:VariableToSet stringValue=\"error.code\"/>\n                                </L7p:SetVariable>\n                            </wsp:OneOrMore>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3000\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"${error.code}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//extract request params from request object\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${isParRequest}\"/>\n                        <L7p:Expression2 stringValue=\"true\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${prompt}\"/>\n                                <L7p:Operator operatorNull=\"null\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:CaseInsensitive booleanValue=\"true\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                <L7p:Regex stringValue=\"^(none|login|consent|login consent|consent login)$\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"handle prompt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail with error if prompt = none with any other value\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAuaGVhZGVydmFsdWVzLm1hZy1pZGVudGlmaWVyfEBAfSMj\"/>\n                            <L7p:VariableToSet stringValue=\"requestHeaders\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Presence of '@@' indicates duplicate parameters\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"requestHeaders\"/>\n                            <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                            <L7p:Regex stringValue=\"[@]{2}|[,]\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3000\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3000\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Validate prompt parameter in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"=== Mobile SSO\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"the mag-identifier. either to '...mag-identifier' or '...device-identifier' to support older SDK versions\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLm1hZy1pZGVudGlmaWVyfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"mag-identifier\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${isParRequest}\"/>\n                                    <L7p:Expression2 stringValue=\"false\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item regex=\"included\">\n                                    <L7p:Pattern stringValue=\"query|fragment|form_post|query.jwt|fragment.jwt|form_post.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:CustomAssertion>\n                                    <L7p:base64SerializedValue>rO0ABXNyADFjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uQ3VzdG9tQXNzZXJ0aW9uSG9sZGVyZtcreFwddTICAAlaAAxpc1VpQXV0b09wZW5MAApjYXRlZ29yaWVzdAAPTGphdmEvdXRpbC9TZXQ7TAAIY2F0ZWdvcnl0ACpMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DYXRlZ29yeTtMAA9jdXN0b21Bc3NlcnRpb250ADFMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DdXN0b21Bc3NlcnRpb247TAAUY3VzdG9tTW9kdWxlRmlsZU5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMAA9kZXNjcmlwdGlvblRleHRxAH4ABEwAD3BhbGV0dGVOb2RlTmFtZXEAfgAETAAOcG9saWN5Tm9kZU5hbWVxAH4ABEwAHnJlZ2lzdGVyZWRDdXN0b21GZWF0dXJlU2V0TmFtZXEAfgAEeHIAJWNvbS5sN3RlY2gucG9saWN5LmFzc2VydGlvbi5Bc3NlcnRpb27bX2OZPL2isQIAAloAB2VuYWJsZWRMABBhc3NlcnRpb25Db21tZW50dAAvTGNvbS9sN3RlY2gvcG9saWN5L2Fzc2VydGlvbi9Bc3NlcnRpb24kQ29tbWVudDt4cAFwAXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyAChjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uZXh0LkNhdGVnb3J5WrCcZaFE/jUCAAJJAAVteUtleUwABm15TmFtZXEAfgAEeHAAAAAHdAAfTWVzc2FnZVZhbGlkYXRpb25UcmFuc2Zvcm1hdGlvbnhwc3IAUGNvbS5sN3RlY2guY3VzdG9tLmNoZWNrcmVzcG9uc2V0eXBlc3VwcG9ydGVkLkNoZWNrUmVzcG9uc2VUeXBlU3VwcG9ydGVkQXNzZXJ0aW9uKyTM/B4g200CAAJMAA1yZXNwb25zZV90eXBlcQB+AARMABhyZXNwb25zZV90eXBlc19zdXBwb3J0ZWRxAH4ABHhwdAASIiR7cmVzcG9uc2VfdHlwZX0idABYImlkX3Rva2VuIiwidG9rZW4gaWRfdG9rZW4iLCJjb2RlIHRva2VuIiwiY29kZSBpZF90b2tlbiB0b2tlbiIsInRva2VuIiwiY29kZSBpZF90b2tlbuKAnXQANDFjMzMzZGIxN2IwMjU2ODdiM2FhMWJlNDE0ZjUyNjU0MWI5ZTNiYjljYzhlODFjNi5qYXJ0ACVDaGVjayBpZiBhIHJlc3BvbnNlX3R5cGUgaXMgc3VwcG9ydGVkcHBw</L7p:base64SerializedValue>\n                                    </L7p:CustomAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZnJhZ21lbnQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"response_mode\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"cXVlcnk=\"/>\n                                    <L7p:VariableToSet stringValue=\"response_mode\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// if code response_mode=query, otherwise fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// set default response_mode if it is not one of the supported list\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode_original}\"/>\n                                    <L7p:Expression2 stringValue=\"jwt\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXNwb25zZV9tb2RlfS5qd3Q=\"/>\n                                    <L7p:VariableToSet stringValue=\"response_mode\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// translate the jwt response_mode alias to the recommended one\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_type}\"/>\n                                    <L7p:Expression2 stringValue=\"code\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"code\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"query.jwt\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"query.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZnJhZ21lbnQuand0\"/>\n                                    <L7p:VariableToSet stringValue=\"response_mode\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// do not allow query.jwt for non-CODE response_type flows\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${codeChallenge}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${codeChallengeMethod}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"cGxhaW4=\"/>\n                                    <L7p:VariableToSet stringValue=\"codeChallengeMethod\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"PKCE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                    <L7p:Regex stringValue=\"none|login|consent\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"bG9naW4gY29uc2VudA==\"/>\n                                    <L7p:VariableToSet stringValue=\"prompt\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"prompt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Can only contain 'none', 'consent', 'login'. 'select_account' is not yet supported\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"display\"/>\n                                    <L7p:Regex stringValue=\"page|social_login|local|template\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"cGFnZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"display\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"display\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Can only contain 'page', 'social_login'. 'popup', 'touch', 'wap' are not yet supported\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"OIDC\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Set default values for optional OpenID Connect parameters\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"state\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"stateEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"nonce\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"nonceEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"display\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"displayEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"prompt\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"promptEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"acr_values\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"acr_valuesEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"acr_values_essential\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"acr_values_essentialEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"id_token_hint\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"id_token_hintEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"login_hint\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"login_hintEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"scopeOriginal\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"scopeOriginalEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"resourceOriginal\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"resourceOriginalEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"codeChallenge\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"codeChallengeEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9c7b1db0-98a4-4795-bcc2-db362aeca069\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Request Validation\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"acr_values\"/>\n                                    <L7p:value stringValue=\"${acr_values}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"acr_values_essential\"/>\n                                    <L7p:value stringValue=\"${acr_values_essential}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"codeChallenge\"/>\n                                    <L7p:value stringValue=\"${codeChallenge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"codeChallengeMethod\"/>\n                                    <L7p:value stringValue=\"${codeChallengeMethod}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${nonce}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${redirect_uri}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${resourceOriginal}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${response_mode}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"response_type\"/>\n                                    <L7p:value stringValue=\"${response_type}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${scopeOriginal}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"state\"/>\n                                    <L7p:value stringValue=\"${state}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathResult\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:result/text()='valid'\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathScope\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:scope/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathResource\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:resource/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathClientIdent\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:client_ident/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathName\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:clientName/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathRedirectURI\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:redirect_uri/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathResponseType\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:response_type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathResponseMode\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:response_mode\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathClientType\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:client_type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathClientCustom\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:client_custom\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathClientKeyCustom\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:validation/ns:client_key_custom\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-ovp\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathScope.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"xpathScopeEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathResource.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"xpathResourceEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathName.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"xpathNameEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathRedirectURI.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"xpathRedirectURIEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathResponseType.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"xpathResponseTypeEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathResponseMode.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"xpathResponseModeEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"client_id\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"client_idEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"xpathClientIdent.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"clientIdentEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt4cGF0aENsaWVudFR5cGUucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"xpathClientTypeEncoded\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt4cGF0aENsaWVudEN1c3RvbS5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"xpathClientCustomEncoded\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt4cGF0aENsaWVudEtleUN1c3RvbS5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"xpathClientKeyCustomEncoded\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"redirect_uri\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"redirectURIEncoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// get default response_mode if not provided\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"JHt4cGF0aFJlc3BvbnNlTW9kZS5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"response_mode\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt4cGF0aENsaWVudEtleUN1c3RvbS5yZXN1bHR9\"/>\n                                    <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"client_key_custom_json\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:EvaluateJsonPathExpressionV2>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// request_uris\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Expression stringValue=\"openid_registration.response.require_pushed_authorization_requests\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_key_custom_json\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"require_pushed_authorization_requests\"/>\n                                    </L7p:EvaluateJsonPathExpressionV2>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1aXJlX3B1c2hlZF9hdXRob3JpemF0aW9uX3JlcXVlc3RzLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// extract require_pushed_authorization_requests from client key custom\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${require_pushed_authorization_requests}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error.code 391\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"391\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    </wsp:OneOrMore>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Validate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// non PAR request\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${isParRequest}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"355ca731-f92a-4d64-b41a-8533eedfa651\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Profile Configuration\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"848e037e-6e66-4af3-994a-0a39b9b830d6\"/>\n                                    <L7p:PolicyName stringValue=\"OTK PAR Request Validation\"/>\n                                </L7p:Include>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// PAR request\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code is provide by validation assertion, API-ID 3000\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"${error.code}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvci5tc2d9\"/>\n                                    <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"jsonMsg\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"error\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"error\"/>\n                                    </L7p:EvaluateJsonPathExpression>\n                                    <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"error_description\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"error_description\"/>\n                                    </L7p:EvaluateJsonPathExpression>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvci5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"error\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9kZXNjcmlwdGlvbi5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"error_description\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"xpathClientKeyCustom\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:values/ns:keys/ns:values/ns:value/ns:client_key_custom\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-clientstore\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${xpathClientKeyCustom.result}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"e30=\"/>\n                                    <L7p:VariableToSet stringValue=\"xpathClientKeyCustom.result\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${error_redirect_uri}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"error\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"error_type_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"error_description\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"error_description_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcn0=\"/>\n                                    <L7p:VariableToSet stringValue=\"error_type\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZXJyb3I9JHtlcnJvcl90eXBlX2VuY29kZWR9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb25fZW5jb2RlZH0meC1jYS1lcnI9JHtlcnJvci5jb2RlfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"error\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ImVycm9yIjogIiR7ZXJyb3JfdHlwZX0iLA0KImVycm9yX2Rlc2NyaXB0aW9uIjogIiR7ZXJyb3JfZGVzY3JpcHRpb259IiwNCiJ4LWNhLWVyciI6ICIke2Vycm9yLmNvZGV9Ig==\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtError\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${state}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"EMPTY\"/>\n\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcn0mc3RhdGU9JHtzdGF0ZUVuY29kZWR9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"error\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RFcnJvcn0sDQoic3RhdGUiOiAiJHtzdGF0ZX0i\"/>\n\n                                    <L7p:VariableToSet stringValue=\"jwtError\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"state\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"add state if available\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"fragment\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"fragment\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${error_redirect_uri}\"/>\n\n                                    <L7p:Expression2 stringValue=\"#\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9JiR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9IyR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"response_mode=fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"query\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"query\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${error_redirect_uri}\"/>\n\n                                    <L7p:Expression2 stringValue=\"?\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9JiR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9PyR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"response_mode=query\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"form_post\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2Vycm9yX3JlZGlyZWN0X3VyaX0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iZXJyb3IiIHZhbHVlPSIke2Vycm9yX3R5cGV9Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJlcnJvcl9kZXNjcmlwdGlvbiIgdmFsdWU9IiR7ZXJyb3JfZGVzY3JpcHRpb259Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ4LWNhLWVyciIgdmFsdWU9IiR7ZXJyb3IuY29kZX0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n\n                                    <L7p:VariableToSet stringValue=\"response\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:HardcodedResponse>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64ResponseBody stringValue=\"JHtyZXNwb25zZX0=\"/>\n\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n\n                                    <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                    </L7p:HardcodedResponse>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"response_mode=form_post\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"fragment.jwt\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"fragment.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n\n                                    <L7p:value stringValue=\"${xpathClientKeyCustom.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"cmVzcG9uc2U9JHthdXRoel9yZXNwb25zZV9qd3R9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"error\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${error_redirect_uri}\"/>\n\n                                    <L7p:Expression2 stringValue=\"#\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9JiR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9IyR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"response_mode=fragment.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"query.jwt\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"query.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n\n                                    <L7p:value stringValue=\"${xpathClientKeyCustom.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"cmVzcG9uc2U9JHthdXRoel9yZXNwb25zZV9qd3R9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"error\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${error_redirect_uri}\"/>\n\n                                    <L7p:Expression2 stringValue=\"?\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9JiR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9yZWRpcmVjdF91cml9PyR7ZXJyb3J9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"response_mode=query.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Expression2 stringValue=\"form_post.jwt\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"form_post.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n\n                                    <L7p:value stringValue=\"${xpathClientKeyCustom.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2Vycm9yX3JlZGlyZWN0X3VyaX0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0icmVzcG9uc2UiIHZhbHVlPSIke2F1dGh6X3Jlc3BvbnNlX2p3dH0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n\n                                    <L7p:VariableToSet stringValue=\"response\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:HardcodedResponse>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64ResponseBody stringValue=\"JHtyZXNwb25zZX0=\"/>\n\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n\n                                    <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                    </L7p:HardcodedResponse>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"response_mode=form_post.jwt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"location\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"create the location header\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"overwrite\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no message body should be created\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"overwrite\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no body but set the content-type header to a value\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"dGV4dC9wbGFpbjtjaGFyc2V0PVVURi04\"/>\n                                    <L7p:VariableToSet stringValue=\"content-type\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"overwrite\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"set to 302 for the redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"MzAy\"/>\n                                    <L7p:VariableToSet stringValue=\"status\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Location\"/>\n                                    <L7p:HeaderValue stringValue=\"${location}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"redirect\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"error.code\"/>\n                                    <L7p:Regex stringValue=\"114$\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"redirect_uri\"/>\n\n                                    <L7p:Regex stringValue=\"(%3c|[&lt;])(\\w|%(?!20))\"/>\n\n                                    <L7p:Replacement stringValue=\"\"/>\n\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"Don't put the redirection url in the response body because it may lead to a XSS security leak. Just return the error description.\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9kZXNjcmlwdGlvbn0u\"/>\n\n                                    <L7p:VariableToSet stringValue=\"error_description\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8ec0504a-67af-4087-99a9-e23a92986695\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Escape HTML\"/>\n\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"input\"/>\n\n                                    <L7p:value stringValue=\"${redirect_uri}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"Display the redirection URL if there is no XSS risk.\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9kZXNjcmlwdGlvbn0uIEdpdmVuOiAnJHtlc2NhcGVkX291dHB1dH0n\"/>\n\n                                    <L7p:VariableToSet stringValue=\"error_description\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"add\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"invalid redirect_uri\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"in this case add it to the error description\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ew0KICJlcnJvciI6IiR7ZXJyb3J9IiwNCiAiZXJyb3JfZGVzY3JpcHRpb24iOiIke2Vycm9yX2Rlc2NyaXB0aW9ufSINCn0=\"/>\n                                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"html\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Response\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Either HTML or a redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:FalseAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error and description\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                        </wsp:OneOrMore>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:UUIDGenerator>\n                                <L7p:MaximumQuantity intValue=\"2\"/>\n                                <L7p:Quantity stringValue=\"2\"/>\n                                <L7p:TargetVariable stringValue=\"sessionID\"/>\n                            </L7p:UUIDGenerator>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"[mag]\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"May be overwritten if 'MSSO Device User Lookup' is enabled\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"YWxs\"/>\n                                <L7p:VariableToSet stringValue=\"device-user-domain\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"[mag]\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"May be overwritten if 'MSSO Device User Lookup' is enabled\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"device-user\"/>\n                            </L7p:SetVariable>\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9bdebba2-bcf6-4945-b1c4-a4fde7cf335d\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"MSSO Device User Lookup\"/>\n                                <L7p:NoOpIfConfigMissing booleanValue=\"true\"/>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:DataType variableDataType=\"dateTime\"/>\n                                <L7p:DateOffsetExpression stringValue=\"${sessionIdCacheAge}\"/>\n                                <L7p:VariableToSet stringValue=\"exp\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHt4cGF0aENsaWVudEtleUN1c3RvbS5yZXN1bHR9\"/>\n                                <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                                <L7p:DataType variableDataType=\"message\"/>\n                                <L7p:VariableToSet stringValue=\"client_key_custom_json\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:EvaluateJsonPathExpressionV2>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// request_uris\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Expression stringValue=\"openid_registration.response.logo_uri\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_key_custom_json\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"request_logo_uri\"/>\n                                    </L7p:EvaluateJsonPathExpressionV2>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X2xvZ29fdXJpLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// extract logo_uri from client key custom\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"ew0KICAgICJzZXNzaW9uIjogew0KICAgICAgICAic2Vzc2lvbklEIjoiJHtzZXNzaW9uSURbMF19IiwNCiAgICAgICAgImV4cCI6JHtleHAuc2Vjb25kc30sDQogICAgICAgICJjdXJyZW50X3VzZXJuYW1lIjoiIiwNCiAgICAgICAgImN1cnJlbnRfdXNlcl9jb25zZW50Ijoibm9uZSIsDQogICAgICAgICJjdXJyZW50X3VzZXJfcm9sZSI6IiIsDQogICAgICAgICJjdXJyZW50X3VzZXJfYWNyIjoiMCIsDQogICAgICAgICJjdXJyZW50X3VzZXJfYXV0aFRpbWUiOiIwIiwNCiAgICAgICAgInNhbHQiOiIiLA0KICAgICAgICAidGhpcmRfcGFydHlfc3NvX3Rva2VuIjoiIiwNCiAgICAgICAgInRoaXJkX3BhcnR5X3Nzb190b2tlbl90eXBlIjoiIg0KICAgIH0sDQogICAgInJlcXVlc3RfY29uc2VudCI6IHsNCiAgICAgICAgImNsaWVudF9uYW1lIjoiJHt4cGF0aE5hbWVFbmNvZGVkfSIsDQogICAgICAgICJzY29wZV92ZXJpZmllZCI6IiR7eHBhdGhTY29wZUVuY29kZWR9IiwNCiAgICAgICAgInJlc291cmNlX3ZlcmlmaWVkIjoiJHt4cGF0aFJlc291cmNlRW5jb2RlZH0iDQogICAgfSwNCiAgICAicmVxdWVzdF9wYXJhbWV0ZXJzIjogew0KICAgICAgICAiZGlzcGxheSI6IiR7ZGlzcGxheUVuY29kZWR9IiwNCiAgICAgICAgInByb21wdCI6IiR7cHJvbXB0RW5jb2RlZH0iLA0KICAgICAgICAiaWRfdG9rZW5faGludCI6IiR7aWRfdG9rZW5faGludEVuY29kZWR9IiwNCiAgICAgICAgImxvZ2luX2hpbnQiOiIke2xvZ2luX2hpbnRFbmNvZGVkfSIsDQogICAgICAgICJhY3JfdmFsdWVzIjoiJHthY3JfdmFsdWVzRW5jb2RlZH0iLA0KICAgICAgICAiYWNyX3ZhbHVlc19lc3NlbnRpYWwiOiIke2Fjcl92YWx1ZXNfZXNzZW50aWFsRW5jb2RlZH0iLA0KICAgICAgICAiY2xpZW50X2lkIjoiJHtjbGllbnRfaWRFbmNvZGVkfSIsDQogICAgICAgICJub25jZSI6IiR7bm9uY2VFbmNvZGVkfSIsDQogICAgICAgICJzY29wZSI6IiR7c2NvcGVPcmlnaW5hbEVuY29kZWR9IiwNCiAgICAgICAgInJlc291cmNlIjoiJHtyZXNvdXJjZU9yaWdpbmFsRW5jb2RlZH0iLA0KICAgICAgICAibWF4X2FnZSI6ICIke21heEFnZX0iLA0KICAgICAgICAibG9nb191cmkiOiIke2xvZ29fdXJpfSINCiAgICB9DQp9\"/>\n                                <L7p:VariableToSet stringValue=\"session\"/>\n                            </L7p:SetVariable>\n                            <L7p:EncodeJsonWebToken>\n                                <L7p:SignPayload booleanValue=\"true\"/>\n                                <L7p:SignatureAlgorithm stringValue=\"HS256\"/>\n                                <L7p:SignatureSecretKey stringValue=\"${otk_session_secret}\"/>\n                                <L7p:SourceVariable stringValue=\"${session}\"/>\n                                <L7p:TargetVariable stringValue=\"jwt_session\"/>\n                            </L7p:EncodeJsonWebToken>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO extension included\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"PGF1dGhvcml6ZT4NCiAgICA8Y2xpZW50TmFtZT4ke3hwYXRoTmFtZUVuY29kZWR9PC9jbGllbnROYW1lPg0KICAgIDxjbGllbnRfaWQ+JHtjbGllbnRfaWRFbmNvZGVkfTwvY2xpZW50X2lkPg0KICAgIDxnaXZlbl9yZWRpcmVjdF91cmk+JHtyZWRpcmVjdFVSSUVuY29kZWR9PC9naXZlbl9yZWRpcmVjdF91cmk+DQogICAgPHJlZGlyZWN0X3VyaT4ke3hwYXRoUmVkaXJlY3RVUklFbmNvZGVkfTwvcmVkaXJlY3RfdXJpPg0KICAgIDxyZXNwb25zZV90eXBlPiR7eHBhdGhSZXNwb25zZVR5cGVFbmNvZGVkfTwvcmVzcG9uc2VfdHlwZT4NCiAgICA8cmVzcG9uc2VfbW9kZT4ke3hwYXRoUmVzcG9uc2VNb2RlRW5jb2RlZH08L3Jlc3BvbnNlX21vZGU+DQogICAgPGNsaWVudF90eXBlPiR7eHBhdGhDbGllbnRUeXBlRW5jb2RlZH08L2NsaWVudF90eXBlPg0KICAgIDxjbGllbnRfY3VzdG9tPiR7eHBhdGhDbGllbnRDdXN0b21FbmNvZGVkfTwvY2xpZW50X2N1c3RvbT4gICAgDQogICAgPGNsaWVudF9rZXlfY3VzdG9tPiR7eHBhdGhDbGllbnRLZXlDdXN0b21FbmNvZGVkfTwvY2xpZW50X2tleV9jdXN0b20+DQogICAgPGNsaWVudF9pZGVudD4ke2NsaWVudElkZW50RW5jb2RlZH08L2NsaWVudF9pZGVudD4NCiAgICA8c2NvcGU+JHt4cGF0aFNjb3BlRW5jb2RlZH08L3Njb3BlPg0KICAgIDxyZXNvdXJjZT4ke3hwYXRoUmVzb3VyY2VFbmNvZGVkfTwvcmVzb3VyY2U+DQogICAgPHN0YXRlPiR7c3RhdGVFbmNvZGVkfTwvc3RhdGU+DQogICAgPHNlc3Npb24+JHtzZXNzaW9uSURbMV19PC9zZXNzaW9uPg0KICAgIDxvaWRjTm9uY2U+JHtub25jZUVuY29kZWR9PC9vaWRjTm9uY2U+DQogICAgPHNlc3Npb25EYXRhPiR7and0X3Nlc3Npb24uY29tcGFjdH08L3Nlc3Npb25EYXRhPg0KICAgIDxtYXhBZ2U+JHttYXhBZ2V9PC9tYXhBZ2U+DQogICAgPCEtLSBQS0NFIC0tPg0KICAgIDxjb2RlQ2hhbGxlbmdlPiR7Y29kZUNoYWxsZW5nZUVuY29kZWR9PC9jb2RlQ2hhbGxlbmdlPg0KICAgIDxjb2RlQ2hhbGxlbmdlTWV0aG9kPiR7Y29kZUNoYWxsZW5nZU1ldGhvZH08L2NvZGVDaGFsbGVuZ2VNZXRob2Q+DQogICAgPCEtLSBFeHRlbnNpb24gZm9yIE1vYmlsZSBTU08gLS0+DQogICAgPGV4cGVjdGVkX21hZ19pZGVudGlmaWVyPiR7bWFnLWlkZW50aWZpZXJ9PC9leHBlY3RlZF9tYWdfaWRlbnRpZmllcj4NCiAgICA8ZXhwZWN0ZWRfZGV2aWNlX3VzZXJfZG9tYWluPiR7ZGV2aWNlLXVzZXItZG9tYWlufTwvZXhwZWN0ZWRfZGV2aWNlX3VzZXJfZG9tYWluPg0KICAgIDxleHBlY3RlZF9kZXZpY2VfdXNlcj4ke2RldmljZS11c2VyfTwvZXhwZWN0ZWRfZGV2aWNlX3VzZXI+DQo8L2F1dGhvcml6ZT4=\"/>\n                                <L7p:VariableToSet stringValue=\"sessionValue\"/>\n                            </L7p:SetVariable>\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"dd360775-0fec-47db-8b45-059d995b262d\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Store\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID[0]}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxEntries\"/>\n                                    <L7p:value stringValue=\"10000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxSize\"/>\n                                    <L7p:value stringValue=\"10000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"dbAge\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value stringValue=\"${sessionValue}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:HardcodedResponse>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                                <L7p:ResponseStatus stringValue=\"302\"/>\n                            </L7p:HardcodedResponse>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"Pragma\"/>\n                                <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                <L7p:HeaderValue stringValue=\"no-store\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                    <L7p:Regex stringValue=\"\\bnone\\b\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"\\blogin\\b\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b79ebaf7-acff-4eac-8d48-61b90bf597cb\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Cookie Management\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookie\"/>\n                                    <L7p:value stringValue=\"${request.http.cookies}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookieName\"/>\n                                    <L7p:value stringValue=\"sessionCookie\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookieValue\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"lifetime\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${id_token_hint}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// either valid cookie or id_token_hint provided\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"bG9naW4=\"/>\n                                    <L7p:VariableToSet stringValue=\"goToLoginWithAction\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"login\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"ZGlzcGxheQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"goToLoginWithAction\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"prompt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"redirect to /login with action=login (prompt=none, id_token_hint not empty) or with action=display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"Pw==\"/>\n                                <L7p:VariableToSet stringValue=\"connector\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${location_login_server}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"Jg==\"/>\n                                    <L7p:VariableToSet stringValue=\"connector\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// check for existing query component\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"Location\"/>\n                                <L7p:HeaderValue stringValue=\"${location_login_server}${connector}action=${goToLoginWithAction}&amp;sessionID=${sessionID[0]}&amp;sessionData=${jwt_session.compact}\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:CommentAssertion>\n                                <L7p:Comment stringValue=\"============================================\"/>\n                            </L7p:CommentAssertion>\n                            <L7p:CommentAssertion>\n                                <L7p:Comment stringValue=\"Override the below config &amp; remove setting this within #OTK Third Party Configuration to support specific redirect uri for OIDC TP login\"/>\n                            </L7p:CommentAssertion>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Optional\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Ensure, the redirection from the third party OIDC happens to the OTK authorization login endpoint\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"aHR0cHM6Ly8ke2dhdGV3YXkuY2x1c3Rlci5ob3N0bmFtZX06JHtnYXRld2F5Lm90ay5wb3J0fS9hdXRoL29hdXRoL3YyL2F1dGhvcml6ZS9sb2dpbj9hY3Rpb249bG9naW4=\"/>\n                                <L7p:Enabled booleanValue=\"false\"/>\n                                <L7p:VariableToSet stringValue=\"third_party_oidc.redirect_uri\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Optional\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValueReference=\"inline\"><![CDATA[Override this here & remove setting this within #OTK Third Party Configuration to support specific redirect uri for OIDC TP login\nRetrieve third party OIDC client_id (either hard code the value here, or use OTK client custom column)]]></L7p:value>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"VEhJUkRfUEFSVFlfT0lEQ19DTElFTlRfSUQ=\"/>\n                                <L7p:Enabled booleanValue=\"false\"/>\n                                <L7p:VariableToSet stringValue=\"third_party_oidc.client_id\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Optional\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Retrieve third party OIDC client_secret (DO NOT hard-code the value here, try retrieving it from secure passwords, i.e., ${secpass.third_party_oidc_client_secret.plaintext})\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"VEhJUkRfUEFSVFlfQ0xJRU5UX1NFQ1JFVA==\"/>\n                                <L7p:Enabled booleanValue=\"false\"/>\n                                <L7p:VariableToSet stringValue=\"third_party_oidc.client_secret\"/>\n                            </L7p:SetVariable>\n                            <L7p:CommentAssertion>\n                                <L7p:Comment stringValue=\"============================================\"/>\n                            </L7p:CommentAssertion>\n                            <L7p:Include>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//Adding '#OTK Third Party Authentication' block to redirect authentication (changing the Location Header)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:PolicyGuid stringValue=\"ca804e07-62fd-491d-8a21-90e0fd6699ea\"/>\n                                <L7p:PolicyName stringValue=\"#OTK Third Party Authentication\"/>\n                            </L7p:Include>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"initial request\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Initial call of the client\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${error.code}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Something went totally wrong!\"/>\n                            </L7p:AuditDetailAssertion>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3000\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"000\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"unknown\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"something unknown happened\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Unknown action\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Tasks\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"Request\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${isPreflight}\"/>\n                    <L7p:MultivaluedComparison multivaluedComparison=\"FIRST\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"204\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:ResponseContentType stringValue=\"text/plain;charset=UTF-8\"/>\n                    <L7p:ResponseStatus stringValue=\"204\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Replace\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Override header to reflect actual allowed methods\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:HeaderName stringValue=\"Access-Control-Allow-Methods\"/>\n                    <L7p:HeaderValue stringValue=\"POST, GET\"/>\n                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"IsPreflight\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"PreFlight\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Check for CORS-Pre-Flight\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>"
  }
}