{
  "goid": "83fd2534ef7918b71010530c536b7b5b",
  "guid": "d1aaa10e-566a-4097-8dee-340f89a96afa",
  "name": "openid-client-register",
  "resolutionPath": "/openid/connect/register",
  "serviceType": "WEB_API",
  "checksum": "2f21ce5d223ecef8acce547016d70a080b0bbdb3",
  "enabled": true,
  "folderPath": "/OTK/Server/DMZ/OAuth 2.0/AuthorizationServer",
  "methodsAllowed": [
    "GET",
    "POST",
    "PUT",
    "PATCH",
    "DELETE",
    "HEAD",
    "OPTIONS",
    "OTHER"
  ],
  "tracingEnabled": false,
  "wssProcessingEnabled": false,
  "laxResolution": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"This API accepts dynamic oauth client registrations as defined in the context of OpenID Connect Dynamic Registration\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== *** THIS POLICY IS OVERWRITTEN DURING AN UPGRADE ***\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== Be aware that custom configuration made in this policy is overwritten during a solution kit upgrade.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== However, the older version of the policy is kept in the history and can be referenced.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== After upgrade, manually merge customizations from the old version of the policy to the new version.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${gateway.otk.enable_auditing}\"/>\n                <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:AuditAssertion/>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Audit the service policy execution\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:CustomizeErrorResponse>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// configure error response\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Content stringValue=\"${error.msg}\"/>\n            <L7p:ContentType stringValue=\"${content-type}\"/>\n            <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Pragma\"/>\n                    <L7p:Value stringValue=\"no-cache\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Cache-Control\"/>\n                    <L7p:Value stringValue=\"no-store\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"x-ca-err\"/>\n                    <L7p:Value stringValue=\"3009${error.code}\"/>\n                </L7p:item>\n            </L7p:ExtraHeaders>\n            <L7p:HttpStatus stringValue=\"${status}\"/>\n        </L7p:CustomizeErrorResponse>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6\"/>\n            <L7p:PolicyName stringValue=\"OTK Security Header Extension\"/>\n        </L7p:Include>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Require SSL, with client certificate\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"47f768f4-b478-472b-a1ee-10f4b6e76f99\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Require SSL (with Client Certificate)\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"custom\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireClientCert\"/>\n                        <L7p:value stringValue=\"true\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Require SSL, no client certificate\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"47f768f4-b478-472b-a1ee-10f4b6e76f99\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Require SSL (with Client Certificate)\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireClientCert\"/>\n                        <L7p:value stringValue=\"false\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"SSL, mTLS optional\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:RateLimit>\n                <L7p:CounterName stringValue=\"1bdc7ef5-${request.url.path}\"/>\n                <L7p:MaxRequestsPerSecond stringValue=\"100\"/>\n                <L7p:SplitRateLimitAcrossNodes booleanValue=\"false\"/>\n            </L7p:RateLimit>\n            <wsp:OneOrMore wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"111\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"apiPrefix\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"givenErrorCode\"/>\n                            <L7p:value stringValue=\"111\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"== OVERRIDE\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// This is here in case the gateway has both MAG and OTK installed, because MAG also has error code 111 and that results in different error.msg\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgc2VydmljZSBpcyB0ZW1wb3JhcmlseSBub3QgYXZhaWxhYmxlIg0KfQ==\"/>\n                        <L7p:VariableToSet stringValue=\"error.msg\"/>\n                    </L7p:SetVariable>\n                    <L7p:FalseAssertion/>\n                </wsp:All>\n            </wsp:OneOrMore>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"rate limit\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Encapsulated>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// POST|OPTIONS\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b8822449-71ff-455b-8f10-39122e6c549b\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK HTTP Method Validation\"/>\n            <L7p:Parameters mapValue=\"included\">\n                <L7p:entry>\n                    <L7p:key stringValue=\"method\"/>\n                    <L7p:value stringValue=\"POST|OPTIONS\"/>\n                </L7p:entry>\n            </L7p:Parameters>\n        </L7p:Encapsulated>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// optional\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"bac17a37-0b06-47fd-910c-4faced9489c3\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK CORS\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"custom\"/>\n                        <L7p:value stringValue=\"{&quot;url_path_query&quot;:&quot;${request.url.path}${request.url.query}&quot;, &quot;http_method_allowed&quot;: &quot;${http_method_allowed}&quot;}\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireCORS\"/>\n                        <L7p:value stringValue=\"optional\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// error code produced in previous assertion\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"givenErrorCode\"/>\n                        <L7p:value stringValue=\"${error.code}\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"CORS\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Check for CORS\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"355ca731-f92a-4d64-b41a-8533eedfa651\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Profile Configuration\"/>\n        </L7p:Encapsulated>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${isPreflight}\"/>\n                    <L7p:MultivaluedComparison multivaluedComparison=\"FIRST\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${host_oauth2_auth_server}, ${oidc_register_path}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"2e6e2ef3-a36f-4548-a2c4-7b369b7ae184\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Variable Configuration\"/>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"e30=\"/>\n                    <L7p:VariableToSet stringValue=\"ssa_payload\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${request.http.header.content-type}\"/>\n                        <L7p:Expression2 stringValue=\"application/jwt\"/>\n                        <L7p:Operator operator=\"CONTAINS\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"CONTAINS\"/>\n                                <L7p:RightValue stringValue=\"application/jwt\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${enforce_dcr_software_statement}\"/>\n                        <L7p:Expression2 stringValue=\"false\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"false\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"apiPrefix\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"givenErrorCode\"/>\n                                <L7p:value stringValue=\"315\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// enforce software_statement?\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${request.http.header.content-type}\"/>\n                            <L7p:Expression2 stringValue=\"application/jwt\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"CONTAINS\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"application/jwt\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lm1haW5wYXJ0fQ==\"/>\n                            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"client_request\"/>\n                        </L7p:SetVariable>\n                    </wsp:All>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"22c1f832-d5d7-47c0-8b9b-a58c261a3164\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK DCR - Process Request JWT\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"enforce_ssa\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ensure initializing the client_request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"resource\"/>\n                </L7p:SetVariable>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Generate a client_ident (and client_id)\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6dbc70f9-bb40-4a69-a0ec-88fae4f35300\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate OAuth Token\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ac\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"art\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"at\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cid\"/>\n                            <L7p:value stringValue=\"true\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cidm\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"custom\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ock\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ot\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"rft\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"urt\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtnZW5FeHBpcmF0aW9ufQ==\"/>\n                    <L7p:VariableToSet stringValue=\"client_expiration\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtnZW5Ub2tlbn0=\"/>\n                    <L7p:VariableToSet stringValue=\"client_ident\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:JSONSchema>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Validation\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Check if the session_output is JSON\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:ResourceInfo staticResourceInfo=\"included\">\n                                <L7p:Document stringValueReference=\"inline\"><![CDATA[{\n                \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n                \"title\": \"Client Registration Message Validation\",\n                \"description\": \"Verify that input is a JSON message\",\n                \"type\": \"object\"\n                }]]></L7p:Document>\n                            </L7p:ResourceInfo>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:JSONSchema>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                            <L7p:Regex stringValue=\"[&lt;>]|\\\\&quot;\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Incoming message contains characters that we do not accept:  &lt;,>,&amp; and \\&quot;  are not allowed.\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"133\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"133\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// validate that incoming message is JSON\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"Y29uZmlkZW50aWFs\"/>\n                        <L7p:VariableToSet stringValue=\"client_type\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"application_type\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"application_type\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthcHBsaWNhdGlvbl90eXBlLnJlc3VsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"application_type\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"application_type\"/>\n                                <L7p:Regex stringValue=\"web|native\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Using default application_type 'web' since none or an invalid one was provided\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"d2Vi\"/>\n                                <L7p:VariableToSet stringValue=\"application_type\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"grant_type=authorization_code\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// application_type MAY be provided, default: web\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${application_type}\"/>\n                            <L7p:Expression2 stringValue=\"web\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"web\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"cHVibGlj\"/>\n                            <L7p:VariableToSet stringValue=\"client_type\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// figure out the client_type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// application_type, mapping to client_type\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${gateway.otk.fapi.dcr_override}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpressionV2>\n                                    <L7p:Expression stringValue=\"fapi_profile\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"fapi_profile_request\"/>\n                                </L7p:EvaluateJsonPathExpressionV2>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtmYXBpX3Byb2ZpbGVfcmVxdWVzdC5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"fapi_profile\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given fapi_profile\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"fapi_profile\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// client provides fapi_profile in registration request\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${fapi_profile}\"/>\n                                <L7p:Expression2 stringValue=\"none\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${fapi_profile}\"/>\n                                    <L7p:Expression2 stringValue=\"none\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"oauth2_profile.fapi_baseline\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"oauth2_profile.fapi_advanced\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${fapi_profile}\"/>\n                                    <L7p:Expression2 stringValue=\"baseline\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"baseline\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"oauth2_profile.fapi_baseline\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"oauth2_profile.fapi_advanced\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${fapi_profile}\"/>\n                                    <L7p:Expression2 stringValue=\"advanced\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"advanced\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"oauth2_profile.fapi_baseline\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"oauth2_profile.fapi_advanced\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:AuditDetailAssertion>\n                                    <L7p:Detail stringValue=\"Invalid fapi_profile : '${fapi_profile}'\"/>\n                                </L7p:AuditDetailAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Invalid\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"423\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//validate fapi_profile and set oauth2.profile\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// override dcr\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${gateway.otk.fapi.dcr_override}\"/>\n                            <L7p:Expression2 stringValue=\"false\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_advanced}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"YWR2YW5jZWQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"fapi_profile\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_baseline}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"YmFzZWxpbmU=\"/>\n                                    <L7p:VariableToSet stringValue=\"fapi_profile\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"fapi_profile\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// consider global fapi settings\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// fapi settings\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fapi_profile}\"/>\n                            <L7p:Expression2 stringValue=\"none\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"fapi_profile_setting\"/>\n                        </L7p:SetVariable>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"ImZhcGlfcHJvZmlsZSI6IiR7ZmFwaV9wcm9maWxlfSIs\"/>\n                        <L7p:VariableToSet stringValue=\"fapi_profile_setting\"/>\n                    </L7p:SetVariable>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_advanced}\"/>\n                        <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                        <L7p:Operator operatorNull=\"null\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item dataType=\"included\">\n                                <L7p:Type variableDataType=\"string\"/>\n                            </L7p:item>\n                            <L7p:item binary=\"included\">\n                                <L7p:RightValue stringValue=\"false\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${client_type}\"/>\n                        <L7p:Expression2 stringValue=\"public\"/>\n                        <L7p:Operator operator=\"NE\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"NE\"/>\n                                <L7p:RightValue stringValue=\"public\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"apiPrefix\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"givenErrorCode\"/>\n                                <L7p:value stringValue=\"313\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FAPI advanced does not support public clients\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"backchannel_token_delivery_mode\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"backchannel_token_delivery_mode\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:TrueAssertion/>\n                        </wsp:OneOrMore>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${backchannel_token_delivery_mode.count}\"/>\n                            <L7p:Expression2 stringValue=\"0\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"backchannel_token_delivery_mode\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtiYWNrY2hhbm5lbF90b2tlbl9kZWxpdmVyeV9tb2RlLnJlc3VsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"backchannel_token_delivery_mode\"/>\n                            </L7p:SetVariable>\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${backchannel_token_delivery_mode}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//ignore empty value\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9811427e-a0e4-4065-a89c-aa6e80606bf4\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid backchannel_token_delivery_modes_supported\"/>\n                            </L7p:Encapsulated>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"backchannel_token_delivery_modes_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"backchannel_token_delivery_modes_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"backchannel_token_delivery_modes_supported\"/>\n                                <L7p:OutputVariable stringValue=\"backchannel_token_delivery_modes_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${backchannel_token_delivery_modes_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${backchannel_token_delivery_mode}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${backchannel_token_delivery_mode}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid backchannel_token_delivery_mode were provided: '${backchannel_token_delivery_mode}\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"355\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid backchannel_token_delivery_mode\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"355\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"backchannel_token_delivery_mode\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ignore redirect_uri for ciba\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Expression1 stringValue=\"${backchannel_token_delivery_mode}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Negate booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:Negated booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"redirect_uris\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"redirect_uris_processed\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// redirect_uri(s) MUST exist\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Expression stringValue=\"redirect_uris\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"redirect_uris\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"redirect_uris.results\" variablePrefix=\"uri\">\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ignore redirect_uri for ciba\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Expression1 stringValue=\"${uri.current}\"/>\n                                    <L7p:Expression2 stringValue=\"&amp;amp;\"/>\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"&amp;amp;\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:FindAll booleanValue=\"true\"/>\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"&amp;amp;\"/>\n                                    <L7p:Replace booleanValue=\"true\"/>\n                                    <L7p:Replacement stringValue=\"&amp;\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:Regex>\n                            </wsp:OneOrMore>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ignore redirect_uri for ciba\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Expression1 stringValue=\"${redirect_uris_processed}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^\\s+\"/>\n                                    <L7p:Replace booleanValue=\"true\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt1cmkuY3VycmVudH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"redirect_uris_processed\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^\\s+\"/>\n                                    <L7p:Replace booleanValue=\"true\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZWRpcmVjdF91cmlzX3Byb2Nlc3NlZH0sJHt1cmkuY3VycmVudH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"redirect_uris_processed\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// removing &amp;amp; escaping if present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtyZWRpcmVjdF91cmlzX3Byb2Nlc3NlZH0=\"/>\n                            <L7p:VariableToSet stringValue=\"redirect_uris.results\"/>\n                        </L7p:SetVariable>\n                        <L7p:Split>\n                            <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                            <L7p:InputVariable stringValue=\"redirect_uris_processed\"/>\n                            <L7p:OutputVariable stringValue=\"redirect_uris.results\"/>\n                        </L7p:Split>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiR7cmVkaXJlY3RfdXJpcy5yZXN1bHRzfSI=\"/>\n                            <L7p:VariableToSet stringValue=\"redirect_uris\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// surround each comma with double quotes (&quot;)\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"redirect_uris\"/>\n                            <L7p:Regex stringValue=\",\\s{0,10}\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&quot;,&quot;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"redirect_uris.results\" variablePrefix=\"uri\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${uri.current}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${client_type}\"/>\n                                    <L7p:Expression2 stringValue=\"confidential\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"confidential\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// only https scheme accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^https://.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// localhost NOT accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"^.*://localhost.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// web (confidential)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${client_type}\"/>\n                                    <L7p:Expression2 stringValue=\"public\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"public\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${allow_port_agnostic_redirect_uris}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"^((https|http)://(localhost|127[.]0[.]0[.]1|[\\[]::1[\\]])):[\\*].*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//Port agnostic redirect uri\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_baseline}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// https scheme only allowed with hostname localhost\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^https:\\/\\/localhost.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_baseline}\"/>\n                                    <L7p:Expression2 stringValue=\"false\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// http scheme only allowed with hostname localhost\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^http:\\/\\/localhost.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// only custom scheme accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"^(http|https)://.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    </wsp:OneOrMore>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// handling differently for FAPI public clients\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// native (public)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// web (confidential) or native (public)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                            </L7p:ForEachLoop>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// accept only https, do not accept localhost or fragments, generally for all application types\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"No or invalid redirect_uri(s) were provided: '${redirect_uris}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid or missing redirect_uri(s)\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// redirect_uri(s)\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"post_logout_redirect_uris\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// post_logout_redirect_uris(s) exist?\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Expression stringValue=\"post_logout_redirect_uris\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"post_logout_redirect_uris\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// surround the comma separated list with double quotes\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"IiR7cG9zdF9sb2dvdXRfcmVkaXJlY3RfdXJpcy5yZXN1bHRzfSI=\"/>\n                                    <L7p:VariableToSet stringValue=\"post_logout_redirect_uris\"/>\n                                </L7p:SetVariable>\n                                <L7p:Regex>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// surround each comma with double quotes (&quot;)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"post_logout_redirect_uris\"/>\n                                    <L7p:Regex stringValue=\",\\s{0,10}\"/>\n                                    <L7p:Replace booleanValue=\"true\"/>\n                                    <L7p:Replacement stringValue=\"&quot;,&quot;\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:Regex>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"post_logout_redirect_uris.results\" variablePrefix=\"uri\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${uri.current}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${client_type}\"/>\n                                    <L7p:Expression2 stringValue=\"confidential\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"confidential\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// only https scheme accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^https://.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// localhost NOT accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"^.*://localhost.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// web (confidential)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${client_type}\"/>\n                                    <L7p:Expression2 stringValue=\"public\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"public\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// https scheme only allowed with hostname localhost\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^https:\\/\\/localhost.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// http scheme only allowed with hostname localhost\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n                                    <L7p:Regex stringValue=\"^http:\\/\\/localhost.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// only custom scheme accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"uri.current\"/>\n\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"^(http|https)://.*\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// native (public)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// web (confidential) or native (public)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                </wsp:All>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${post_logout_redirect_uris.found}\"/>\n                                    <L7p:Expression2 stringValue=\"false\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:AuditDetailAssertion>\n                                    <L7p:Detail stringValue=\"post_logout_redirect_uris not set.\"/>\n                                </L7p:AuditDetailAssertion>\n                            </wsp:All>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// accept only https, do not accept localhost or fragments, generally for all application types\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid post_logout_redirect_uris(s) were provided: '${post_logout_redirect_uris}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"393\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid post_logout_redirect_uris\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"393\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//validate post_logout_redirect_uri(s) \"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// initialize\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"sector_identifier_uri\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"sector_identifier_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"sector_identifier_uri\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${sector_identifier_uri.found}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:ContentType stringValue=\"text/plain; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"emptyMsg\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZWN0b3JfaWRlbnRpZmllcl91cmkucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"sector_identifier_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"verify https\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sector_identifier_uri\"/>\n                            <L7p:Regex stringValue=\"^https\"/>\n                            <L7p:RegexName stringValue=\"sector_identifier_uri\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:HttpRoutingAssertion>\n                            <L7p:CurrentSecurityHeaderHandling intValue=\"3\"/>\n                            <L7p:HttpMethod httpMethod=\"GET\"/>\n                            <L7p:ProtectedServiceUrl stringValue=\"${sector_identifier_uri}\"/>\n                            <L7p:ProxyPassword stringValueNull=\"null\"/>\n                            <L7p:ProxyUsername stringValueNull=\"null\"/>\n                            <L7p:RequestHeaderRules httpPassthroughRuleSet=\"included\">\n                                <L7p:ForwardAll booleanValue=\"true\"/>\n                                <L7p:Rules httpPassthroughRules=\"included\">\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"Cookie\"/>\n                                    </L7p:item>\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"SOAPAction\"/>\n                                    </L7p:item>\n                                </L7p:Rules>\n                            </L7p:RequestHeaderRules>\n                            <L7p:RequestMsgSrc stringValue=\"emptyMsg\"/>\n                            <L7p:RequestParamRules httpPassthroughRuleSet=\"included\">\n                                <L7p:ForwardAll booleanValue=\"true\"/>\n                                <L7p:Rules httpPassthroughRules=\"included\"/>\n                            </L7p:RequestParamRules>\n                            <L7p:ResponseHeaderRules httpPassthroughRuleSet=\"included\">\n                                <L7p:ForwardAll booleanValue=\"true\"/>\n                                <L7p:Rules httpPassthroughRules=\"included\">\n                                    <L7p:item httpPassthroughRule=\"included\">\n                                    <L7p:Name stringValue=\"Set-Cookie\"/>\n                                    </L7p:item>\n                                </L7p:Rules>\n                            </L7p:ResponseHeaderRules>\n                            <L7p:ResponseMsgDest stringValue=\"resp\"/>\n                            <L7p:SamlAssertionVersion intValue=\"2\"/>\n                        </L7p:HttpRoutingAssertion>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// needs to point to a URL and must be customizable\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtyZXNwLm1haW5wYXJ0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"sector_identifier_uri_response\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZWRpcmVjdF91cmlzLnJlc3VsdHN9\"/>\n                            <L7p:VariableToSet stringValue=\"redirect_uris_check\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"verify JSON array\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Regex stringValue=\"\\[.*\\]\"/>\n                            <L7p:RegexName stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"remove square brace and quotes\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Regex stringValue=\"\\[|&quot;|\\]\"/>\n                            <L7p:RegexName stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"remove double quotes and any whitespace characters\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Regex stringValue=\"[&quot;\\s]*\"/>\n                            <L7p:RegexName stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"replace , with space\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Regex stringValue=\",\"/>\n                            <L7p:RegexName stringValue=\"sector_identifier_uri_response\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\" \"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"remove double quotes and any whitespace characters\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"redirect_uris_check\"/>\n                            <L7p:Regex stringValue=\"[&quot;\\s]*\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"replace , with space\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"redirect_uris_check\"/>\n                            <L7p:Regex stringValue=\",\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\" \"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Misuse this assertion to compare space separated lists of values\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f78f0f85-00e2-49b1-95e4-e520df255c9c\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK SCOPE Verification\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"any\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"fail\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope.granted\"/>\n                                    <L7p:value stringValue=\"${sector_identifier_uri_response}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope.required\"/>\n                                    <L7p:value stringValue=\"${redirect_uris_check}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// valid\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:ComparisonAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// not given\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${sector_identifier_uri}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid sector_identifier_uri(s) or invalid redirect_uri(s): '${sector_identifier_uri}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Invalid\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Check if sector_identifier_uri contains all redirect_uris\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"client_name\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"client_name\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtjbGllbnRfbmFtZS5yZXN1bHR9\"/>\n                            <L7p:VariableToSet stringValue=\"client_name\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"client_name_default\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"redirect_uris\"/>\n                            <L7p:Regex stringValue=\"^&quot;([^&quot;]+)&quot;\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use the first _redirect_uri. Its the best we have to make the registration unique\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtjbGllbnRfbmFtZV9kZWZhdWx0WzFdfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"client_name\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// extract the first redirect_uri used as default values for 'client_name', 'organization'\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use client_ident\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjbGllbnRfaWRlbnR9\"/>\n                        <L7p:VariableToSet stringValue=\"client_name\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// a client_name MAY be given\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"organization_default\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"redirect_uris\"/>\n                            <L7p:Regex stringValue=\"^&quot;([^&quot;]+)&quot;\"/>\n                            <L7p:Replacement stringValue=\"found: $1\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use the first _redirect_uri. Its the best we have to make the registration unique\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtvcmdhbml6YXRpb25fZGVmYXVsdFsxXX0=\"/>\n                            <L7p:VariableToSet stringValue=\"defaultNameOrganization\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// extract the first redirect_uri used as default values for 'client_name', 'organization'\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use client_name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjbGllbnRfbmFtZX0=\"/>\n                        <L7p:VariableToSet stringValue=\"defaultNameOrganization\"/>\n                    </L7p:SetVariable>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"response_types\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"response_types\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXNwb25zZV90eXBlcy5yZXN1bHRzfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"response_types\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiR7cmVzcG9uc2VfdHlwZXN9Ig==\"/>\n                            <L7p:VariableToSet stringValue=\"response_types\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"response_types\"/>\n                            <L7p:Regex stringValue=\",[ ]*\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&quot;,&quot;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"ab11a00c-3860-45ea-8d73-1aead7d46914\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid response_types_supported\"/>\n                        </L7p:Encapsulated>\n                        <L7p:CustomAssertion>\n                            <L7p:base64SerializedValue>rO0ABXNyADFjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uQ3VzdG9tQXNzZXJ0aW9uSG9sZGVyZtcreFwddTICAAlaAAxpc1VpQXV0b09wZW5MAApjYXRlZ29yaWVzdAAPTGphdmEvdXRpbC9TZXQ7TAAIY2F0ZWdvcnl0ACpMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DYXRlZ29yeTtMAA9jdXN0b21Bc3NlcnRpb250ADFMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DdXN0b21Bc3NlcnRpb247TAAUY3VzdG9tTW9kdWxlRmlsZU5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMAA9kZXNjcmlwdGlvblRleHRxAH4ABEwAD3BhbGV0dGVOb2RlTmFtZXEAfgAETAAOcG9saWN5Tm9kZU5hbWVxAH4ABEwAHnJlZ2lzdGVyZWRDdXN0b21GZWF0dXJlU2V0TmFtZXEAfgAEeHIAJWNvbS5sN3RlY2gucG9saWN5LmFzc2VydGlvbi5Bc3NlcnRpb27bX2OZPL2isQIAAloAB2VuYWJsZWRMABBhc3NlcnRpb25Db21tZW50dAAvTGNvbS9sN3RlY2gvcG9saWN5L2Fzc2VydGlvbi9Bc3NlcnRpb24kQ29tbWVudDt4cAFwAXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyAChjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uZXh0LkNhdGVnb3J5WrCcZaFE/jUCAAJJAAVteUtleUwABm15TmFtZXEAfgAEeHAAAAAHdAAfTWVzc2FnZVZhbGlkYXRpb25UcmFuc2Zvcm1hdGlvbnhwc3IAUGNvbS5sN3RlY2guY3VzdG9tLmNoZWNrcmVzcG9uc2V0eXBlc3VwcG9ydGVkLkNoZWNrUmVzcG9uc2VUeXBlU3VwcG9ydGVkQXNzZXJ0aW9uKyTM/B4g200CAAJMAA1yZXNwb25zZV90eXBlcQB+AARMABhyZXNwb25zZV90eXBlc19zdXBwb3J0ZWRxAH4ABHhwdAARJHtyZXNwb25zZV90eXBlc310ABske3Jlc3BvbnNlX3R5cGVzX3N1cHBvcnRlZH10ADQxYzMzM2RiMTdiMDI1Njg3YjNhYTFiZTQxNGY1MjY1NDFiOWUzYmI5Y2M4ZTgxYzYuamFydAAlQ2hlY2sgaWYgYSByZXNwb25zZV90eXBlIGlzIHN1cHBvcnRlZHBwcA==</L7p:base64SerializedValue>\n                        </L7p:CustomAssertion>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Using default response_type 'code' since none were provided\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ImNvZGUi\"/>\n                            <L7p:VariableToSet stringValue=\"response_types\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ImNvZGUi\"/>\n                            <L7p:VariableToSet stringValue=\"response_types.results\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"bm9uZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"response_types_original\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"MQ==\"/>\n                            <L7p:DataType variableDataType=\"int\"/>\n                            <L7p:VariableToSet stringValue=\"response_types.count\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_type=code\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// response_type(s) MAY be provided, default: code\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"grant_types\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"grant_types\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtncmFudF90eXBlcy5yZXN1bHRzfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"grant_types\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"grant_types\"/>\n                            <L7p:Regex stringValue=\",\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9d148b22-73da-425b-b28a-a58a84c2f851\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid grant_types_supported\"/>\n                        </L7p:Encapsulated>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"grant_types_supported\"/>\n                            <L7p:Regex stringValue=\"[&quot;,\\s]+\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\" \"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:CustomAssertion>\n                            <L7p:base64SerializedValue>rO0ABXNyADFjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uQ3VzdG9tQXNzZXJ0aW9uSG9sZGVyZtcreFwddTICAAlaAAxpc1VpQXV0b09wZW5MAApjYXRlZ29yaWVzdAAPTGphdmEvdXRpbC9TZXQ7TAAIY2F0ZWdvcnl0ACpMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DYXRlZ29yeTtMAA9jdXN0b21Bc3NlcnRpb250ADFMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DdXN0b21Bc3NlcnRpb247TAAUY3VzdG9tTW9kdWxlRmlsZU5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMAA9kZXNjcmlwdGlvblRleHRxAH4ABEwAD3BhbGV0dGVOb2RlTmFtZXEAfgAETAAOcG9saWN5Tm9kZU5hbWVxAH4ABEwAHnJlZ2lzdGVyZWRDdXN0b21GZWF0dXJlU2V0TmFtZXEAfgAEeHIAJWNvbS5sN3RlY2gucG9saWN5LmFzc2VydGlvbi5Bc3NlcnRpb27bX2OZPL2isQIAAloAB2VuYWJsZWRMABBhc3NlcnRpb25Db21tZW50dAAvTGNvbS9sN3RlY2gvcG9saWN5L2Fzc2VydGlvbi9Bc3NlcnRpb24kQ29tbWVudDt4cAFzcgAtY29tLmw3dGVjaC5wb2xpY3kuYXNzZXJ0aW9uLkFzc2VydGlvbiRDb21tZW50wRemdwvAdqYCAAFMAApwcm9wZXJ0aWVzdAAPTGphdmEvdXRpbC9NYXA7eHBzcgARamF2YS51dGlsLlRyZWVNYXAMwfY+LSVq5gMAAUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHBwdwQAAAABdAANUklHSFQuQ09NTUVOVHQAOy8vIG1pc3VzaW5nIHRoaXMgYXNzZXJ0aW9uIHNpbmNlIGl0IGRvZXMgd2hhdCB3ZSBuZWVkIHRvIGRveAFzcgARamF2YS51dGlsLkhhc2hTZXS6RIWVlri3NAMAAHhwdwwAAAACP0AAAAAAAAFzcgAoY29tLmw3dGVjaC5wb2xpY3kuYXNzZXJ0aW9uLmV4dC5DYXRlZ29yeVqwnGWhRP41AgACSQAFbXlLZXlMAAZteU5hbWVxAH4ABHhwAAAAC3QAEEN1c3RvbUFzc2VydGlvbnN4cHNyADBjb20ubDd0ZWNoLmN1c3RvbS5hdXRoMnNjb3BlLlNjb3BlSXNzdWVBc3NlcnRpb24tYbsJUPQ+sAIAA0wAEXJlc291cmNlUmVxdWVzdGVkcQB+AARMAA9zY29wZVJlZ2lzdGVyZWRxAH4ABEwADnNjb3BlUmVxdWVzdGVkcQB+AAR4cHQACyR7cmVzb3VyY2V9dAAYJHtncmFudF90eXBlc19zdXBwb3J0ZWR9dAAOJHtncmFudF90eXBlc310ADRlZjJhMzJkZjU4ZWRlNDVkMjQyYzlmYzkzNDA2YjdiZjA2MDc0NWNjYWQyZWJlNWYuamFydACvVmFsaWRhdGVzIHRoZSByZXF1ZXN0ZWQgU0NPUEUgYWdhaW5zdCBTQ09QRSdzIHRoYXQgd2VyZSByZWdpc3RlcmVkIGZvciB0aGUgY2xpZW50LiBJdCBvbmx5IGlzc3VlcyBTQ09QRSdzIHRoYXQgYXJlIGEgc3Vic2V0IG9mIHRoZSByZWdpc3RlcmVkIG9uZXMuIEl0IHdpbGwgZmFpbCBpZiBub25lIG1hdGNoLnQAEU9USyBTQ09QRSBJc3N1aW5ndAART1RLIFNDT1BFIElzc3Vpbmdw</L7p:base64SerializedValue>\n                        </L7p:CustomAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// no valid values were given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${scope.granted}\"/>\n                            <L7p:Expression2 stringValue=\"oob\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"oob\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiR7c2NvcGUuZ3JhbnRlZH0i\"/>\n                            <L7p:VariableToSet stringValue=\"grant_types\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"grant_types\"/>\n                            <L7p:Regex stringValue=\"\\s\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&quot;,&quot;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Using default grant_type 'authorization_code' since none or invalid ones were provided\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ImF1dGhvcml6YXRpb25fY29kZSI=\"/>\n                            <L7p:VariableToSet stringValue=\"grant_types\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"bm9uZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"grant_types_original\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"MQ==\"/>\n                            <L7p:DataType variableDataType=\"int\"/>\n                            <L7p:VariableToSet stringValue=\"grant_types.count\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"grant_type=authorization_code\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// grant_type(s) MAY be provided, default: authorization_code\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Include>\n                    <L7p:PolicyGuid stringValue=\"b3b3e7e7-7f1e-43f2-8e10-c65d6b4d3c0a\"/>\n                    <L7p:PolicyName stringValue=\"#OTK Validate Response Types And Grant Types\"/>\n                </L7p:Include>\n                <wsp:All wsp:Usage=\"Required\">\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"contacts\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"contacts\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtjb250YWN0cy5yZXN1bHRzfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"contacts\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${contacts}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"IiR7Y29udGFjdHN9Ig==\"/>\n                                    <L7p:VariableToSet stringValue=\"contacts\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// prepare 'contacts' to include quotes\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"contacts\"/>\n                                <L7p:Regex stringValue=\",\\s{0,10}\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"&quot;,&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// none\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"InVua25vd24i\"/>\n                            <L7p:VariableToSet stringValue=\"contacts\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// contact(s) MAY be provided\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// used further down when persisting data\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjb250YWN0c30=\"/>\n                        <L7p:VariableToSet stringValue=\"registered_by\"/>\n                    </L7p:SetVariable>\n                    <L7p:Regex>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// remove quotes for this variable\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:AutoTarget booleanValue=\"false\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"registered_by\"/>\n                        <L7p:Regex stringValue=\"&quot;\"/>\n                        <L7p:Replace booleanValue=\"true\"/>\n                        <L7p:Replacement stringValue=\"\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:Regex>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// contact, and setting a 'registered_by' value\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"logo_uri\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"logo_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"logo_uri_request\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtsb2dvX3VyaV9yZXF1ZXN0LnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given logo_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide logo_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides log_uri in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${logo_uri}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"logo_uri_scheme_host\"/>\n                            <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"logo_uri\"/>\n                            <L7p:Regex stringValue=\"([a-z][a-z0-9+\\-.]*://(\\[[a-f0-9:.]+\\]|[a-z0-9\\-._~%]+))\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtsb2dvX3VyaV9zY2hlbWVfaG9zdFswXX0=\"/>\n                            <L7p:VariableToSet stringValue=\"logo_uri_host_scheme\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"isValid\"/>\n                        </L7p:SetVariable>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"redirect_uris.results\" variablePrefix=\"l_uri\">\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${l_uri.current}\"/>\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"${logo_uri_host_scheme}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"isValid\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"l_uri.break\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                                <L7p:TrueAssertion/>\n                            </wsp:OneOrMore>\n                        </L7p:ForEachLoop>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${isValid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid logo_uri(s) or invalid redirect_uri(s): '${logo_uri}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Invalid\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//validate logo uri\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"client_uri\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"client_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"client_uri_request\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtjbGllbnRfdXJpX3JlcXVlc3QucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"client_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given client_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide client_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"client_uri\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides client_uri in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${client_uri}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"clien_uri_scheme_host\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_uri\"/>\n                            <L7p:Regex stringValue=\"[a-z][a-z0-9+\\-.]*://(\\[[a-f0-9:.]+\\]|[a-z0-9\\-._~%]+)\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"isValid\"/>\n                        </L7p:SetVariable>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"redirect_uris.results\" variablePrefix=\"c_uri\">\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${c_uri.current}\"/>\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"${clien_uri_scheme_host[0]}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"isValid\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"c_uri.break\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                                <L7p:TrueAssertion/>\n                            </wsp:OneOrMore>\n                        </L7p:ForEachLoop>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${isValid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid client_uri(s) or invalid redirect_uri(s): '${client_uri}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Invalid\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//validate client uri\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"policy_uri\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"policy_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"policy_uri_request\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtwb2xpY3lfdXJpX3JlcXVlc3QucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"policy_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// givenpolicy_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide client_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"policy_uri\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides policy_uri in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${policy_uri}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"policy_uri_scheme_host\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy_uri\"/>\n                            <L7p:Regex stringValue=\"[a-z][a-z0-9+\\-.]*://(\\[[a-f0-9:.]+\\]|[a-z0-9\\-._~%]+)\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtwb2xpY3lfdXJpX3NjaGVtZV9ob3N0WzBdfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"policy_uri_host_scheme\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"isValid\"/>\n                        </L7p:SetVariable>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"redirect_uris.results\" variablePrefix=\"p_uri\">\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${p_uri.current}\"/>\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"${policy_uri_host_scheme}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"isValid\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"p_uri.break\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                                <L7p:TrueAssertion/>\n                            </wsp:OneOrMore>\n                        </L7p:ForEachLoop>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${isValid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid policy_uri(s) or invalid redirect_uri(s): '${policy_uri}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Invalid\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//validate policy uri\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"tos_uri\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"tos_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"tos_uri_request\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHt0b3NfdXJpX3JlcXVlc3QucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"tos_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given tos_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide tos_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"tos_uri\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides tos_uri in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${tos_uri}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:CaptureVar stringValue=\"tos_uri_scheme_host\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"tos_uri\"/>\n                            <L7p:Regex stringValue=\"[a-z][a-z0-9+\\-.]*://(\\[[a-f0-9:.]+\\]|[a-z0-9\\-._~%]+)\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHt0b3NfdXJpX3NjaGVtZV9ob3N0WzBdfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"tos_uri_host_scheme\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"isValid\"/>\n                        </L7p:SetVariable>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"redirect_uris.results\" variablePrefix=\"t_uri\">\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${t_uri.current}\"/>\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"${tos_uri_host_scheme}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"isValid\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"t_uri.break\"/>\n                                    </L7p:SetVariable>\n                                </wsp:All>\n                                <L7p:TrueAssertion/>\n                            </wsp:OneOrMore>\n                        </L7p:ForEachLoop>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${isValid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid tos_uri(s) or invalid redirect_uri(s): '${tos_uri}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Invalid\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"422\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//validate tos uri\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"read locale-specific values \"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Include>\n                        <L7p:PolicyGuid stringValue=\"53c32d6f-2a3e-473d-b06b-7a4880655931\"/>\n                        <L7p:PolicyName stringValue=\"#OTK DCR - Read Locale Fields\"/>\n                    </L7p:Include>\n                    <L7p:TrueAssertion/>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"software_id\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"software_id\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"software_id_request\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzb2Z0d2FyZV9pZF9yZXF1ZXN0LnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"software_id\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given software_id\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide software_id\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"software_id\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides software_id in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"software_version\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"software_version\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"software_version_request\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzb2Z0d2FyZV92ZXJzaW9uX3JlcXVlc3QucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"software_version\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given software_version\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide software_version\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"software_version\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides software_version in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// initlialize\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"jwksOrJwks_uri\"/>\n                </L7p:SetVariable>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"jwks - client side\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"jwks\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"jwks\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtqd2tzLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given jwks\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide jwks\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"jwks\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides jwks in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// if jwks is not given, no need to validate\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${jwks}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:JSONSchema>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Validation\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Check if the jwks is JSON object\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:OtherTargetMessageVariable stringValue=\"jwks\"/>\n                            <L7p:ResourceInfo staticResourceInfo=\"included\">\n                                <L7p:Document stringValueReference=\"inline\"><![CDATA[{\n                \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n                \"title\": \"Client Registration Message Validation\",\n                \"description\": \"Verify that input is a JSON message\",\n                \"type\": \"object\"\n                }]]></L7p:Document>\n                            </L7p:ResourceInfo>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:JSONSchema>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"jwks\"/>\n                            <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                            <L7p:Regex stringValue=\"[&lt;>]|\\\\&quot;\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// if jwks is given, check if it is a json object\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Incoming message contains characters that we do not accept:  &lt;,>,&amp; and \\&quot;  are not allowed.\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"133\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"133\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// validate that incoming jwks is JSON\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"jwks_uri - client side\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"jwks_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"jwks_uri\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtqd2tzX3VyaS5yZXN1bHR9\"/>\n                            <L7p:VariableToSet stringValue=\"jwks_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given jwks_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// default to empty if client does not provide jwks_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"jwks_uri\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// client provides jwks_uri in registration request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// not given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// not given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks_uri}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// neither jwks nor jwks will be used to replace the secret\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"jwksOrJwks_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiI=\"/>\n                            <L7p:VariableToSet stringValue=\"jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// both jwks and jwks_uri are empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// not given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks_uri}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtqd2tzfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"jwksOrJwks_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwks is given, but no jwks_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// not given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks_uri}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtqd2tzX3VyaX0=\"/>\n                            <L7p:VariableToSet stringValue=\"jwksOrJwks_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiI=\"/>\n                            <L7p:VariableToSet stringValue=\"jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwks_uri is given, but no jwks\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"if both jwks and jwks_uri are given, return an error\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwks given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwks_uri given\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwks_uri}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Error: Both jwks and jwksuri were provided.\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"305\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// The jwks_uri and jwks parameters MUST NOT be used together\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"305\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// determine if jwks or jwks_uri will be used\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"sector_identifier_uri\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"subject_type\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"subject_type\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzdWJqZWN0X3R5cGUucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"subject_type\"/>\n                        </L7p:SetVariable>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fb37dff0-c419-45e8-9b38-333bb4c0f46c\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid subject_types_supported\"/>\n                        </L7p:Encapsulated>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"subject_types_supported\"/>\n                            <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"subject_types_supported\"/>\n                            <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\",\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Split>\n                            <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                            <L7p:InputVariable stringValue=\"subject_types_supported\"/>\n                            <L7p:OutputVariable stringValue=\"subject_types_supported\"/>\n                            <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                        </L7p:Split>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${subject_types_supported}\"/>\n                            <L7p:Expression2 stringValue=\"${subject_type}\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${subject_type}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given subject_type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// needs to be configurable\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"cGFpcndpc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"subject_type\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// a subject_type MAY be given\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"id_token_signed_response_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9828964e-e756-4915-baaa-d7f6e527af50\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid id_token_signing_alg_values_supported\"/>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"id_token_signed_response_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"id_token_signed_response_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtpZF90b2tlbl9zaWduZWRfcmVzcG9uc2VfYWxnLnJlc3VsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"id_token_signed_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"id_token_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"id_token_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"id_token_signing_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"id_token_signing_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${id_token_signing_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${id_token_signed_response_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${id_token_signed_response_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${id_token_signed_response_alg}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"id_token_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"id_token_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"id_token_signing_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"id_token_signing_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtpZF90b2tlbl9zaWduaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkX2RlZmF1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"id_token_signed_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid algorithm for 'id_token_signed_response_alg': '${id_token_signed_response_alg}'\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"421\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//Invalid algo for id_token signed response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"421\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"id_token_signed_response_alg\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// given id_token_signed_response_alg\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"id_token_encrypted_response_alg\"/>\n                </L7p:CommentAssertion>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"id_token_encrypted_response_enc\"/>\n                </L7p:CommentAssertion>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"userinfo_signed_response_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df66f39d-5014-4797-b55c-faa85d38dcc5\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid userinfo_signing_alg_values_supported\"/>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"userinfo_signed_response_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"userinfo_signed_response_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHt1c2VyaW5mb19zaWduZWRfcmVzcG9uc2VfYWxnLnJlc3VsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"userinfo_signed_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"userinfo_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"userinfo_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"userinfo_signing_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"userinfo_signing_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${userinfo_signing_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${userinfo_signed_response_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${userinfo_signed_response_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${userinfo_signed_response_alg}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"userinfo_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"userinfo_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"userinfo_signing_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"userinfo_signing_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHt1c2VyaW5mb19zaWduaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkX2RlZmF1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"userinfo_signed_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid algorithm for 'userinfo_signed_response_alg': '${userinfo_signed_response_alg}'\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"109\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//Invalid algo for userinfo signed response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"109\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"userinfo_signed_response_alg\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"userinfo_encrypted_response_alg\"/>\n                </L7p:CommentAssertion>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"userinfo_encrypted_response_enc\"/>\n                </L7p:CommentAssertion>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"55fc4843-486e-438a-b496-442270747088\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid require_request_uri_registration\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"custom\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:Expression stringValue=\"request_uris\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_uris\"/>\n                        </L7p:EvaluateJsonPathExpressionV2>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// surround the comma separated list with double quotes\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"IiR7cmVxdWVzdF91cmlzLnJlc3VsdHN9Ig==\"/>\n                            <L7p:VariableToSet stringValue=\"request_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// surround each comma with double quotes (&quot;)\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"request_uri\"/>\n                            <L7p:Regex stringValue=\",\\s{0,10}\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&quot;,&quot;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\" loopVariable=\"request_uris.results\" variablePrefix=\"request_uris_array\">\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// only https scheme accepted\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:FindAll booleanValue=\"true\"/>\n                                <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_uris_array.current\"/>\n                                <L7p:Regex stringValue=\"^https://.*\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                        </L7p:ForEachLoop>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${request_uris.found}\"/>\n                            <L7p:Expression2 stringValue=\"false\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${require_request_uri_registration}\"/>\n                            <L7p:Expression2 stringValue=\"false\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Invalid request_uri(s) were provided: '${request_uris}\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"162\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid request_uri(s)\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"162\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"request_uris\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"request_object_signing_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b9639b7a-f263-416b-ad2a-2822d7dda8a9\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid request_object_signing_alg_values_supported\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_object_signing_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_object_signing_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X29iamVjdF9zaWduaW5nX2FsZy5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"request_object_signing_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"request_object_signing_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"request_object_signing_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${request_object_signing_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${request_object_signing_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${request_object_signing_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${request_object_signing_alg}\"/>\n                                <L7p:Expression2 stringValue=\"0\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"request_object_signing_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"request_object_signing_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X29iamVjdF9zaWduaW5nX2FsZ192YWx1ZXNfc3VwcG9ydGVkX2RlZmF1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"request_object_signing_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid request_object_signing_alg were provided: '${request_object_signing_alg}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"163\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid request_object_signing_alg\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"163\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"request_object_signing_alg\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"require_pushed_authorization_requests\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"require_pushed_authorization_requests\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:TrueAssertion/>\n                        </wsp:OneOrMore>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${require_pushed_authorization_requests.count}\"/>\n                            <L7p:Expression2 stringValue=\"0\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1aXJlX3B1c2hlZF9hdXRob3JpemF0aW9uX3JlcXVlc3RzLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${require_pushed_authorization_requests}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${require_pushed_authorization_requests}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                <L7p:VariableToSet stringValue=\"require_pushed_authorization_requests\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//ignore empty value\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"require_pushed_authorization_requests\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"backchannel_authentication_request_signing_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6e1129a8-f2b2-4ba0-9675-2e40f0c1e2b0\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid backchannel_authentication_request_signing_alg_values_supported\"/>\n                    </L7p:Encapsulated>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"backchannel_authentication_request_signing_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"backchannel_authentication_request_signing_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtiYWNrY2hhbm5lbF9hdXRoZW50aWNhdGlvbl9yZXF1ZXN0X3NpZ25pbmdfYWxnLnJlc3VsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"backchannel_authentication_request_signing_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${backchannel_authentication_request_signing_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${backchannel_authentication_request_signing_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${backchannel_authentication_request_signing_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${backchannel_authentication_request_signing_alg}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"backchannel_authentication_request_signing_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtiYWNrY2hhbm5lbF9hdXRoZW50aWNhdGlvbl9yZXF1ZXN0X3NpZ25pbmdfYWxnX3ZhbHVlc19zdXBwb3J0ZWRfZGVmYXVsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"backchannel_authentication_request_signing_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid backchannel_authentication_request_signing_alg were provided: '${backchannel_authentication_request_signing_alg}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"354\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid backchannel_authentication_request_signing_alg\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"354\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"backchannel_authentication_request_signing_alg\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"request_object_encryption_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"38ac00db-06c4-48ed-81a1-4a83c66d0e58\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid request_object_encryption_alg_values_supported\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_object_encryption_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_object_encryption_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X29iamVjdF9lbmNyeXB0aW9uX2FsZy5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"request_object_encryption_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"request_object_encryption_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"request_object_encryption_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${request_object_encryption_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${request_object_encryption_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${request_object_encryption_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${request_object_encryption_alg}\"/>\n                                <L7p:Expression2 stringValue=\"0\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"request_object_encryption_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"request_object_encryption_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X29iamVjdF9lbmNyeXB0aW9uX2FsZ192YWx1ZXNfc3VwcG9ydGVkX2RlZmF1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"request_object_encryption_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid request_object_encryption_alg were provided: '${request_object_encryption_alg}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"164\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid request_object_encryption_alg\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"164\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"request_object_encryption_alg\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"request_object_encryption_enc\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"ad5ec415-bf1c-4c23-a1e7-3a350eefd31e\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid request_object_encryption_enc_values_supported\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_object_encryption_enc\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_object_encryption_enc\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X29iamVjdF9lbmNyeXB0aW9uX2VuYy5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"request_object_encryption_enc\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_enc_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_enc_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"request_object_encryption_enc_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"request_object_encryption_enc_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${request_object_encryption_enc_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${request_object_encryption_enc}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${request_object_encryption_enc}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${request_object_encryption_enc}\"/>\n                                <L7p:Expression2 stringValue=\"${request_object_encryption_enc}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"${request_object_encryption_enc}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_enc_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"request_object_encryption_enc_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"request_object_encryption_enc_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"request_object_encryption_enc_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X29iamVjdF9lbmNyeXB0aW9uX2VuY192YWx1ZXNfc3VwcG9ydGVkX2RlZmF1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"request_object_encryption_enc\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid request_object_encryption_enc were provided: '${request_object_encryption_enc}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"165\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid request_object_encryption_enc\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"165\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"request_object_encryption_enc\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"token_endpoint_auth_method\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"token_endpoint_auth_method\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHt0b2tlbl9lbmRwb2ludF9hdXRoX21ldGhvZC5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"token_endpoint_auth_method\"/>\n                            </L7p:SetVariable>\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"889fb762-51e7-4244-81e4-8eab7393f7de\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid token_endpoint_auth_methods_supported\"/>\n                            </L7p:Encapsulated>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"token_endpoint_auth_methods_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"token_endpoint_auth_methods_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"token_endpoint_auth_methods_supported\"/>\n                                <L7p:OutputVariable stringValue=\"token_endpoint_auth_methods_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${token_endpoint_auth_methods_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${token_endpoint_auth_method}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"CONTAINS\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"${token_endpoint_auth_method}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given token_endpoint_auth_method\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${client_type}\"/>\n                                    <L7p:Expression2 stringValue=\"public\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"public\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"Y2xpZW50X3NlY3JldF9iYXNpYw==\"/>\n                                    <L7p:VariableToSet stringValue=\"token_endpoint_auth_method\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${oauth2_profile.fapi_baseline}\"/>\n                                    <L7p:Expression2 stringValue=\"false\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"Y2xpZW50X3NlY3JldF9iYXNpYw==\"/>\n                                    <L7p:VariableToSet stringValue=\"token_endpoint_auth_method\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:AuditDetailAssertion>\n                                    <L7p:Detail stringValue=\"Incompatable token endpoint auth method - 'token_endpoint_auth_method'\"/>\n                                </L7p:AuditDetailAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"174\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"174\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error if fapi enabled\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// set token_endpoint_auth_method\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${token_endpoint_auth_method}\"/>\n                                <L7p:Operator operatorNull=\"null\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"private_key_jwt\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"NE\"/>\n                                    <L7p:RightValue stringValue=\"self_signed_tls_client_auth\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwksOrJwks_uri}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"jwks/jwk_uri should not be empty when using &quot;private_key_jwt&quot; or &quot;self_signed_tls_client_auth&quot; auth method.\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"424\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"424\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"fail\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"validate\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// check jwks/jwks_uri is not empty if method is &quot;private_key_jwt&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// a token_endpoint_auth_method MAY be given. No support: none\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"Validate jwks or pki for mTLS authentication\"/>\n                </L7p:CommentAssertion>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4c6dab79-310f-48bb-9ec1-3f0e511c5093\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Client Validate Metadata\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"client_metadata\"/>\n                            <L7p:value stringValue=\"client_request\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"end of mTLS authentication metadata validation\"/>\n                </L7p:CommentAssertion>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"token_endpoint_auth_signing_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c949b706-a4d1-4a92-9e5d-75e6dc5c6258\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid token_endpoint_auth_signing_alg_values_supported\"/>\n                    </L7p:Encapsulated>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"token_endpoint_auth_signing_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"token_endpoint_auth_signing_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHt0b2tlbl9lbmRwb2ludF9hdXRoX3NpZ25pbmdfYWxnLnJlc3VsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"token_endpoint_auth_signing_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${token_endpoint_auth_signing_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${token_endpoint_auth_signing_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${token_endpoint_auth_signing_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${token_endpoint_auth_signing_alg}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"token_endpoint_auth_signing_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHt0b2tlbl9lbmRwb2ludF9hdXRoX3NpZ25pbmdfYWxnX3ZhbHVlc19zdXBwb3J0ZWRfZGVmYXVsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"token_endpoint_auth_signing_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid algorithm for 'token_endpoint_auth_signing_alg': '${token_endpoint_auth_signing_alg}'\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"420\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"//Invalid algo for token endpoint signed response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"420\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"token_endpoint_auth_signing_alg\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"default_max_age\"/>\n                </L7p:CommentAssertion>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"require_auth_time - will always be included\"/>\n                </L7p:CommentAssertion>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"default_acr_values\"/>\n                </L7p:CommentAssertion>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"initiate_login_uri\"/>\n                </L7p:CommentAssertion>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9c7c5e77-62e9-44f0-8c90-800dc7c26dec\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid scopes_supported\"/>\n                    </L7p:Encapsulated>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzY29wZXNfc3VwcG9ydGVkfQ==\"/>\n                        <L7p:VariableToSet stringValue=\"scope4database\"/>\n                    </L7p:SetVariable>\n                    <L7p:Regex>\n                        <L7p:AutoTarget booleanValue=\"false\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"scope4database\"/>\n                        <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                        <L7p:Replace booleanValue=\"true\"/>\n                        <L7p:Replacement stringValue=\"\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:Regex>\n                    <L7p:Regex>\n                        <L7p:AutoTarget booleanValue=\"false\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"scope4database\"/>\n                        <L7p:Regex stringValue=\"&quot;,\\s*&quot;\"/>\n                        <L7p:Replace booleanValue=\"true\"/>\n                        <L7p:Replacement stringValue=\" \"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:Regex>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// configured SCOPE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"scope\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"scope\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtzY29wZS5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"scope\"/>\n                            </L7p:SetVariable>\n                            <L7p:CustomAssertion>\n                                <L7p:base64SerializedValue>rO0ABXNyADFjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uQ3VzdG9tQXNzZXJ0aW9uSG9sZGVyZtcreFwddTICAAlaAAxpc1VpQXV0b09wZW5MAApjYXRlZ29yaWVzdAAPTGphdmEvdXRpbC9TZXQ7TAAIY2F0ZWdvcnl0ACpMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DYXRlZ29yeTtMAA9jdXN0b21Bc3NlcnRpb250ADFMY29tL2w3dGVjaC9wb2xpY3kvYXNzZXJ0aW9uL2V4dC9DdXN0b21Bc3NlcnRpb247TAAUY3VzdG9tTW9kdWxlRmlsZU5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMAA9kZXNjcmlwdGlvblRleHRxAH4ABEwAD3BhbGV0dGVOb2RlTmFtZXEAfgAETAAOcG9saWN5Tm9kZU5hbWVxAH4ABEwAHnJlZ2lzdGVyZWRDdXN0b21GZWF0dXJlU2V0TmFtZXEAfgAEeHIAJWNvbS5sN3RlY2gucG9saWN5LmFzc2VydGlvbi5Bc3NlcnRpb27bX2OZPL2isQIAAloAB2VuYWJsZWRMABBhc3NlcnRpb25Db21tZW50dAAvTGNvbS9sN3RlY2gvcG9saWN5L2Fzc2VydGlvbi9Bc3NlcnRpb24kQ29tbWVudDt4cAFwAXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyAChjb20ubDd0ZWNoLnBvbGljeS5hc3NlcnRpb24uZXh0LkNhdGVnb3J5WrCcZaFE/jUCAAJJAAVteUtleUwABm15TmFtZXEAfgAEeHAAAAALdAAQQ3VzdG9tQXNzZXJ0aW9uc3hwc3IAMGNvbS5sN3RlY2guY3VzdG9tLmF1dGgyc2NvcGUuU2NvcGVJc3N1ZUFzc2VydGlvbi1huwlQ9D6wAgADTAARcmVzb3VyY2VSZXF1ZXN0ZWRxAH4ABEwAD3Njb3BlUmVnaXN0ZXJlZHEAfgAETAAOc2NvcGVSZXF1ZXN0ZWRxAH4ABHhwdAALJHtyZXNvdXJjZX10ABEke3Njb3BlNGRhdGFiYXNlfXQACCR7c2NvcGV9dAA0ZWYyYTMyZGY1OGVkZTQ1ZDI0MmM5ZmM5MzQwNmI3YmYwNjA3NDVjY2FkMmViZTVmLmphcnQAr1ZhbGlkYXRlcyB0aGUgcmVxdWVzdGVkIFNDT1BFIGFnYWluc3QgU0NPUEUncyB0aGF0IHdlcmUgcmVnaXN0ZXJlZCBmb3IgdGhlIGNsaWVudC4gSXQgb25seSBpc3N1ZXMgU0NPUEUncyB0aGF0IGFyZSBhIHN1YnNldCBvZiB0aGUgcmVnaXN0ZXJlZCBvbmVzLiBJdCB3aWxsIGZhaWwgaWYgbm9uZSBtYXRjaC50ABFPVEsgU0NPUEUgSXNzdWluZ3QAEU9USyBTQ09QRSBJc3N1aW5ncA==</L7p:base64SerializedValue>\n                            </L7p:CustomAssertion>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// scope requested\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzY29wZTRkYXRhYmFzZX0=\"/>\n                            <L7p:VariableToSet stringValue=\"scope.granted\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// SCOPE\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"organization\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"organization\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtvcmdhbml6YXRpb24ucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"organization\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"organization\"/>\n                                <L7p:Regex stringValue=\".{0,128}\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given organization\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use the first _redirect_uri. Its the best we have to make the registration unique\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtkZWZhdWx0TmFtZU9yZ2FuaXphdGlvbn0=\"/>\n                            <L7p:VariableToSet stringValue=\"organization\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// organization\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"description\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"description\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtkZXNjcmlwdGlvbi5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"description\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"description\"/>\n                                <L7p:Regex stringValue=\".{0,255}\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given description\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// needs to be configurable\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"UmVnaXN0ZXJlZCB2aWEgT3BlbklEIENvbm5lY3QgRHluYW1pYyBSZWdpc3RyYXRpb24=\"/>\n                            <L7p:VariableToSet stringValue=\"description\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// description\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"environment\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"environment\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtlbnZpcm9ubWVudC5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"environment\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"environment\"/>\n                                <L7p:Regex stringValue=\".{0,128}\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given environment\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// needs to be configurable\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"QUxM\"/>\n                            <L7p:VariableToSet stringValue=\"environment\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// environment\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:EvaluateJsonPathExpression>\n                                <L7p:Expression stringValue=\"master\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"master\"/>\n                            </L7p:EvaluateJsonPathExpression>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHttYXN0ZXIucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"master\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"master\"/>\n                                <L7p:Regex stringValue=\"true|false\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// given master-key (boolean)\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"default\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// needs to be configurable\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"master\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// master-key\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// OTK specific values\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"authorization_signed_response_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"bd55a51e-d50a-488d-a2eb-ce7d7a4084f3\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid authorization_signing_alg_values_supported\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"authorization_signed_response_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"authorization_signed_response_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemF0aW9uX3NpZ25lZF9yZXNwb25zZV9hbGcucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_signed_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_signing_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"authorization_signing_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"authorization_signing_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${authorization_signing_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${authorization_signed_response_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${authorization_signed_response_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${authorization_signed_response_alg}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_signing_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"authorization_signing_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"authorization_signing_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemF0aW9uX3NpZ25pbmdfYWxnX3ZhbHVlc19zdXBwb3J0ZWRfZGVmYXVsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_signed_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid authorization signed response algorithm provided: '${authorization_signed_response_alg}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"166\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid authorization_signed_response_alg\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"166\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"authorization_signed_response_alg\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//Authorization Signed Reponse Algorithm\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"authorization_encrypted_response_alg\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"authorization_encrypted_response_alg_org\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b947cc3f-786e-4972-8344-af233f4f94a4\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK openid authorization_encryption_alg_and_enc_values_supported\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom_data\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"authorization_encrypted_response_alg\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"authorization_encrypted_response_alg\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                                <L7p:Expression2 stringValue=\"true\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"Tk9ORQ==\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_encrypted_response_alg_org\"/>\n                            </L7p:SetVariable>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9hbGcucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_encrypted_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_alg_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"authorization_encryption_alg_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"authorization_encryption_alg_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${authorization_encryption_alg_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${authorization_encrypted_response_alg}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${authorization_encrypted_response_alg}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${authorization_encrypted_response_alg}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_alg_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"authorization_encryption_alg_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"authorization_encryption_alg_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemF0aW9uX2VuY3J5cHRpb25fYWxnX3ZhbHVlc19zdXBwb3J0ZWRfZGVmYXVsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_encrypted_response_alg\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid authorization encryted response algorithm provided: '${authorization_encrypted_response_alg}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"167\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid authorization_encrypted_response_alg\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"167\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"authorization_encrypted_response_alg\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//Authorization Encrypted Reponse Algorithm\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"authorization_response_params\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"authorization_encrypted_response_enc\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"authorization_encrypted_response_enc_org\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"authorization_encrypted_response_enc\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"authorization_encrypted_response_enc\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// initialize\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"fieldNotfound\"/>\n                        </L7p:SetVariable>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${fieldNotfound}\"/>\n                                <L7p:Expression2 stringValue=\"true\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"ImF1dGhvcml6YXRpb25fZW5jcnlwdGVkX3Jlc3BvbnNlX2FsZyIgOiAiIiwNCiJhdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9lbmMiIDogIiIs\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_response_params\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"Tk9ORQ==\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_encrypted_response_enc_org\"/>\n                            </L7p:SetVariable>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9lbmMucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_encrypted_response_enc\"/>\n                            </L7p:SetVariable>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_enc_values_supported\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_enc_values_supported\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"authorization_encryption_enc_values_supported\"/>\n                                <L7p:OutputVariable stringValue=\"authorization_encryption_enc_values_supported\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${authorization_encryption_enc_values_supported}\"/>\n                                <L7p:Expression2 stringValue=\"${authorization_encrypted_response_enc}\"/>\n                                <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"${authorization_encrypted_response_enc}\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"ImF1dGhvcml6YXRpb25fZW5jcnlwdGVkX3Jlc3BvbnNlX2FsZyIgOiAiJHthdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9hbGd9IiwNCiJhdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9lbmMiIDogIiR7YXV0aG9yaXphdGlvbl9lbmNyeXB0ZWRfcmVzcG9uc2VfZW5jfSIs\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_response_params\"/>\n                            </L7p:SetVariable>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${authorization_encrypted_response_enc}\"/>\n                                <L7p:Operator operatorNull=\"null\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_enc_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"^&quot;|&quot;$\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"authorization_encryption_enc_values_supported_default\"/>\n                                <L7p:Regex stringValue=\"&quot;,\\s+&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\",\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Split>\n                                <L7p:IgnoreEmptyValues booleanValue=\"true\"/>\n                                <L7p:InputVariable stringValue=\"authorization_encryption_enc_values_supported_default\"/>\n                                <L7p:OutputVariable stringValue=\"authorization_encryption_enc_values_supported_default\"/>\n                                <L7p:SplitPatternRegEx booleanValue=\"false\"/>\n                            </L7p:Split>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemF0aW9uX2VuY3J5cHRpb25fZW5jX3ZhbHVlc19zdXBwb3J0ZWRfZGVmYXVsdH0=\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_encrypted_response_enc\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"ImF1dGhvcml6YXRpb25fZW5jcnlwdGVkX3Jlc3BvbnNlX2FsZyIgOiAiJHthdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9hbGd9IiwNCiJhdXRob3JpemF0aW9uX2VuY3J5cHRlZF9yZXNwb25zZV9lbmMiIDogIiR7YXV0aG9yaXphdGlvbl9lbmNyeXB0ZWRfcmVzcG9uc2VfZW5jfSIs\"/>\n                                <L7p:VariableToSet stringValue=\"authorization_response_params\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"Invalid authorization signed response algorithm were provided: '${authorization_encrypted_response_enc}\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"168\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// invalid authorization_encrypted_response_enc\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"168\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"authorization_encrypted_response_enc\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//Encrytion algorithm encrypting authorization responses.\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_alg_org}\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_enc_org}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_alg_org}\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"NONE\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_enc_org}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"NONE\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_alg}\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_enc_org}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"NONE\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Default enc\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_alg_org}\"/>\n                            <L7p:Expression2 stringValue=\"NONE\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"NONE\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorization_encrypted_response_enc}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"169\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// authorization_encrypted_response_alg can not be blank\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"169\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"missing authorization_encrypted_response_alg\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// handle cases where either authorization_encrypted_response_alg or authorization_encrypted_response_enc is empty \"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtob3N0X29hdXRoMl9hdXRoX3NlcnZlcn0ke29pZGNfcmVnaXN0ZXJfcGF0aH0vJHtjbGllbnRfaWRlbnR9\"/>\n                    <L7p:VariableToSet stringValue=\"client_config_endpoint\"/>\n                </L7p:SetVariable>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// generate access_token\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6dbc70f9-bb40-4a69-a0ec-88fae4f35300\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate OAuth Token\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ac\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"art\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"at\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cid\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cidm\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"csec\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"curid\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"custom\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"dac\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ock\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ot\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"pru\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"reg_token\"/>\n                            <L7p:value stringValue=\"true\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"req_expiry\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"rft\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"urt\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtnZW5Ub2tlbn0=\"/>\n                    <L7p:VariableToSet stringValue=\"access_token\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtnZW5FeHBpcmF0aW9ufQ==\"/>\n                    <L7p:VariableToSet stringValue=\"access_token_expiration\"/>\n                </L7p:SetVariable>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// generate client_secret\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6dbc70f9-bb40-4a69-a0ec-88fae4f35300\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate OAuth Token\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ac\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"art\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"at\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cid\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cidm\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"csec\"/>\n                            <L7p:value stringValue=\"true\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"curid\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"custom\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"dac\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ock\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"ot\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"pru\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"req_expiry\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"rft\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"urt\"/>\n                            <L7p:value stringValue=\"false\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${token_endpoint_auth_method}\"/>\n                                <L7p:Expression2 stringValue=\"private_key_jwt\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"private_key_jwt\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${token_endpoint_auth_method}\"/>\n                                <L7p:Expression2 stringValue=\"self_signed_tls_client_auth\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"self_signed_tls_client_auth\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                        </wsp:OneOrMore>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${jwksOrJwks_uri}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtqd2tzT3JKd2tzX3VyaX0=\"/>\n                            <L7p:VariableToSet stringValue=\"secret_or_jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"genSecret\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"hashing_metadata\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use jws or jwks_uri as client's secret if either jwks or jws_uri is given during OIDC registration.\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${token_endpoint_auth_method}\"/>\n                            <L7p:Expression2 stringValue=\"tls_client_auth\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"tls_client_auth\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"tls_client_auth_subject_dn\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"subject_dn\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dGxzX2NsaWVudF9hdXRoX3N1YmplY3RfZG4=\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_key\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzdWJqZWN0X2RuLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_value\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// tls_client_auth_subject_dn\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"tls_client_auth_san_dns\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"san_dns\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dGxzX2NsaWVudF9hdXRoX3Nhbl9kbnM=\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_key\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzYW5fZG5zLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_value\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// tls_client_auth_san_dns\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"tls_client_auth_san_uri\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"san_uri\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dGxzX2NsaWVudF9hdXRoX3Nhbl91cmk=\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_key\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzYW5fdXJpLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_value\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// tls_client_auth_san_uri\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"tls_client_auth_san_ip\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"san_ip\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dGxzX2NsaWVudF9hdXRoX3Nhbl9pcA==\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_key\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzYW5faXAucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_value\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// tls_client_auth_san_ip\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"tls_client_auth_san_email\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"san_email\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"dGxzX2NsaWVudF9hdXRoX3Nhbl9lbWFpbA==\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_key\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzYW5fZW1haWwucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"pki_value\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// tls_client_auth_san_email\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiR7cGtpX2tleX0iOiIke3BraV92YWx1ZX0iLA==\"/>\n                            <L7p:VariableToSet stringValue=\"pki_param\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"eyIke3BraV9rZXl9IjoiJHtwa2lfdmFsdWV9In0=\"/>\n                            <L7p:VariableToSet stringValue=\"secret_or_jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"genSecret\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiI=\"/>\n                            <L7p:VariableToSet stringValue=\"jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"jwks_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"hashing_metadata\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use pki param for client authentication\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// by default, registration will generate a secret, convert plain text secret to hashed if it is not marked as master key and CWP 'otk.hashed_secret.enable' set as 'true'\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"eb33b796-a064-48aa-b6f5-d0ebad2bb0b9\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Create Client Secret Hash\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_secret\"/>\n                                    <L7p:value stringValue=\"${genSecret}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"master_key_flag\"/>\n                                    <L7p:value stringValue=\"${master}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// by default, registration will generate a secret\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtjbGllbnRfc2VjcmV0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"secret_or_jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"IiI=\"/>\n                            <L7p:VariableToSet stringValue=\"jwks\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"jwks_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"pki_param\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// use secret, ignore jwks/jwks_uri\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// use secret or jwks/jwks_uri/pki\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${master}\"/>\n                        <L7p:Expression2 stringValue=\"false\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"false\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjbGllbnRfaWRlbnR9\"/>\n                        <L7p:VariableToSet stringValue=\"genSecret\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// is it a master-key?\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"software_statement_value\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"$.software_statement\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"client_request\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"software_statement_param\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"InNvZnR3YXJlX3N0YXRlbWVudCI6IiR7c29mdHdhcmVfc3RhdGVtZW50X3BhcmFtLnJlc3VsdH0iLA==\"/>\n                            <L7p:VariableToSet stringValue=\"software_statement_value\"/>\n                        </L7p:SetVariable>\n                    </wsp:All>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// software statement\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjbGllbnRfcmVxdWVzdC5tYWlucGFydH0=\"/>\n                    <L7p:VariableToSet stringValue=\"openid_registration_request\"/>\n                </L7p:SetVariable>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"add locale-specific values \"/>\n                </L7p:CommentAssertion>\n                <L7p:Include>\n                    <L7p:PolicyGuid stringValue=\"e594f0f9-1f4c-4deb-969d-b4364c0d97ee\"/>\n                    <L7p:PolicyName stringValue=\"#OTK DCR - Response Compose Locale Fields\"/>\n                </L7p:Include>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"ew0KICAgImNsaWVudF9pZCI6ICIke2NsaWVudF9pZGVudH0iLA0KICAgImNsaWVudF9zZWNyZXQiOg0KICAgICAiJHtnZW5TZWNyZXR9IiwNCiAgICJjbGllbnRfc2VjcmV0X2V4cGlyZXNfYXQiOiAke2dlbkV4cGlyYXRpb259LA0KICAgImNsaWVudF9pZF9pc3N1ZWRfYXQiOiR7Z2F0ZXdheS50aW1lLnNlY29uZHN9LA0KICAgInJlZ2lzdHJhdGlvbl9hY2Nlc3NfdG9rZW4iOg0KICAgICAiJHthY2Nlc3NfdG9rZW59IiwNCiAgICJyZWdpc3RyYXRpb25fY2xpZW50X3VyaSI6IiR7Y2xpZW50X2NvbmZpZ19lbmRwb2ludH0iLA0KICAgInRva2VuX2VuZHBvaW50X2F1dGhfbWV0aG9kIjoNCiAgICAgIiR7dG9rZW5fZW5kcG9pbnRfYXV0aF9tZXRob2R9IiwNCiAgICJ0b2tlbl9lbmRwb2ludF9hdXRoX3NpZ25pbmdfYWxnIjogIiR7dG9rZW5fZW5kcG9pbnRfYXV0aF9zaWduaW5nX2FsZ30iLA0KICAgImFwcGxpY2F0aW9uX3R5cGUiOiAiJHthcHBsaWNhdGlvbl90eXBlfSIsDQogICAicmVkaXJlY3RfdXJpcyI6IFske3JlZGlyZWN0X3VyaXN9XSwNCiAgICJwb3N0X2xvZ291dF9yZWRpcmVjdF91cmlzIiA6IFske3Bvc3RfbG9nb3V0X3JlZGlyZWN0X3VyaXN9XSwNCiAgICJjbGllbnRfbmFtZSI6ICIke2NsaWVudF9uYW1lfSIsDQogICAke2NsaWVudF9uYW1lX2xvY2FsZX0NCiAgICJzdWJqZWN0X3R5cGUiOiAiJHtzdWJqZWN0X3R5cGV9IiwNCiAgICJzZWN0b3JfaWRlbnRpZmllcl91cmkiOiIke3NlY3Rvcl9pZGVudGlmaWVyX3VyaX0iLA0KICAgImNvbnRhY3RzIjogWyR7Y29udGFjdHN9XSwNCiAgInJlc3BvbnNlX3R5cGVzIjpbJHtyZXNwb25zZV90eXBlc31dLA0KICAiZ3JhbnRfdHlwZXMiOlske2dyYW50X3R5cGVzfV0sDQogICJpZF90b2tlbl9zaWduZWRfcmVzcG9uc2VfYWxnIjoiJHtpZF90b2tlbl9zaWduZWRfcmVzcG9uc2VfYWxnfSIsDQogICJ1c2VyaW5mb19zaWduZWRfcmVzcG9uc2VfYWxnIjoiJHt1c2VyaW5mb19zaWduZWRfcmVzcG9uc2VfYWxnfSIsDQogICJyZXF1ZXN0X29iamVjdF9zaWduaW5nX2FsZyI6IiR7cmVxdWVzdF9vYmplY3Rfc2lnbmluZ19hbGd9IiwNCiAgInJlcXVlc3Rfb2JqZWN0X2VuY3J5cHRpb25fYWxnIjoiJHtyZXF1ZXN0X29iamVjdF9lbmNyeXB0aW9uX2FsZ30iLA0KICAicmVxdWVzdF9vYmplY3RfZW5jcnlwdGlvbl9lbmMiOiIke3JlcXVlc3Rfb2JqZWN0X2VuY3J5cHRpb25fZW5jfSIsDQogICJiYWNrY2hhbm5lbF9hdXRoZW50aWNhdGlvbl9yZXF1ZXN0X3NpZ25pbmdfYWxnIjoiJHtiYWNrY2hhbm5lbF9hdXRoZW50aWNhdGlvbl9yZXF1ZXN0X3NpZ25pbmdfYWxnfSIsDQogICJiYWNrY2hhbm5lbF90b2tlbl9kZWxpdmVyeV9tb2RlIjoiJHtiYWNrY2hhbm5lbF90b2tlbl9kZWxpdmVyeV9tb2RlfSIsDQogICJyZXF1aXJlX3B1c2hlZF9hdXRob3JpemF0aW9uX3JlcXVlc3RzIjoiJHtyZXF1aXJlX3B1c2hlZF9hdXRob3JpemF0aW9uX3JlcXVlc3RzfSIsDQogICJyZXF1ZXN0X3VyaXMiOlske3JlcXVlc3RfdXJpfV0sDQogICJlbnZpcm9ubWVudCI6IiR7ZW52aXJvbm1lbnR9IiwNCiAgIm9yZ2FuaXphdGlvbiI6IiR7b3JnYW5pemF0aW9ufSIsDQogICJtYXN0ZXIiOiR7bWFzdGVyfSwNCiAgImRlc2NyaXB0aW9uIjoiJHtkZXNjcmlwdGlvbn0iLA0KICAic2NvcGUiOiIke3Njb3BlLmdyYW50ZWR9IiwNCiAgImF1dGhvcml6YXRpb25fc2lnbmVkX3Jlc3BvbnNlX2FsZyIgOiAiJHthdXRob3JpemF0aW9uX3NpZ25lZF9yZXNwb25zZV9hbGd9IiwNCiAgJHthdXRob3JpemF0aW9uX3Jlc3BvbnNlX3BhcmFtc30NCiAgJHtwa2lfcGFyYW19DQogICR7c29mdHdhcmVfc3RhdGVtZW50X3ZhbHVlfQ0KICAiandrcyI6JHtqd2tzfSwNCiAgInBvbGljeV91cmkiOiAiJHtwb2xpY3lfdXJpfSIsDQogICR7cG9saWN5X3VyaV9sb2NhbGV9DQogICJ0b3NfdXJpIjogIiR7dG9zX3VyaX0iLA0KICAke3Rvc191cmlfbG9jYWxlfQ0KICAibG9nb191cmkiOiAiJHtsb2dvX3VyaX0iLA0KICAke2xvZ29fbG9jYWxlfQ0KICAiY2xpZW50X3VyaSI6ICIke2NsaWVudF91cml9IiwNCiAgJHtjbGllbnRfdXJpX2xvY2FsZX0NCiAgInN0YXR1cyI6IkVOQUJMRUQiLA0KICAic29mdHdhcmVfaWQiOiIke3NvZnR3YXJlX2lkfSIsDQogICJzb2Z0d2FyZV92ZXJzaW9uIjoiJHtzb2Z0d2FyZV92ZXJzaW9ufSIsDQogICAke2ZhcGlfcHJvZmlsZV9zZXR0aW5nfQ0KICAiandrc191cmkiOiIke2p3a3NfdXJpfSINCiAgfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"openid_registration_response\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"ew0KICAib3BlbmlkX3JlZ2lzdHJhdGlvbiI6IHsNCiAgICAicmVxdWVzdCI6JHtvcGVuaWRfcmVnaXN0cmF0aW9uX3JlcXVlc3R9LA0KICAgICJyZXNwb25zZSI6JHtvcGVuaWRfcmVnaXN0cmF0aW9uX3Jlc3BvbnNlfQ0KICB9DQp9\"/>\n                    <L7p:VariableToSet stringValue=\"openid_registration\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${master}\"/>\n                            <L7p:Expression2 stringValue=\"false\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"openid_registration\"/>\n                            <L7p:PatternContainsVariables booleanValue=\"true\"/>\n                            <L7p:Regex stringValue=\"&quot;${genSecret}&quot;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&quot;${client_secret}&quot;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                    </wsp:All>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// replace 'genSecret' in 'openid_registration'\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${persist_dcr_software_statement}\"/>\n                        <L7p:Expression2 stringValue=\"true\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"e30=\"/>\n                        <L7p:VariableToSet stringValue=\"ssa_payload\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//store software statement?\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// persist new client\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"71e2d996-cea5-4862-ad46-7b50c0d36c84\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Client Persist\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"account_plan_mapping_ids\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"callback\"/>\n                                <L7p:value stringValue=\"${redirect_uris.results}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_custom\"/>\n                                <L7p:value stringValue=\"{}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_ident\"/>\n                                <L7p:value stringValue=\"${client_ident}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_key\"/>\n                                <L7p:value stringValue=\"${client_ident}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_name\"/>\n                                <L7p:value stringValue=\"${client_name}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_secret\"/>\n                                <L7p:value stringValue=\"${secret_or_jwks}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_status\"/>\n                                <L7p:value stringValue=\"ENABLED\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"custom\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"description\"/>\n                                <L7p:value stringValue=\"${description}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"environment\"/>\n                                <L7p:value stringValue=\"${environment}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"expiration\"/>\n                                <L7p:value stringValue=\"${client_expiration}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"hashing_metadata\"/>\n                                <L7p:value stringValue=\"hashing_metadata\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"key_custom\"/>\n                                <L7p:value stringValue=\"${openid_registration}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"org\"/>\n                                <L7p:value stringValue=\"${organization}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"persist_client\"/>\n                                <L7p:value stringValue=\"false\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"persist_client_and_key\"/>\n                                <L7p:value stringValue=\"true\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"persist_client_key\"/>\n                                <L7p:value stringValue=\"false\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"registered_by\"/>\n                                <L7p:value stringValue=\"${registered_by}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"scope\"/>\n                                <L7p:value stringValue=\"${scope.granted}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"secret_expiration\"/>\n                                <L7p:value stringValue=\"${genExpiration}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"service_ids\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"software_statement\"/>\n                                <L7p:value stringValue=\"${ssa_payload}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"type\"/>\n                                <L7p:value stringValue=\"${client_type}\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"The client could not be registered! Client name: '${client_name}'\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Could not be persisted\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"${error.code}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Persist the client\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"MA==\"/>\n                    <L7p:DataType variableDataType=\"int\"/>\n                    <L7p:VariableToSet stringValue=\"token_rank\"/>\n                </L7p:SetVariable>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// create initial access_token\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"eb5e4d62-555a-43a2-b3ad-d0f4050ca3b8\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Token Storage (access_token)\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"client\"/>\n                            <L7p:value stringValue=\"${client_ident}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"client_key\"/>\n                            <L7p:value stringValue=\"${client_ident}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"client_name\"/>\n                            <L7p:value stringValue=\"${client_name}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"custom\"/>\n                            <L7p:value stringValue=\"{}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"expiration\"/>\n                            <L7p:value stringValue=\"${access_token_expiration}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource_owner\"/>\n                            <L7p:value stringValue=\"${registered_by}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"scope\"/>\n                            <L7p:value stringValue=\"${dynamic_registration_scope}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"token\"/>\n                            <L7p:value stringValue=\"${access_token}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"token_secret\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"token_status\"/>\n                            <L7p:value stringValue=\"ENABLED\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"201\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// registration response\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64ResponseBody stringValue=\"JHtvcGVuaWRfcmVnaXN0cmF0aW9uX3Jlc3BvbnNlfQ==\"/>\n                    <L7p:ResponseContentType stringValue=\"application/json; charset=UTF-8\"/>\n                    <L7p:ResponseStatus stringValue=\"201\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"Request\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${isPreflight}\"/>\n                    <L7p:MultivaluedComparison multivaluedComparison=\"FIRST\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"204\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:ResponseContentType stringValue=\"text/plain;charset=UTF-8\"/>\n                    <L7p:ResponseStatus stringValue=\"204\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Replace\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Override header to reflect actual allowed methods\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:HeaderName stringValue=\"Access-Control-Allow-Methods\"/>\n                    <L7p:HeaderValue stringValue=\"POST\"/>\n                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"IsPreflight\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"PreFlight\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Check for CORS-Pre-Flight\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>"
  }
}