{
  "goid": "e73aa375c92bf77a0b52a366672b02c5",
  "guid": "55f09b2b-5d56-49bb-acff-9366be21240e",
  "name": "auth/oauth/v2/authorize/login",
  "resolutionPath": "/auth/oauth/v2/authorize/login",
  "serviceType": "WEB_API",
  "checksum": "f5c813d2815ac8c4f040407c47b832558e4b1440",
  "enabled": true,
  "folderPath": "/OTK/Server/DMZ/OAuth 2.0/AuthorizationServer",
  "methodsAllowed": [
    "GET",
    "POST",
    "PUT",
    "PATCH",
    "DELETE",
    "HEAD",
    "OPTIONS",
    "OTHER"
  ],
  "tracingEnabled": false,
  "wssProcessingEnabled": false,
  "laxResolution": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== *** THIS POLICY IS OVERWRITTEN DURING AN UPGRADE ***\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== Be aware that custom configuration made in this policy is overwritten during a solution kit upgrade.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== However, the older version of the policy is kept in the history and can be referenced.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== After upgrade, manually merge customizations from the old version of the policy to the new version.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"This policy issues an authorization grant or an token for 'token' response_type\"/>\n        </L7p:CommentAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${gateway.otk.enable_auditing}\"/>\n                <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:AuditAssertion/>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Audit the service policy execution\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:CustomizeErrorResponse>\n            <L7p:Content stringValue=\"${error.msg}\"/>\n            <L7p:ContentType stringValue=\"${content-type}\"/>\n            <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Cache-Control\"/>\n                    <L7p:Value stringValue=\"no-store\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Pragma\"/>\n                    <L7p:Value stringValue=\"no-cache\"/>\n                </L7p:item>\n            </L7p:ExtraHeaders>\n            <L7p:HttpStatus stringValue=\"${status}\"/>\n        </L7p:CustomizeErrorResponse>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbbc4f7d-cd06-41f3-8011-695bfad1d80b\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Configuration\"/>\n        </L7p:Encapsulated>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6\"/>\n            <L7p:PolicyName stringValue=\"OTK Security Header Extension\"/>\n        </L7p:Include>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:AddHeader>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"HTTPS only\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Inform the browser to only accept SSL connections\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:HeaderName stringValue=\"Content-Security-Policy\"/>\n                <L7p:HeaderValue stringValue=\"default-src 'self'; script-src  ajax.googleapis.com 'unsafe-inline'; img-src * data:; style-src 'unsafe-inline'; font-src * data:; object-src 'none';\"/>\n                <L7p:RemoveExisting booleanValue=\"true\"/>\n                <L7p:Target target=\"RESPONSE\"/>\n            </L7p:AddHeader>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Override OTK Security Header Extension\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"initialize\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"will be overridden in the case of an error\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"\"/>\n            <L7p:VariableToSet stringValue=\"error.code\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"initialize\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"will be overridden in the case of an error\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"\"/>\n            <L7p:VariableToSet stringValue=\"error.msg\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25JRH0=\"/>\n            <L7p:VariableToSet stringValue=\"sessionID\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25EYXRhfQ==\"/>\n            <L7p:VariableToSet stringValue=\"sessionDataJWT\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFjdGlvbn0=\"/>\n            <L7p:VariableToSet stringValue=\"action\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"2be8eaf2-9b42-4173-ace9-3fdb471fb407\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"API XSS Protection\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"allinput\"/>\n                        <L7p:value stringValue=\"${request.mainpart}${request.url}\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"json response\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"return json error response\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:FalseAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"return false\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"stop processing the whole policy\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                </L7p:FalseAssertion>\n            </wsp:All>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"API-ID 3001\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"47f768f4-b478-472b-a1ee-10f4b6e76f99\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Require SSL (with Client Certificate)\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"3001\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireClientCert\"/>\n                        <L7p:value stringValue=\"false\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"SSL\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Require SSL\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"POST GET\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b8822449-71ff-455b-8f10-39122e6c549b\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK HTTP Method Validation\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"method\"/>\n                        <L7p:value stringValue=\"POST|GET\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Method\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Checking the HTTP method\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:HtmlFormDataAssertion>\n                <L7p:AllowGet booleanValue=\"true\"/>\n                <L7p:AllowPost booleanValue=\"true\"/>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"success\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                    <L7p:item htmlFormFieldSpec=\"included\">\n                        <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                        <L7p:DataType fieldDataType=\"any\"/>\n                        <L7p:MaxOccurs intValue=\"1\"/>\n                        <L7p:MinOccurs intValue=\"1\"/>\n                        <L7p:Name stringValue=\"action\"/>\n                    </L7p:item>\n                </L7p:FieldSpecs>\n            </L7p:HtmlFormDataAssertion>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:HtmlFormDataAssertion>\n                    <L7p:AllowGet booleanValue=\"true\"/>\n                    <L7p:AllowPost booleanValue=\"true\"/>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Social Login\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"//Require code and state\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                        <L7p:item htmlFormFieldSpec=\"included\">\n                            <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                            <L7p:DataType fieldDataType=\"any\"/>\n                            <L7p:MaxOccurs intValue=\"1\"/>\n                            <L7p:MinOccurs intValue=\"1\"/>\n                            <L7p:Name stringValue=\"code\"/>\n                        </L7p:item>\n                        <L7p:item htmlFormFieldSpec=\"included\">\n                            <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                            <L7p:DataType fieldDataType=\"any\"/>\n                            <L7p:MaxOccurs intValue=\"1\"/>\n                            <L7p:Name stringValue=\"provider\"/>\n                        </L7p:item>\n                        <L7p:item htmlFormFieldSpec=\"included\">\n                            <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                            <L7p:DataType fieldDataType=\"any\"/>\n                            <L7p:MaxOccurs intValue=\"1\"/>\n                            <L7p:MinOccurs intValue=\"1\"/>\n                            <L7p:Name stringValue=\"state\"/>\n                        </L7p:item>\n                    </L7p:FieldSpecs>\n                </L7p:HtmlFormDataAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"bG9naW4=\"/>\n                    <L7p:VariableToSet stringValue=\"action\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y29kZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"subAction\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"//Handle third party authentication\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:OneOrMore wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"103\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"API-ID 3001\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"apiPrefix\"/>\n                            <L7p:value stringValue=\"3001\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"givenErrorCode\"/>\n                            <L7p:value stringValue=\"103\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"content\"/>\n                                <L7p:value stringValue=\"${errorDetail}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"error.content\"/>\n                                <L7p:value stringValue=\"${error.msg}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"new.content\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"other\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"task\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:AddHeader>\n                        <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                        <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                        <L7p:RemoveExisting booleanValue=\"true\"/>\n                        <L7p:Target target=\"RESPONSE\"/>\n                    </L7p:AddHeader>\n                    <L7p:FalseAssertion/>\n                </wsp:All>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"get the error message\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:OneOrMore>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Parameters\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"3d2c0a92-0961-4e4e-a5ae-fe745cf5134d\"/>\n            <L7p:PolicyName stringValue=\"#OTK SMSession User Credentials\"/>\n        </L7p:Include>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${action}\"/>\n                        <L7p:Expression2 stringValue=\"login\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"login\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${sm_action}\"/>\n                        <L7p:Expression2 stringValue=\"sm_login\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"sm_login\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                </wsp:OneOrMore>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"false\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:HtmlFormDataAssertion>\n                        <L7p:AllowGet booleanValue=\"true\"/>\n                        <L7p:AllowPost booleanValue=\"true\"/>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"local\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// the resource_owner authenticated against the local IDP\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionData\"/>\n                            </L7p:item>\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionID\"/>\n                            </L7p:item>\n                        </L7p:FieldSpecs>\n                    </L7p:HtmlFormDataAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:HtmlFormDataAssertion>\n                                    <L7p:AllowGet booleanValue=\"true\"/>\n                                    <L7p:AllowPost booleanValue=\"true\"/>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Social Login\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                                    <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"code\"/>\n                                    </L7p:item>\n                                    <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"oauth_token\"/>\n                                    </L7p:item>\n                                    <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"true\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"oauth_verifier\"/>\n                                    </L7p:item>\n                                    <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:MinOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"provider\"/>\n                                    </L7p:item>\n                                    <L7p:item htmlFormFieldSpec=\"included\">\n                                    <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                    <L7p:DataType fieldDataType=\"any\"/>\n                                    <L7p:MaxOccurs intValue=\"1\"/>\n                                    <L7p:MinOccurs intValue=\"1\"/>\n                                    <L7p:Name stringValue=\"state\"/>\n                                    </L7p:item>\n                                    </L7p:FieldSpecs>\n                                </L7p:HtmlFormDataAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnByb3ZpZGVyfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"provider\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnN0YXRlfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"sessionID\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${subAction}\"/>\n                                    <L7p:Expression2 stringValue=\"code\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"code\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnByb3ZpZGVyfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"provider\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnN0YXRlfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"sessionID\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNvZGV9\"/>\n                                    <L7p:VariableToSet stringValue=\"code\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success - third party\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:FalseAssertion/>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"parameters\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// check for parameters\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"retrieve associated session JWT\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"300\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"socialLoginAuthorizeCache\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                </L7p:ResponseXpathAssertion>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"sessionDataJWT\"/>\n                                    <L7p:TransformType transformType=\"URL_DECODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:FalseAssertion/>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// look up the social login session\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"social login\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// the resource_owner authenticated via social login provider (third party)\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Parameters\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"prompt\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"acr_values\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"sessionID\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Make sure the session is still available\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                            <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                <L7p:VariableToSet stringValue=\"hasSession\"/>\n                            </L7p:SetVariable>\n                            <L7p:EncodeDecode>\n                                <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                                <L7p:TargetDataType variableDataType=\"string\"/>\n                                <L7p:TargetVariableName stringValue=\"decoded\"/>\n                                <L7p:TransformType transformType=\"URL_DECODE\"/>\n                            </L7p:EncodeDecode>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:FindAll booleanValue=\"true\"/>\n                                    <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"decoded\"/>\n                                    <L7p:Regex stringValue=\"&amp;\"/>\n                                    <L7p:Replace booleanValue=\"true\"/>\n                                    <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:Regex>\n                                <L7p:TrueAssertion/>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// escape &amp;\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtkZWNvZGVkfQ==\"/>\n                                <L7p:ContentType stringValue=\"text/xml;charset=UTF-8\"/>\n                                <L7p:DataType variableDataType=\"message\"/>\n                                <L7p:VariableToSet stringValue=\"grantedContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"authorizeRedirectURI\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/redirect_uri/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    </L7p:XpathExpression>\n                                </L7p:ResponseXpathAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"authorizeRedirectURI.result\"/>\n                                </L7p:SetVariable>\n                            </wsp:OneOrMore>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"xpathResponseMode\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/response_mode/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"xpathResponseType\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/response_type/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeState\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/state\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeClientID\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/client_id/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeClientKeyCustom\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/client_key_custom\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:EncodeDecode>\n                                <L7p:SourceVariableName stringValue=\"authorizeRedirectURI.result\"/>\n                                <L7p:TargetDataType variableDataType=\"string\"/>\n                                <L7p:TargetVariableName stringValue=\"authorizeRedirectURIDecoded\"/>\n                                <L7p:TransformType transformType=\"URL_DECODE\"/>\n                            </L7p:EncodeDecode>\n                            <L7p:EncodeDecode>\n                                <L7p:SourceVariableName stringValue=\"xpathResponseMode.result\"/>\n                                <L7p:TargetDataType variableDataType=\"string\"/>\n                                <L7p:TargetVariableName stringValue=\"response_mode\"/>\n                                <L7p:TransformType transformType=\"URL_DECODE\"/>\n                            </L7p:EncodeDecode>\n                            <L7p:EncodeDecode>\n                                <L7p:SourceVariableName stringValue=\"xpathResponseType.result\"/>\n                                <L7p:TargetDataType variableDataType=\"string\"/>\n                                <L7p:TargetVariableName stringValue=\"response_type\"/>\n                                <L7p:TransformType transformType=\"URL_DECODE\"/>\n                            </L7p:EncodeDecode>\n                            <L7p:EncodeDecode>\n                                <L7p:SourceVariableName stringValue=\"authorizeState.result\"/>\n                                <L7p:TargetDataType variableDataType=\"string\"/>\n                                <L7p:TargetVariableName stringValue=\"authorizeStateDecoded\"/>\n                                <L7p:TransformType transformType=\"URL_DECODE\"/>\n                            </L7p:EncodeDecode>\n                            <L7p:EncodeDecode>\n                                <L7p:SourceVariableName stringValue=\"authorizeClientID.result\"/>\n                                <L7p:TargetDataType variableDataType=\"string\"/>\n                                <L7p:TargetVariableName stringValue=\"authorizeClientIDDecoded\"/>\n                                <L7p:TransformType transformType=\"URL_DECODE\"/>\n                            </L7p:EncodeDecode>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDbGllbnRLZXlDdXN0b20ucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"authorizeClientKeyCustomDecoded\"/>\n                            </L7p:SetVariable>\n                        </wsp:All>\n                        <L7p:DecodeJsonWebToken>\n                            <L7p:SignatureSecret stringValue=\"${otk_session_secret}\"/>\n                            <L7p:SourcePayload stringValue=\"${sessionDataJWT}\"/>\n                            <L7p:TargetVariablePrefix stringValue=\"sessionData\"/>\n                            <L7p:ValidationType stringValue=\"Using Secret\"/>\n                        </L7p:DecodeJsonWebToken>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Verify the signature validation result\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${sessionData.valid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uRGF0YS5wYXlsb2FkfQ==\"/>\n                            <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"sessionData\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.sessionID\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"sessionIDJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.exp\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"expJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.prompt\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"promptJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.id_token_hint\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"id_token_hintJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.acr_values\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"acr_valuesJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.acr_values_essential\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"acr_values_essentialJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.client_id\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"clientIdJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.max_age\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"maxAge\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_consent.scope_verified\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"scopeVerifiedJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_consent.resource_verified\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"resourceVerifiedJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.logo_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_logo_uri\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X2xvZ29fdXJpLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                            <L7p:Expression2 stringValue=\"${sessionIDJWT.result}\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"${sessionIDJWT.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${expJWT.result}\"/>\n                            <L7p:Expression2 stringValue=\"${gateway.time.seconds}\"/>\n                            <L7p:Operator operator=\"GE\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"${gateway.time.seconds}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtwcm9tcHRKV1QucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"prompt\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthY3JfdmFsdWVzSldULnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"acr_values\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthY3JfdmFsdWVzX2Vzc2VudGlhbEpXVC5yZXN1bHR9\"/>\n                            <L7p:VariableToSet stringValue=\"acr_values_essential\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"prompt\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"prompt\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"acr_values\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"acr_values\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access the values stored in the cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"isLogin\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other_for_consent\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"session data\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"check for valid session, set 'prompt' and 'acr_values'\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                            <L7p:Regex stringValue=\"\\bnone\\b\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                            <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                            <L7p:Regex stringValue=\"\\blogin\\b\"/>\n                            <L7p:Replacement stringValue=\"\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtpZF90b2tlbl9oaW50SldULnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"id_token_hint\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b79ebaf7-acff-4eac-8d48-61b90bf597cb\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Cookie Management\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookie\"/>\n                                    <L7p:value stringValue=\"${request.http.cookies}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookieName\"/>\n                                    <L7p:value stringValue=\"sessionCookie\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookieValue\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"lifetime\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjb29raWVWYWx1ZX0=\"/>\n                                    <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"cookieValue\"/>\n                                </L7p:SetVariable>\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"current.username\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"cookieValue\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"resource_owner\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${resource_owner.result}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZV9vd25lci5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"lookupOwner\"/>\n                                </L7p:SetVariable>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"755e056d-fe4a-440c-81ac-cc76dfd58899\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK id_token Lookup\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"azp\"/>\n                                    <L7p:value stringValue=\"${clientIdJWT.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"format\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"jwt\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${lookupOwner}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"sub\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"jwtValues\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ns:values/ns:value/ns:jwt/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-tokenstore\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                </L7p:ResponseXpathAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RWYWx1ZXMucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"id_token_hint\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:ComparisonAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"id_token_hint provided\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Expression1 stringValue=\"${id_token_hint}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"cookie\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"prompt\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"check that prompt includes none and not login\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"id_token_hint\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"id_token_hint or cookie\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Only respected if prompt contains 'none' and not 'login'\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${subAction}\"/>\n                                    <L7p:Expression2 stringValue=\"code\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"code\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:CommentAssertion>\n                                    <L7p:Comment stringValue=\"============================================\"/>\n                                </L7p:CommentAssertion>\n                                <L7p:CommentAssertion>\n                                    <L7p:Comment stringValue=\"Override the below config &amp; remove setting this within #OTK Third Party Configuration to support specific redirect uri for OIDC TP login\"/>\n                                </L7p:CommentAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Optional\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Ensure, the redirection from the third party OIDC happens to the OTK authorization login endpoint\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"aHR0cHM6Ly8ke2dhdGV3YXkuY2x1c3Rlci5ob3N0bmFtZX06JHtnYXRld2F5Lm90ay5wb3J0fS9hdXRoL29hdXRoL3YyL2F1dGhvcml6ZS9sb2dpbj9hY3Rpb249bG9naW4=\"/>\n                                    <L7p:Enabled booleanValue=\"false\"/>\n                                    <L7p:VariableToSet stringValue=\"third_party_oidc.redirect_uri\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Optional\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValueReference=\"inline\"><![CDATA[Override this here & remove setting this within #OTK Third Party Configuration to support specific redirect uri for OIDC TP login\nRetrieve third party OIDC client_id (either hard code the value here, or use OTK client custom column)]]></L7p:value>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"VEhJUkRfUEFSVFlfT0lEQ19DTElFTlRfSUQ=\"/>\n                                    <L7p:Enabled booleanValue=\"false\"/>\n                                    <L7p:VariableToSet stringValue=\"third_party_oidc.client_id\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Optional\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Retrieve third party OIDC client_secret (DO NOT hard-code the value here, try retrieving it from secure passwords, i.e., ${secpass.third_party_oidc_client_secret.plaintext})\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"VEhJUkRfUEFSVFlfQ0xJRU5UX1NFQ1JFVA==\"/>\n                                    <L7p:Enabled booleanValue=\"false\"/>\n                                    <L7p:VariableToSet stringValue=\"third_party_oidc.client_secret\"/>\n                                </L7p:SetVariable>\n                                <L7p:CommentAssertion>\n                                    <L7p:Comment stringValue=\"============================================\"/>\n                                </L7p:CommentAssertion>\n                                <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"ddc12b1f-ade6-4279-b3ba-0f9adeef4211\"/>\n                                    <L7p:PolicyName stringValue=\"#OTK Third Party Login Auth Code Verification\"/>\n                                </L7p:Include>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt1c2VybG9naW4ucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"current.username\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt1c2VyYWNyLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"current.user.acr\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtyaXNrc2NvcmUucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"riskscore\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXJuYW1lfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"resource_owner\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXJuYW1lfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"salt\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtnYXRld2F5LnRpbWUuc2Vjb25kc30=\"/>\n                                    <L7p:VariableToSet stringValue=\"current.user.authTime\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXIucm9sZX0=\"/>\n                                    <L7p:VariableToSet stringValue=\"resource_owner_role\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdC5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"third_party_sso_token\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHt0aGlyZF9wYXJ0eV9vaWRjX3Byb3ZpZGVyfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"third_party_sso_token_type\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"authenticate via 3rd-party OIDC integration\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"27196c5d-a37a-4ee3-a24a-01615c2e1bb1\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK User Authentication\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"acrValuesEssential\"/>\n                                    <L7p:value stringValue=\"${acr_values_essential}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"acrValuesRequested\"/>\n                                    <L7p:value stringValue=\"${acr_values}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"authHeader\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"authIdToken\"/>\n                                    <L7p:value stringValue=\"${id_token_hint}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"authSession\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"clientId\"/>\n                                    <L7p:value stringValue=\"${clientIdJWT.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookie\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cookiename\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"maxAge\"/>\n                                    <L7p:value stringValue=\"${maxAge.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"oauth_token\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.oauth_token}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"oauth_verifier\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.oauth_verifier}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"password\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.password}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"prompt\"/>\n                                    <L7p:value stringValue=\"${prompt}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"provider\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.provider}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"state\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"username\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.username}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXJuYW1lfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"resource_owner\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXIucm9sZX0=\"/>\n                                    <L7p:VariableToSet stringValue=\"resource_owner_role\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"authenticate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"MjAy\"/>\n                                    <L7p:VariableToSet stringValue=\"error.code\"/>\n                                </L7p:SetVariable>\n                                <L7p:FalseAssertion/>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// login required\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"User authentication\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                    <L7p:Regex stringValue=\"\\bnone\\b\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"\\bconsent\\b\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"prompt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"check that prompt includes none and not consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_type}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"id_token\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"clientIdJWT.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"client_id\"/>\n                                    <L7p:TransformType transformType=\"URL_DECODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"19902efe-b202-49da-a5d9-619c57ee842a\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Token Get (token)\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${client_id}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"queryOffset\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"return_json\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"rtoken\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"token\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"token_status\"/>\n                                    <L7p:value stringValue=\"ENABLED\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"client_id\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"check if the dataset is associated with the correct client\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"xpathScope\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"ns:values/ns:value/ns:scope[../ns:client_key=$client_id]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-tokenstore\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"scopeVerifiedJWT.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"scopeRequested\"/>\n                                    <L7p:TransformType transformType=\"URL_DECODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f78f0f85-00e2-49b1-95e4-e520df255c9c\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK SCOPE Verification\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"any\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"fail\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"scope.granted\"/>\n                                    <L7p:value stringValue=\"${xpathScope.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"scope.required\"/>\n                                    <L7p:value stringValue=\"${scopeRequested}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"client_id\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"check if the dataset is associated with the correct client\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"xpathResource\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"ns:values/ns:value/ns:resource[../ns:client_key=$client_id]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-tokenstore\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"resourceVerifiedJWT.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"resourceRequested\"/>\n                                    <L7p:TransformType transformType=\"URL_DECODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b45b1910-a4c2-442a-b953-ece942683972\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK RESOURCE Verification - Extended\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource.granted\"/>\n                                    <L7p:value stringValue=\"${xpathResource.result}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource.required\"/>\n                                    <L7p:value stringValue=\"${resourceRequested}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// find current session\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Handle session, skip it for response type id_token\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"active\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent exists\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"Z3JhbnQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"action_next\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"active\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent exists\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"YWN0aXZl\"/>\n                                    <L7p:VariableToSet stringValue=\"consent\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"active\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent has been given for the same client with the same requested scope\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Regex>\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"prompt\"/>\n                                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                                    <L7p:Regex stringValue=\"\\bnone\\b\"/>\n                                    <L7p:Replacement stringValue=\"\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:Regex>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent or grant\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"next step: request consent if it does not exist\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"Y29uc2VudA==\"/>\n                                    <L7p:VariableToSet stringValue=\"action_next\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"none\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent does not exist\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"bm9uZQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"consent\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"none\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"MzA0\"/>\n                                    <L7p:VariableToSet stringValue=\"error.code\"/>\n                                </L7p:SetVariable>\n                                <L7p:FalseAssertion/>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// prompt=none, consent required\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"check if consent has been given before\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${smsession_cookie}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${bypass_consent}\"/>\n                                    <L7p:Expression2 stringValue=\"grant\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"grant\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"Z3JhbnQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"action_next\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"YWN0aXZl\"/>\n                                    <L7p:VariableToSet stringValue=\"consent\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:TrueAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Never fail, continue prompting for consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                            </L7p:TrueAssertion>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"BYPASS Consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"if authenticate via smsession\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uRGF0YS5tYWlucGFydH0=\"/>\n                            <L7p:VariableToSet stringValue=\"sessionData\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"current.user.acr\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"current.user.acr\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"current_user_consent&quot;:[\\s]?&quot;none&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"current_user_consent&quot;:&quot;${consent}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"current_username&quot;:[\\s]?&quot;&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"current_username&quot;:&quot;${resource_owner}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"current_user_role&quot;:[\\s]?&quot;&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"current_user_role&quot;:&quot;${resource_owner_role}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"current_user_acr&quot;:[\\s]?&quot;0&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"current_user_acr&quot;:&quot;${current.user.acr}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"current_user_authTime&quot;:[\\s]?&quot;0&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"current_user_authTime&quot;:&quot;${current.user.authTime}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"salt&quot;:[\\s]?&quot;&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"salt&quot;:&quot;${salt}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"third_party_sso_token&quot;:[\\s]?&quot;&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"third_party_sso_token&quot;:&quot;${third_party_sso_token}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:Regex>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                                <L7p:Regex stringValue=\"third_party_sso_token_type&quot;:[\\s]?&quot;&quot;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"third_party_sso_token_type&quot;:&quot;${third_party_sso_token_type}&quot;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Update\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Update session data\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:EncodeJsonWebToken>\n                            <L7p:ContentEncryptionAlgorithm stringValue=\"A128CBC-HS256\"/>\n                            <L7p:EncryptPayload booleanValue=\"true\"/>\n                            <L7p:EncryptionSecret stringValue=\"${otk_session_secret_encryption}\"/>\n                            <L7p:KeyManagementAlgorithm stringValue=\"dir\"/>\n                            <L7p:SignPayload booleanValue=\"true\"/>\n                            <L7p:SignatureAlgorithm stringValue=\"HS256\"/>\n                            <L7p:SignatureSecretKey stringValue=\"${otk_session_secret}\"/>\n                            <L7p:SourceVariable stringValue=\"${sessionData}\"/>\n                            <L7p:TargetVariable stringValue=\"jwt_session\"/>\n                        </L7p:EncodeJsonWebToken>\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"200\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Auto-Form-Post\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64ResponseBody stringValue=\"PGh0bWw+CjxIRUFEPgogICAgPE1FVEEgSFRUUC1FUVVJVj0nUFJBR01BJyBDT05URU5UPSdOTy1DQUNIRSc+CiAgICA8TUVUQSBIVFRQLUVRVUlWPSdDQUNIRS1DT05UUk9MJyBDT05URU5UPSdOTy1DQUNIRSc+CiAgICA8VElUTEU+TG9naW4gQXV0by1QT1NUIGZvcm08L1RJVExFPjwvSEVBRD4KPGJvZHkgb25Mb2FkPSJkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+CjxOT1NDUklQVD5Zb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBKYXZhU2NyaXB0LiBQbGVhc2UgY2xpY2sgdGhlICdDb250aW51ZScgYnV0dG9uIGJlbG93IHRvIHByb2NlZWQuPC9OT1NDUklQVD48YnIvPgo8Zm9ybSBhY3Rpb249IiR7bG9jYXRpb25fY29uc2VudF9zZXJ2ZXJ9IiBtZXRob2Q9IlBPU1QiIGVuY3R5cGU9ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCI+CiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhY3Rpb24iIHZhbHVlPSIke2FjdGlvbl9uZXh0fSI+CiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzZXNzaW9uSUQiIHZhbHVlPSIke3Nlc3Npb25JRH0iPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic2Vzc2lvbkRhdGEiIHZhbHVlPSIke2p3dF9zZXNzaW9uLmNvbXBhY3R9Ij4KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InJlc3BvbnNlX3R5cGUiIHZhbHVlPSIke3Jlc3BvbnNlX3R5cGV9Ij4KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InJlc3BvbnNlX21vZGUiIHZhbHVlPSIke3Jlc3BvbnNlX21vZGV9Ij4KICAgIDxOT1NDUklQVD48SU5QVVQgVFlQRT0iU1VCTUlUIiBWQUxVRT0iQ29udGludWUiPjwvTk9TQ1JJUFQ+CjwvZm9ybT4KPC9ib2R5Pgo8L2h0bWw+\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"eyAgDQogICAiY3VycmVudCI6eyAgDQogICAgICAidXNlcm5hbWUiOiIke2N1cnJlbnQudXNlcm5hbWV9IiwNCiAgICAgICJ1c2VyIjp7ICANCiAgICAgICAgICJhdHRyaWJ1dGVzIjoiJHtjdXJyZW50LnVzZXIuYXR0cmlidXRlc30iLA0KICAgICAgICAgInJvbGUiOiIke2N1cnJlbnQudXNlci5yb2xlfSIsDQogICAgICAgICAiYWNyIjoiJHtjdXJyZW50LnVzZXIuYWNyfSIsDQogICAgICAgICAiYXV0aFRpbWUiOiR7Y3VycmVudC51c2VyLmF1dGhUaW1lfQ0KICAgICAgfQ0KICAgfSwNCiAgICJzYWx0IjoiJHtzYWx0fSIsDQogICAidGhpcmRfcGFydHlfc3NvX3Rva2VuIjoiJHt0aGlyZF9wYXJ0eV9zc29fdG9rZW59IiwNCiAgICJ0aGlyZF9wYXJ0eV9zc29fdG9rZW5fdHlwZSI6IiR7dGhpcmRfcGFydHlfc3NvX3Rva2VuX3R5cGV9Ig0KfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"cookieValue\"/>\n                        </L7p:SetVariable>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b79ebaf7-acff-4eac-8d48-61b90bf597cb\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Cookie Management\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cookie\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cookieName\"/>\n                                    <L7p:value stringValue=\"sessionCookie\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cookieValue\"/>\n                                    <L7p:value stringValue=\"${cookieValue}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"lifetime\"/>\n                                    <L7p:value stringValue=\"3600\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"true\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Set-Cookie\"/>\n                            <L7p:HeaderValue stringValue=\"${setCookie}\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"${error.code}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${prompt}\"/>\n                                    <L7p:Expression2 stringValue=\"none\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${hasSession}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvci5tc2d9\"/>\n                                    <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"jsonMsg\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"error_description\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"error_description\"/>\n                                    </L7p:EvaluateJsonPathExpression>\n                                    <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"error\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"error\"/>\n                                    </L7p:EvaluateJsonPathExpression>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9kZXNjcmlwdGlvbi5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"error_description\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvci5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"error_type\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"error_description.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"error_description_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"error.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"error_type_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error description\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// extract error description from error.msg\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"location\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"used with location header\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"ZXJyb3I9JHtlcnJvcl90eXBlX2VuY29kZWR9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb25fZW5jb2RlZH0meC1jYS1lcnI9JHtlcnJvci5jb2RlfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"path\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"jwt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"used with location header\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"ImVycm9yIjogIiR7ZXJyb3JfdHlwZX0iLA0KImVycm9yX2Rlc2NyaXB0aW9uIjogIiR7ZXJyb3JfZGVzY3JpcHRpb259IiwNCiJ4LWNhLWVyciI6ICIke2Vycm9yLmNvZGV9Ig==\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtError\"/>\n                                </L7p:SetVariable>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeStateDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtwYXRofSZzdGF0ZT0ke2F1dGhvcml6ZVN0YXRlLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"path\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RFcnJvcn0sDQoic3RhdGUiOiAiJHthdXRob3JpemVTdGF0ZS5yZXN1bHR9Ig==\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtError\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"state\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"add state parameter if sent in request message\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"fragment\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9IyR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"query\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9PyR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=query\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iZXJyb3IiIHZhbHVlPSIke2Vycm9yX3R5cGV9Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJlcnJvcl9kZXNjcmlwdGlvbiIgdmFsdWU9IiR7ZXJyb3JfZGVzY3JpcHRpb259Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ4LWNhLWVyciIgdmFsdWU9IiR7ZXJyb3IuY29kZX0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"response\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:HardcodedResponse>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64ResponseBody stringValue=\"JHtyZXNwb25zZX0=\"/>\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n                                    <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                    </L7p:HardcodedResponse>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=form_post\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"fragment.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JnJlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9I3Jlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=fragment.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"query.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JnJlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9P3Jlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=query.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0icmVzcG9uc2UiIHZhbHVlPSIke2F1dGh6X3Jlc3BvbnNlX2p3dH0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"response\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:HardcodedResponse>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64ResponseBody stringValue=\"JHtyZXNwb25zZX0=\"/>\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n                                    <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                    </L7p:HardcodedResponse>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=form_post.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"location\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"build location\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <L7p:HardcodedResponse>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"302\"/>\n                                </L7p:HardcodedResponse>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Location\"/>\n                                    <L7p:HeaderValue stringValue=\"${location}\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${prompt}\"/>\n                                    <L7p:Expression2 stringValue=\"none\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                    </L7p:AddHeader>\n                                    <L7p:FalseAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"HTML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302, HTML\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Error\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Authentication\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// authenticate and prepare consent request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"login\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Authenticate the resource_owner\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${action}\"/>\n                    <L7p:Expression2 stringValue=\"display\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"display\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:HtmlFormDataAssertion>\n                        <L7p:AllowGet booleanValue=\"true\"/>\n                        <L7p:AllowPost booleanValue=\"true\"/>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionData\"/>\n                            </L7p:item>\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionID\"/>\n                            </L7p:item>\n                        </L7p:FieldSpecs>\n                    </L7p:HtmlFormDataAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Parameters\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                            <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"decoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:FindAll booleanValue=\"true\"/>\n                                <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"decoded\"/>\n                                <L7p:Regex stringValue=\"&amp;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:TrueAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// escape &amp;\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtkZWNvZGVkfQ==\"/>\n                            <L7p:ContentType stringValue=\"text/xml;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"grantedContent\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"authorizeDeviceUserDomain\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/expected_device_user_domain\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"authorizeDeviceUser\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/expected_device_user\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVEZXZpY2VVc2VyRG9tYWluLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"expected-device-user-domain\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVEZXZpY2VVc2VyLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"expected-device-user\"/>\n                        </L7p:SetVariable>\n                        <L7p:DecodeJsonWebToken>\n                            <L7p:SignatureSecret stringValue=\"${otk_session_secret}\"/>\n                            <L7p:SourcePayload stringValue=\"${sessionDataJWT}\"/>\n                            <L7p:TargetVariablePrefix stringValue=\"sessionData\"/>\n                            <L7p:ValidationType stringValue=\"Using Secret\"/>\n                        </L7p:DecodeJsonWebToken>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Verify the signature validation result\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${sessionData.valid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uRGF0YS5wYXlsb2FkfQ==\"/>\n                            <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"sessionData\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.sessionID\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"sessionIDJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                            <L7p:Expression2 stringValue=\"${sessionIDJWT.result}\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"${sessionIDJWT.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access the values stored in the cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"110, API-ID 3001\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"isLogin\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other_for_consent\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"session data\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Get granted values\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:EvaluateJsonPathExpression>\n                    <L7p:Expression stringValue=\"request_parameters.display\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:VariablePrefix stringValue=\"displayJWT\"/>\n                </L7p:EvaluateJsonPathExpression>\n                <L7p:EvaluateJsonPathExpression>\n                    <L7p:Expression stringValue=\"request_parameters.login_hint\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:VariablePrefix stringValue=\"loginHintJWT\"/>\n                </L7p:EvaluateJsonPathExpression>\n                <L7p:EvaluateJsonPathExpression>\n                    <L7p:Expression stringValue=\"request_parameters.logo_uri\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:VariablePrefix stringValue=\"request_logo_uri\"/>\n                </L7p:EvaluateJsonPathExpression>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtkaXNwbGF5SldULnJlc3VsdH0=\"/>\n                    <L7p:VariableToSet stringValue=\"display\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtsb2dpbkhpbnRKV1QucmVzdWx0fQ==\"/>\n                    <L7p:VariableToSet stringValue=\"login_hint\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X2xvZ29fdXJpLnJlc3VsdH0=\"/>\n                    <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${login_hint}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:EncodeDecode>\n                        <L7p:SourceVariableName stringValue=\"login_hint\"/>\n                        <L7p:TargetDataType variableDataType=\"string\"/>\n                        <L7p:TargetVariableName stringValue=\"login_hint\"/>\n                        <L7p:TransformType transformType=\"URL_DECODE\"/>\n                    </L7p:EncodeDecode>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// login_hint\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${newContent}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"login_hint=${login_hint};\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"login\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"186b5c70-293e-4d60-82e3-afa431de3e7c\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"MAG Social Login Providers HTML\"/>\n                    <L7p:NoOpIfConfigMissing booleanValue=\"true\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"agent\"/>\n                            <L7p:value stringValue=\"${request.http.parameter.display}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"currentHost\"/>\n                            <L7p:value stringValue=\"${request.url.host}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"device-user\"/>\n                            <L7p:value stringValue=\"${expected-device-user}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"device-user-domain\"/>\n                            <L7p:value stringValue=\"${expected-device-user-domain}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"display\"/>\n                            <L7p:value stringValue=\"${display}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"enabled\"/>\n                            <L7p:value stringValue=\"true\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"hostname\"/>\n                            <L7p:value stringValue=\"${request.url.host}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"htmlContent\"/>\n                            <L7p:value stringValue=\"${content}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"mag-identifier\"/>\n                            <L7p:value stringValue=\"${mag-identifier}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"myhost\"/>\n                            <L7p:value stringValue=\"${request.url.host}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"sessionData\"/>\n                            <L7p:value stringValue=\"${sessionDataJWT}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"sessionID\"/>\n                            <L7p:value stringValue=\"${sessionID}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"socialLoginEnabled\"/>\n                            <L7p:value stringValue=\"true\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"200\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64ResponseBody stringValue=\"JHtjb250ZW50fQ==\"/>\n                    <L7p:ResponseContentType stringValue=\"${content-type}\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"display\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Display the login screen\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${action}\"/>\n                    <L7p:Expression2 stringValue=\"cancel\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"cancel\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"false\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:HtmlFormDataAssertion>\n                        <L7p:AllowGet booleanValue=\"true\"/>\n                        <L7p:AllowPost booleanValue=\"true\"/>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionID\"/>\n                            </L7p:item>\n                        </L7p:FieldSpecs>\n                    </L7p:HtmlFormDataAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Parameters\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                            <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"hasSession\"/>\n                        </L7p:SetVariable>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8d06714c-d54c-48e5-a454-e3c036b67f98\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Delete\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxEntries\"/>\n                                    <L7p:value stringValue=\"10000\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxSize\"/>\n                                    <L7p:value stringValue=\"10000\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"decoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtkZWNvZGVkfQ==\"/>\n                            <L7p:ContentType stringValue=\"text/xml;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"grantedContent\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeRedirectURI\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/redirect_uri/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"authorizeRedirectURI.result\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeState\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/state\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"xpathResponseMode\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/response_mode/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeRedirectURI.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeRedirectURIDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeState.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeStateDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"xpathResponseMode.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"response_mode\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"hasSession\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"session\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Lookup session data\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"123\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"apiPrefix\"/>\n                                <L7p:value stringValue=\"3001\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"givenErrorCode\"/>\n                                <L7p:value stringValue=\"123\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtlcnJvci5tc2d9\"/>\n                            <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"jsonMsg\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"error\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"error\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"error_description\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"error_description\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtlcnJvcl9kZXNjcmlwdGlvbi5yZXN1bHR9\"/>\n                            <L7p:VariableToSet stringValue=\"error_description\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtlcnJvci5yZXN1bHR9\"/>\n                            <L7p:VariableToSet stringValue=\"error_type\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"error_description.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"error_description_encoded\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"error.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"error_type_encoded\"/>\n                            <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"action denied\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"error\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"get the error message\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${hasSession}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"location\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"used with location header\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"ZXJyb3I9JHtlcnJvcl90eXBlX2VuY29kZWR9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb25fZW5jb2RlZH0meC1jYS1lcnI9JHtlcnJvci5jb2RlfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"path\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"fragment\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9IyR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"query\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9PyR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=query\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iZXJyb3IiIHZhbHVlPSIke2Vycm9yX3R5cGV9Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJlcnJvcl9kZXNjcmlwdGlvbiIgdmFsdWU9IiR7ZXJyb3JfZGVzY3JpcHRpb259Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ4LWNhLWVyciIgdmFsdWU9IiR7ZXJyb3IuY29kZX0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"response\"/>\n                                </L7p:SetVariable>\n                                <L7p:HardcodedResponse>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64ResponseBody stringValue=\"JHtyZXNwb25zZX0=\"/>\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n                                    <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                </L7p:HardcodedResponse>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=form_post\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"location\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"build location\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${authorizeStateDecoded}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtsb2NhdGlvbn0mc3RhdGU9JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"location\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"state\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"add state parameter if sent in request message\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Redirect\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Location\"/>\n                            <L7p:HeaderValue stringValue=\"${location}\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"html\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"used with html response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                            <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                            <L7p:RemoveExisting booleanValue=\"true\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"HTML\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"302, html\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Respond wih redirect or html page\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"cancel\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Login process was cancelled\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${action}\"/>\n                    <L7p:Expression2 stringValue=\"reset\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"reset\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"false\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:HtmlFormDataAssertion>\n                        <L7p:AllowGet booleanValue=\"true\"/>\n                        <L7p:AllowPost booleanValue=\"true\"/>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"true\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionData\"/>\n                            </L7p:item>\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionID\"/>\n                            </L7p:item>\n                        </L7p:FieldSpecs>\n                    </L7p:HtmlFormDataAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Parameters\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8d06714c-d54c-48e5-a454-e3c036b67f98\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Delete\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8d06714c-d54c-48e5-a454-e3c036b67f98\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Delete\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"socialLoginAuthorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"d6df06ff-8172-4861-bba5-ade8f27bd870\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Cache Flush\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheID\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"maxEntryAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"remove session from DB and flush cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"delete session if exists\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${newContent}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"reset\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"200\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64ResponseBody stringValue=\"JHtjb250ZW50fQ==\"/>\n                    <L7p:ResponseContentType stringValue=\"${content-type}\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Set-Cookie\"/>\n                    <L7p:HeaderValue stringValue=\"${cookieName}=; Expires=Thu, 01-Jan-1970 00:00:01 GMT; Path=/; Secure; HttpOnly\"/>\n                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"reset\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Login page displayed wrong name\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${action}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"action but no session\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"action, no session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Invalid combination of parameters was used\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${action}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"no action but session\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no action, session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Invalid combination of parameters was used\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"parameters\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"wrong parameter combination\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Something went totally wrong!\"/>\n                        </L7p:AuditDetailAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${error.code}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3001\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3001\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"000\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"unknown\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"something unknown happened\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"error type\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Unknown action\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Tasks\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>"
  }
}