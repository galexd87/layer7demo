{
  "goid": "e73aa375c92bf77a0b52a366672b0306",
  "guid": "28f5aff6-0942-4ecb-9b48-4fb7da86818b",
  "name": "auth/oauth/v2/authorize/consent",
  "resolutionPath": "/auth/oauth/v2/authorize/consent",
  "serviceType": "WEB_API",
  "checksum": "1a774f6cd0ba5387f9eb24e0499e000d0802346a",
  "enabled": true,
  "folderPath": "/OTK/Server/DMZ/OAuth 2.0/AuthorizationServer",
  "methodsAllowed": [
    "GET",
    "POST",
    "PUT",
    "PATCH",
    "DELETE",
    "HEAD",
    "OPTIONS",
    "OTHER"
  ],
  "tracingEnabled": false,
  "wssProcessingEnabled": false,
  "laxResolution": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== *** THIS POLICY IS OVERWRITTEN DURING AN UPGRADE ***\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== Be aware that custom configuration made in this policy is overwritten during a solution kit upgrade.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== However, the older version of the policy is kept in the history and can be referenced.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"=== After upgrade, manually merge customizations from the old version of the policy to the new version.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"This policy issues an authorization grant or an token for 'token' response_type\"/>\n        </L7p:CommentAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${gateway.otk.enable_auditing}\"/>\n                <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:AuditAssertion/>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Audit the service policy execution\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:CustomizeErrorResponse>\n            <L7p:Content stringValue=\"${error.msg}\"/>\n            <L7p:ContentType stringValue=\"${content-type}\"/>\n            <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Cache-Control\"/>\n                    <L7p:Value stringValue=\"no-store\"/>\n                </L7p:item>\n                <L7p:item nameValuePair=\"included\">\n                    <L7p:Key stringValue=\"Pragma\"/>\n                    <L7p:Value stringValue=\"no-cache\"/>\n                </L7p:item>\n            </L7p:ExtraHeaders>\n            <L7p:HttpStatus stringValue=\"${status}\"/>\n        </L7p:CustomizeErrorResponse>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbbc4f7d-cd06-41f3-8011-695bfad1d80b\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Configuration\"/>\n        </L7p:Encapsulated>\n        <L7p:Include>\n            <L7p:PolicyGuid stringValue=\"9f29a8bd-912e-40a5-a48c-3b6f8aa40ac6\"/>\n            <L7p:PolicyName stringValue=\"OTK Security Header Extension\"/>\n        </L7p:Include>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:AddHeader>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"HTTPS only\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Inform the browser to only accept SSL connections\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:HeaderName stringValue=\"Content-Security-Policy\"/>\n                <L7p:HeaderValue stringValue=\"default-src 'self'; script-src 'unsafe-inline'; img-src * data:; style-src 'unsafe-inline'; font-src * data:; require-trusted-types-for 'script'; object-src 'none';\"/>\n                <L7p:RemoveExisting booleanValue=\"true\"/>\n                <L7p:Target target=\"RESPONSE\"/>\n            </L7p:AddHeader>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Override OTK Security Header Extension\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"initialize\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"will be overridden in the case of an error\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"\"/>\n            <L7p:VariableToSet stringValue=\"error.code\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"initialize\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"will be overridden in the case of an error\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"\"/>\n            <L7p:VariableToSet stringValue=\"error.msg\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFjdGlvbn0=\"/>\n            <L7p:VariableToSet stringValue=\"action\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25JRH0=\"/>\n            <L7p:VariableToSet stringValue=\"sessionID\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25EYXRhfQ==\"/>\n            <L7p:VariableToSet stringValue=\"sessionDataJWT\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"2be8eaf2-9b42-4173-ace9-3fdb471fb407\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"API XSS Protection\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"allinput\"/>\n                        <L7p:value stringValue=\"${request.mainpart}${request.url}\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"json response\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"return json error response\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:FalseAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"return false\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"stop processing the whole policy\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                </L7p:FalseAssertion>\n            </wsp:All>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"API-ID 3002\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"47f768f4-b478-472b-a1ee-10f4b6e76f99\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Require SSL (with Client Certificate)\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"3002\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"requireClientCert\"/>\n                        <L7p:value stringValue=\"false\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"SSL\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Require SSL\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"POST\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b8822449-71ff-455b-8f10-39122e6c549b\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK HTTP Method Validation\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"method\"/>\n                        <L7p:value stringValue=\"POST\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"${error.msg}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Method\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Checking the HTTP method\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:HtmlFormDataAssertion>\n                    <L7p:AllowGet booleanValue=\"true\"/>\n                    <L7p:AllowPost booleanValue=\"true\"/>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"success\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                        <L7p:item htmlFormFieldSpec=\"included\">\n                            <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                            <L7p:DataType fieldDataType=\"any\"/>\n                            <L7p:MaxOccurs intValue=\"1\"/>\n                            <L7p:MinOccurs intValue=\"1\"/>\n                            <L7p:Name stringValue=\"action\"/>\n                        </L7p:item>\n                        <L7p:item htmlFormFieldSpec=\"included\">\n                            <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                            <L7p:DataType fieldDataType=\"any\"/>\n                            <L7p:MaxOccurs intValue=\"1\"/>\n                            <L7p:MinOccurs intValue=\"1\"/>\n                            <L7p:Name stringValue=\"sessionID\"/>\n                        </L7p:item>\n                    </L7p:FieldSpecs>\n                </L7p:HtmlFormDataAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAuaGVhZGVydmFsdWVzLm1hZy1pZGVudGlmaWVyfEBAfSMj\"/>\n                    <L7p:VariableToSet stringValue=\"requestHeaders\"/>\n                </L7p:SetVariable>\n                <L7p:Regex>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Presence of '@@' indicates duplicate parameters\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"requestHeaders\"/>\n                    <L7p:ProceedIfPatternMatches booleanValue=\"false\"/>\n                    <L7p:Regex stringValue=\"[@]{2}|[,]\"/>\n                    <L7p:Replacement stringValue=\"\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"success\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:OneOrMore wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"103\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"API-ID 3002\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"apiPrefix\"/>\n                            <L7p:value stringValue=\"3002\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"givenErrorCode\"/>\n                            <L7p:value stringValue=\"103\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"content\"/>\n                                <L7p:value stringValue=\"${errorDetail}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"error.content\"/>\n                                <L7p:value stringValue=\"${error.msg}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"new.content\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:AddHeader>\n                        <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                        <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                        <L7p:RemoveExisting booleanValue=\"true\"/>\n                        <L7p:Target target=\"RESPONSE\"/>\n                    </L7p:AddHeader>\n                    <L7p:FalseAssertion/>\n                </wsp:All>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"get the error message\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:OneOrMore>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Parameters\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${action}\"/>\n                    <L7p:Expression2 stringValue=\"consent\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"consent\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:HtmlFormDataAssertion>\n                        <L7p:AllowPost booleanValue=\"true\"/>\n                        <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionData\"/>\n                            </L7p:item>\n                        </L7p:FieldSpecs>\n                    </L7p:HtmlFormDataAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Parameters\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"sessionID\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Make sure the session is still available\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                            <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:DecodeJsonWebToken>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"decrypt\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:SignatureSecret stringValue=\"${otk_session_secret_encryption}\"/>\n                            <L7p:SourcePayload stringValue=\"${sessionDataJWT}\"/>\n                            <L7p:TargetVariablePrefix stringValue=\"sessionData\"/>\n                            <L7p:ValidationType stringValue=\"Using Secret\"/>\n                        </L7p:DecodeJsonWebToken>\n                        <L7p:DecodeJsonWebToken>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"validate signature\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:SignatureSecret stringValue=\"${otk_session_secret}\"/>\n                            <L7p:SourcePayload stringValue=\"${sessionData.plaintext}\"/>\n                            <L7p:TargetVariablePrefix stringValue=\"sessionData\"/>\n                            <L7p:ValidationType stringValue=\"Using Secret\"/>\n                        </L7p:DecodeJsonWebToken>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Verify the signature validation result\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${sessionData.valid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uRGF0YS5wYXlsb2FkfQ==\"/>\n                            <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"sessionData\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.sessionID\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"sessionIDJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.exp\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"expJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.current_username\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"resourceOwnerJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                            <L7p:Expression2 stringValue=\"${sessionIDJWT.result}\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"${sessionIDJWT.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${expJWT.result}\"/>\n                            <L7p:Expression2 stringValue=\"${gateway.time.seconds}\"/>\n                            <L7p:Operator operator=\"GE\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"${gateway.time.seconds}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${resourceOwnerJWT.result}\"/>\n                            <L7p:Expression2 stringValue=\"none\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.client_id\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_param.client_id\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.prompt\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_param.prompt\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_consent.client_name\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"clientNameJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_consent.scope_verified\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"scopeJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_consent.resource_verified\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"resourceJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.resource\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"requestedResource\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.logo_uri\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_logo_uri\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X2xvZ29fdXJpLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"logo_uri\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"clientNameJWT.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"client_name\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"scopeJWT.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"scope\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"resourceJWT.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"resource\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uRGF0YS5tYWlucGFydH0=\"/>\n                            <L7p:VariableToSet stringValue=\"sessionData\"/>\n                        </L7p:SetVariable>\n                        <L7p:Regex>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"updating the sessionData to include an active consent\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Regex stringValue=\"current_user_consent&quot;:[\\s]?&quot;none&quot;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"current_user_consent&quot;:&quot;requested&quot;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:EncodeJsonWebToken>\n                            <L7p:ContentEncryptionAlgorithm stringValue=\"A128CBC-HS256\"/>\n                            <L7p:EncryptPayload booleanValue=\"true\"/>\n                            <L7p:EncryptionSecret stringValue=\"${otk_session_secret_encryption}\"/>\n                            <L7p:KeyManagementAlgorithm stringValue=\"dir\"/>\n                            <L7p:SignPayload booleanValue=\"true\"/>\n                            <L7p:SignatureAlgorithm stringValue=\"HS256\"/>\n                            <L7p:SignatureSecretKey stringValue=\"${otk_session_secret}\"/>\n                            <L7p:SourceVariable stringValue=\"${sessionData}\"/>\n                            <L7p:TargetVariable stringValue=\"jwt_session\"/>\n                        </L7p:EncodeJsonWebToken>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtqd3Rfc2Vzc2lvbi5jb21wYWN0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"sessionDataJWT\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZU93bmVySldULnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"resource_owner\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access the values stored in the cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"isLogin\"/>\n                                    <L7p:value stringValue=\"false\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"other_for_consent\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"task\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"session data\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"check for valid session\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"content\"/>\n                            <L7p:value stringValue=\"${errorDetail}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"error.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"new.content\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"other\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"task\"/>\n                            <L7p:value stringValue=\"consent\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"200\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Base64ResponseBody stringValue=\"JHtjb250ZW50fQ==\"/>\n                    <L7p:ResponseContentType stringValue=\"${content-type}\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"consent\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Request consent screen after successful login at '.../authorize/login'\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${action}\"/>\n                    <L7p:Expression2 stringValue=\"grant\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"grant\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:HtmlFormDataAssertion>\n                        <L7p:AllowPost booleanValue=\"true\"/>\n                        <L7p:FieldSpecs htmlFormFieldSpecArray=\"included\">\n                            <L7p:item htmlFormFieldSpec=\"included\">\n                                <L7p:AllowEmpty boxedBooleanValue=\"false\"/>\n                                <L7p:DataType fieldDataType=\"any\"/>\n                                <L7p:MaxOccurs intValue=\"1\"/>\n                                <L7p:MinOccurs intValue=\"1\"/>\n                                <L7p:Name stringValue=\"sessionData\"/>\n                            </L7p:item>\n                        </L7p:FieldSpecs>\n                    </L7p:HtmlFormDataAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Parameters\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Check for duplicate parameters in the request\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"false\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:DecodeJsonWebToken>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"decrypt\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:SignatureSecret stringValue=\"${otk_session_secret_encryption}\"/>\n                            <L7p:SourcePayload stringValue=\"${sessionDataJWT}\"/>\n                            <L7p:TargetVariablePrefix stringValue=\"sessionData\"/>\n                            <L7p:ValidationType stringValue=\"Using Secret\"/>\n                        </L7p:DecodeJsonWebToken>\n                        <L7p:DecodeJsonWebToken>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"validate signature\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:SignatureSecret stringValue=\"${otk_session_secret}\"/>\n                            <L7p:SourcePayload stringValue=\"${sessionData.plaintext}\"/>\n                            <L7p:TargetVariablePrefix stringValue=\"sessionData\"/>\n                            <L7p:ValidationType stringValue=\"Using Secret\"/>\n                        </L7p:DecodeJsonWebToken>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Verify the signature validation result\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${sessionData.valid}\"/>\n                            <L7p:Expression2 stringValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uRGF0YS5wYXlsb2FkfQ==\"/>\n                            <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"sessionData\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.sessionID\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"sessionIDJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.exp\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"expJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.current_username\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"resourceOwnerJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.current_user_consent\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"consentJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                            <L7p:Expression2 stringValue=\"${sessionIDJWT.result}\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"${sessionIDJWT.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${expJWT.result}\"/>\n                            <L7p:Expression2 stringValue=\"${gateway.time.seconds}\"/>\n                            <L7p:Operator operator=\"GE\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"${gateway.time.seconds}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${resourceOwnerJWT.result}\"/>\n                            <L7p:Expression2 stringValue=\"none\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"none\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"consent\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"'active' if the user had an active oauth session, 'requested' if consent was requested\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${consentJWT.result}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item regex=\"included\">\n                                    <L7p:Pattern stringValue=\"active|requested\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZU93bmVySldULnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"resource_owner\"/>\n                        </L7p:SetVariable>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.salt\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"salt\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.current_user_acr\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"current.user.acr\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"current.user.acr.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"current.user.acr.result\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.current_user_authTime\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"current.user.authTime\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.current_user_consent\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"consentJWT\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.third_party_sso_token\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"third_party_sso_token\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"session.third_party_sso_token_type\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"third_party_sso_token_type\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.max_age\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_param.max_age\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:EvaluateJsonPathExpression>\n                            <L7p:Expression stringValue=\"request_parameters.resource\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionData\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                            <L7p:VariablePrefix stringValue=\"request_param.resource\"/>\n                        </L7p:EvaluateJsonPathExpression>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0X3BhcmFtLm1heF9hZ2UucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"max_age\"/>\n                        </L7p:SetVariable>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                            <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"decoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:Regex>\n                                <L7p:AutoTarget booleanValue=\"false\"/>\n                                <L7p:FindAll booleanValue=\"true\"/>\n                                <L7p:IncludeEntireExpressionCapture booleanValue=\"false\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"decoded\"/>\n                                <L7p:Regex stringValue=\"&amp;\"/>\n                                <L7p:Replace booleanValue=\"true\"/>\n                                <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:Regex>\n                            <L7p:TrueAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// escape &amp;\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtkZWNvZGVkfQ==\"/>\n                            <L7p:ContentType stringValue=\"text/xml;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"grantedContent\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientName\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/clientName/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientIdent\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_ident/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientID\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_id/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeRedirectURI\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/redirect_uri/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"authorizeRedirectURI.result\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeGivenRedirectURI\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/given_redirect_uri\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"authorizeGivenRedirectURI.result\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeResponseType\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/response_type/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeResponseMode\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/response_mode\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientType\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_type/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientCustom\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_custom\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientKeyCustom\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_key_custom\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeScope\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/scope/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeResource\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/resource/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeState\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/state\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeOidcNonce\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/oidcNonce\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeCodeChallenge\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/codeChallenge\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeCodeChallengeMethod\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/codeChallengeMethod\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"authorizeMagIdentifier\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/expected_mag_identifier\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"authorizeDeviceUserDomain\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/expected_device_user_domain\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"authorizeDeviceUser\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/expected_device_user\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeClientName.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeClientNameDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeClientIdent.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeClientIdentDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeClientID.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeClientIDDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeRedirectURI.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeRedirectURIDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeResponseType.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeResponseTypeDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeResponseMode.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeResponseModeDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeScope.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeScopeDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeResource.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeResourceDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9\"/>\n                            <L7p:VariableToSet stringValue=\"state\"/>\n                        </L7p:SetVariable>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"state\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeStateDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDbGllbnRUeXBlLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"authorizeClientTypeDecoded\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDbGllbnRDdXN0b20ucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"authorizeClientCustomDecoded\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDbGllbnRLZXlDdXN0b20ucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"authorizeClientKeyCustomDecoded\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVPaWRjTm9uY2UucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"oidcNonce\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDb2RlQ2hhbGxlbmdlLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"authorizeCodeChallenge\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDb2RlQ2hhbGxlbmdlTWV0aG9kLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"authorizeCodeChallengeMethod\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVNYWdJZGVudGlmaWVyLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"expected-mag-identifier\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVEZXZpY2VVc2VyRG9tYWluLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"expected-device-user-domain\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Mobile SSO\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVEZXZpY2VVc2VyLnJlc3VsdH0=\"/>\n                            <L7p:VariableToSet stringValue=\"expected-device-user\"/>\n                        </L7p:SetVariable>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8d06714c-d54c-48e5-a454-e3c036b67f98\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Delete\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxEntries\"/>\n                                    <L7p:value stringValue=\"10000\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheMaxSize\"/>\n                                    <L7p:value stringValue=\"10000\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"success\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access the values stored in the cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"session data\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Get granted values\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:CommentAssertion>\n                    <L7p:Comment stringValue=\"=== Verify that the authenticated user is the expected one for the device\"/>\n                </L7p:CommentAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"No device given\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${expected-mag-identifier}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:ComparisonAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"No user expected\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"In a multi user scenario any user can use the device\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${expected-device-user}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:Regex>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"SocialLogin\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Typical case would be something like: 'facebook-MyFacebookName'\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:AutoTarget booleanValue=\"false\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"resource_owner\"/>\n                        <L7p:PatternContainsVariables booleanValue=\"true\"/>\n                        <L7p:Regex stringValue=\"${expected-device-user-domain}.?${expected-device-user}\"/>\n                        <L7p:Replacement stringValue=\"\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:Regex>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"Mobile SSO\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"error.code\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${max_age}\"/>\n                            <L7p:Expression2 stringValue=\"0\"/>\n                            <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXIuYXV0aFRpbWUucmVzdWx0fQ==\"/>\n                            <L7p:DataType variableDataType=\"dateTime\"/>\n                            <L7p:DateOffsetExpression stringValue=\"${max_age}\"/>\n                            <L7p:VariableToSet stringValue=\"time_limit\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtnYXRld2F5LnRpbWUuc2Vjb25kc30=\"/>\n                            <L7p:DataType variableDataType=\"dateTime\"/>\n                            <L7p:DateOffsetExpression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"current_time\"/>\n                        </L7p:SetVariable>\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${time_limit}\"/>\n                            <L7p:ExpressionIsVariable booleanValue=\"false\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"dateTime\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"LT\"/>\n                                    <L7p:RightValue stringValue=\"${current_time}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtjdXJyZW50X3RpbWUuc2Vjb25kc30=\"/>\n                            <L7p:VariableToSet stringValue=\"current.user.authTime.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"max_age was passed, auth_time set to current time\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"set auth_time in accordance to max_age\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item regex=\"included\">\n                                    <L7p:Pattern stringValue=\"query.jwt|fragment.jwt|form_post.jwt\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"isJwtResponseMode\"/>\n                        </L7p:SetVariable>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                        <L7p:VariableToSet stringValue=\"isJwtResponseMode\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"is jwt response mode active?\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjdXJyZW50LnVzZXIuYWNyLnJlc3VsdH0=\"/>\n                    <L7p:VariableToSet stringValue=\"acr\"/>\n                </L7p:SetVariable>\n                <L7p:Include>\n                    <L7p:PolicyGuid stringValue=\"b17f391d-6e8a-4bb7-8411-2de47657e8fb\"/>\n                    <L7p:PolicyName stringValue=\"#OTK Token Rank\"/>\n                </L7p:Include>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"code\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"code\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${expected-mag-identifier}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzYWx0fSR7ZXhwZWN0ZWQtZGV2aWNlLWlkZW50aWZpZXJ9\"/>\n                                    <L7p:VariableToSet stringValue=\"salt\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtzYWx0fSR7YXV0aG9yaXplQ2xpZW50SUREZWNvZGVkfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"salt\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Salt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Use the mag-identifier to generate 'salt' if it exists, the client_id otherwise!\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;authorization_code&quot;,&quot;code_challenge&quot;: &quot;${authorizeCodeChallenge}&quot;,&quot;code_challenge_method&quot;: &quot;${authorizeCodeChallengeMethod}&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"31fe6887-927d-4f26-9bd7-cfd98fa3281c\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=CODE\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"acr\"/>\n                                    <L7p:value stringValue=\"${current.user.acr.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"authTime\"/>\n                                    <L7p:value stringValue=\"${current.user.authTime.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"expected-mag-identifier\"/>\n                                    <L7p:value stringValue=\"${expected-mag-identifier}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max_age\"/>\n                                    <L7p:value stringValue=\"${max_age}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${oidcNonce}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"salt\"/>\n                                    <L7p:value stringValue=\"${salt.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token_type\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token_type.result}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=code\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"token\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"token\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;implicit&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"192bf141-6a60-4108-a56c-84abf7c136fe\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=TOKEN\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"token_status\"/>\n                                    <L7p:value stringValue=\"ENABLED\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item regex=\"included\">\n                                    <L7p:Pattern stringValue=\"(token.id_token)|(id_token.token)\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;implicit&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"2dd2c0ca-6d4f-49fc-8b0a-eae14c10a940\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=TOKEN ID_TOKEN\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"acr\"/>\n                                    <L7p:value stringValue=\"${current.user.acr.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"authTime\"/>\n                                    <L7p:value stringValue=\"${current.user.authTime.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"azp\"/>\n                                    <L7p:value stringValue=\"${authorizeClientID.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${oidcNonce}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"salt\"/>\n                                    <L7p:value stringValue=\"${salt}${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"State\"/>\n                                    <L7p:value stringValue=\"${authorizeStateDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token_type\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token_type.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"token_status\"/>\n                                    <L7p:value stringValue=\"ENABLED\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=token id_token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item regex=\"included\">\n                                    <L7p:Pattern stringValue=\"(code.id_token)|(id_token.code)\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;authorization_code, implicit&quot;,&quot;code_challenge&quot;: &quot;${authorizeCodeChallenge}&quot;,&quot;code_challenge_method&quot;: &quot;${authorizeCodeChallengeMethod}&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"e29dee85-31ea-4631-afa3-a98e12ae458d\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=CODE ID_TOKEN\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"acr\"/>\n                                    <L7p:value stringValue=\"${current.user.acr.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"authTime\"/>\n                                    <L7p:value stringValue=\"${current.user.authTime.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"azp\"/>\n                                    <L7p:value stringValue=\"${authorizeClientID.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${oidcNonce}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"salt\"/>\n                                    <L7p:value stringValue=\"${salt}${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"state\"/>\n                                    <L7p:value stringValue=\"${authorizeStateDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token_type\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token_type.result}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=code id_token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"id_token\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"id_token\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;implicit&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"a3cf6e14-921d-4706-8df2-0077fa4d9033\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=ID_TOKEN\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"acr\"/>\n                                    <L7p:value stringValue=\"${current.user.acr.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"authTime\"/>\n                                    <L7p:value stringValue=\"${current.user.authTime.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"azp\"/>\n                                    <L7p:value stringValue=\"${authorizeClientID.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${oidcNonce}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"salt\"/>\n                                    <L7p:value stringValue=\"${salt}${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"State\"/>\n                                    <L7p:value stringValue=\"${authorizeStateDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token_type\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token_type.result}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=id_token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"code token\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"code token\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${expected-mag-identifier}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzYWx0fSR7ZXhwZWN0ZWQtZGV2aWNlLWlkZW50aWZpZXJ9\"/>\n                                    <L7p:VariableToSet stringValue=\"salt\"/>\n                                </L7p:SetVariable>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtzYWx0fSR7YXV0aG9yaXplQ2xpZW50SUREZWNvZGVkfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"salt\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Salt\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Use the mag-identifier to generate 'salt' if it exists, the client_id otherwise!\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;authorization_code&quot;,&quot;code_challenge&quot;: &quot;${authorizeCodeChallenge}&quot;,&quot;code_challenge_method&quot;: &quot;${authorizeCodeChallengeMethod}&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"db18acab-4fc2-4d0d-a25f-b7d27c5ee4be\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=CODE TOKEN\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"acr\"/>\n                                    <L7p:value stringValue=\"${current.user.acr.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"authTime\"/>\n                                    <L7p:value stringValue=\"${current.user.authTime.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"expected-mag-identifier\"/>\n                                    <L7p:value stringValue=\"${expected-mag-identifier}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max_age\"/>\n                                    <L7p:value stringValue=\"${max_age}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${oidcNonce}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"salt\"/>\n                                    <L7p:value stringValue=\"${salt.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token_type\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token_type.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"token_status\"/>\n                                    <L7p:value stringValue=\"ENABLED\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=code token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item regex=\"included\">\n                                    <L7p:Pattern stringValue=\"(code.id_token.token)|(code.token.id_token)|(id_token.code.token)|(id_token.token.code)|(token.id_token.code)|(token.code.id_token)\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df04db76-9431-40b2-872f-dd0ab9727d19\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session Tracking\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"clientkey\"/>\n                                    <L7p:value stringValue=\"{&quot;client_custom&quot;: ${authorizeClientCustomDecoded},&quot;client_key_custom&quot;: ${authorizeClientKeyCustomDecoded}}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"current_input\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"customer\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"mag\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"otk\"/>\n                                    <L7p:value stringValue=\"{&quot;client_type&quot;: &quot;${authorizeClientTypeDecoded}&quot;,&quot;grant_type&quot;: &quot;authorization_code, implicit&quot;,&quot;code_challenge&quot;: &quot;${authorizeCodeChallenge}&quot;,&quot;code_challenge_method&quot;: &quot;${authorizeCodeChallengeMethod}&quot;}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"portal\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"df451c36-c915-4faa-af40-9e9f7aa5ddc2\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK response_type=CODE ID_TOKEN TOKEN\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"acr\"/>\n                                    <L7p:value stringValue=\"${current.user.acr.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"authTime\"/>\n                                    <L7p:value stringValue=\"${current.user.authTime.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"azp\"/>\n                                    <L7p:value stringValue=\"${authorizeClientID.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIdentDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_key\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"client_name\"/>\n                                    <L7p:value stringValue=\"${authorizeClientNameDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"custom\"/>\n                                    <L7p:value stringValue=\"${session_output}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"expected-mag-identifier\"/>\n                                    <L7p:value stringValue=\"${expected-mag-identifier}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max_age\"/>\n                                    <L7p:value stringValue=\"${max_age}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"nonce\"/>\n                                    <L7p:value stringValue=\"${oidcNonce}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"redirect_uri\"/>\n                                    <L7p:value stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"${authorizeResourceDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"resource_owner\"/>\n                                    <L7p:value stringValue=\"${resource_owner}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"response_mode\"/>\n                                    <L7p:value stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"salt\"/>\n                                    <L7p:value stringValue=\"${salt}${authorizeClientIDDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"scope\"/>\n                                    <L7p:value stringValue=\"${authorizeScopeDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"State\"/>\n                                    <L7p:value stringValue=\"${authorizeStateDecoded}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"third_party_sso_token_type\"/>\n                                    <L7p:value stringValue=\"${third_party_sso_token_type.result}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"token_status\"/>\n                                    <L7p:value stringValue=\"ENABLED\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Access was granted: response_type=code id_token token\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code is provide by response_type assertion, API-ID 3002\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"${error.code}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"response_type\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Decide whether to issue an access_token or an authorization_code\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeState.result}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"form_post\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtmb3JtUmVzcH0NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSINCiAgICAgdmFsdWU9IiR7YXV0aG9yaXplU3RhdGUucmVzdWx0fSIvPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"formResp\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// form_post\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${isJwtResponseMode}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RSZXNwfSwNCiJzdGF0ZSI6ICIke2F1dGhvcml6ZVN0YXRlRGVjb2RlZH0i\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtResp\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtsb2NhdGlvbn0mc3RhdGU9JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"location\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                    </wsp:All>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"add state parameter if sent in request message\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"code\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"code\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeScopeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"form_post\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtmb3JtUmVzcH0NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzY29wZSINCiAgICAgdmFsdWU9IiR7YXV0aG9yaXplU2NvcGUucmVzdWx0fSIvPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"formResp\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// form_post\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${isJwtResponseMode}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RSZXNwfSwNCiJzY29wZSI6ICIke2F1dGhvcml6ZVNjb3BlRGVjb2RlZH0i\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtResp\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtsb2NhdGlvbn0mc2NvcGU9JHthdXRob3JpemVTY29wZS5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"location\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                    </wsp:All>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"add scope parameter if sent in request message\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseTypeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"code\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"code\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${authorizeResourceDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"form_post\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtmb3JtUmVzcH0NCiAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJyZXNvdXJjZSINCiAgICAgdmFsdWU9IiR7YXV0aG9yaXplUmVzb3VyY2UucmVzdWx0fSIvPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"formResp\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// form_post\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${isJwtResponseMode}\"/>\n                                    <L7p:Expression2 stringValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RSZXNwfSwNCiJyZXNvdXJjZSI6ICIke2F1dGhvcml6ZVJlc291cmNlRGVjb2RlZH0i\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtResp\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtsb2NhdGlvbn0mcmVzb3VyY2U9JHthdXRob3JpemVSZXNvdXJjZS5yZXN1bHR9\"/>\n                                <L7p:VariableToSet stringValue=\"location\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                    </wsp:All>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"add resource parameter if sent in request message\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${isJwtResponseMode}\"/>\n                        <L7p:Operator operatorNull=\"null\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item dataType=\"included\">\n                                <L7p:Type variableDataType=\"string\"/>\n                            </L7p:item>\n                            <L7p:item binary=\"included\">\n                                <L7p:Negated booleanValue=\"true\"/>\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_id\"/>\n                                <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"client_key_custom\"/>\n                                <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"payload\"/>\n                                <L7p:value stringValue=\"${jwtResp}\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"compose jwt response if needed\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"form_post\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"PGh0bWw+DQogPGhlYWQ+PHRpdGxlPlN1Ym1pdCBUaGlzIEZvcm08L3RpdGxlPjwvaGVhZD4NCiA8Ym9keSBvbmxvYWQ9ImphdmFzY3JpcHQ6ZG9jdW1lbnQuZm9ybXNbMF0uc3VibWl0KCkiPiR7Zm9ybVJlc3B9DQogIDwvZm9ybT4NCiA8L2JvZHk+DQo8L2h0bWw+\"/>\n                            <L7p:VariableToSet stringValue=\"resp\"/>\n                        </L7p:SetVariable>\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"200\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Auto post form with parameters\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64ResponseBody stringValue=\"JHtyZXNwfQ==\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// form_post\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"form_post.jwt\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post.jwt\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ICA8Zm9ybSBtZXRob2Q9InBvc3QiIGFjdGlvbj0iJHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9Ij4=\"/>\n                            <L7p:VariableToSet stringValue=\"formResp\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"PGh0bWw+DQogPGhlYWQ+PHRpdGxlPlN1Ym1pdCBUaGlzIEZvcm08L3RpdGxlPjwvaGVhZD4NCiA8Ym9keSBvbmxvYWQ9ImphdmFzY3JpcHQ6ZG9jdW1lbnQuZm9ybXNbMF0uc3VibWl0KCkiPg0KICAke2Zvcm1SZXNwfQ0KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InJlc3BvbnNlIiB2YWx1ZT0iJHthdXRoel9yZXNwb25zZV9qd3R9Ii8+DQogIDwvZm9ybT4NCiA8L2JvZHk+DQo8L2h0bWw+\"/>\n                            <L7p:VariableToSet stringValue=\"resp\"/>\n                        </L7p:SetVariable>\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"200\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Auto post form with parameters\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64ResponseBody stringValue=\"JHtyZXNwfQ==\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// form_post.jwt\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"fragment.jwt\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"fragment.jwt\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9\"/>\n                            <L7p:VariableToSet stringValue=\"location\"/>\n                        </L7p:SetVariable>\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Redirect back to the client\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Location\"/>\n                            <L7p:HeaderValue stringValue=\"${location}#response=${authz_response_jwt}\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// fragment.jwt\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${authorizeResponseModeDecoded}\"/>\n                            <L7p:Expression2 stringValue=\"query.jwt\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"query.jwt\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9\"/>\n                            <L7p:VariableToSet stringValue=\"location\"/>\n                        </L7p:SetVariable>\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Redirect back to the client\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${location}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Location\"/>\n                                    <L7p:HeaderValue stringValue=\"${location}&amp;response=${authz_response_jwt}\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                            </wsp:All>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"Location\"/>\n                                <L7p:HeaderValue stringValue=\"${location}?response=${authz_response_jwt}\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// query.jwt\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:HardcodedResponse>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"302\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Redirect back to the client\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:ResponseContentType stringValue=\"text/html;charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Pragma\"/>\n                            <L7p:HeaderValue stringValue=\"no-cache\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                            <L7p:HeaderValue stringValue=\"no-store\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Location\"/>\n                            <L7p:HeaderValue stringValue=\"${location}\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"send request message\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:Expression1 stringValue=\"${error.code}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:AddHeader>\n                        <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                        <L7p:HeaderValue stringValue=\"3002${error.code}\"/>\n                        <L7p:RemoveExisting booleanValue=\"true\"/>\n                        <L7p:Target target=\"RESPONSE\"/>\n                    </L7p:AddHeader>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"check error.code\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"grant\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Access was granted\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${action}\"/>\n                    <L7p:Expression2 stringValue=\"deny\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"deny\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"false\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4e4bc164-3fa2-4b15-ba65-31cef45b84b0\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session GET\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheId\"/>\n                                    <L7p:value stringValue=\"authorizeCache\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheKey\"/>\n                                    <L7p:value stringValue=\"${sessionID}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"sessionValue\"/>\n                            <L7p:XmlMsgSrc stringValue=\"resp\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ns:found/ns:value/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"ns\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"sessionValue.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"decoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtkZWNvZGVkfQ==\"/>\n                            <L7p:ContentType stringValue=\"text/xml;charset=UTF-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"grantedContent\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"authorizeRedirectURI\"/>\n                                <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/authorize/redirect_uri/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"authorizeRedirectURI.result\"/>\n                            </L7p:SetVariable>\n                        </wsp:OneOrMore>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeState\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/state\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"xpathResponseMode\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/response_mode/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientID\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_id/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"authorizeClientKeyCustom\"/>\n                            <L7p:XmlMsgSrc stringValue=\"grantedContent\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/authorize/client_key_custom\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeRedirectURI.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeRedirectURIDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeState.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeStateDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"xpathResponseMode.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"response_mode\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:EncodeDecode>\n                            <L7p:SourceVariableName stringValue=\"authorizeClientID.result\"/>\n                            <L7p:TargetDataType variableDataType=\"string\"/>\n                            <L7p:TargetVariableName stringValue=\"authorizeClientIDDecoded\"/>\n                            <L7p:TransformType transformType=\"URL_DECODE\"/>\n                        </L7p:EncodeDecode>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVDbGllbnRLZXlDdXN0b20ucmVzdWx0fQ==\"/>\n                            <L7p:VariableToSet stringValue=\"authorizeClientKeyCustomDecoded\"/>\n                        </L7p:SetVariable>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"124\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"124\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvci5tc2d9\"/>\n                                    <L7p:ContentType stringValue=\"application/json;charset=UTF-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"jsonMsg\"/>\n                                </L7p:SetVariable>\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"error\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"error\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:EvaluateJsonPathExpression>\n                                    <L7p:Expression stringValue=\"error_description\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"jsonMsg\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                    <L7p:VariablePrefix stringValue=\"error_description\"/>\n                                </L7p:EvaluateJsonPathExpression>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"error.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"error_type_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:EncodeDecode>\n                                    <L7p:SourceVariableName stringValue=\"error_description.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n                                    <L7p:TargetVariableName stringValue=\"error_description_encoded\"/>\n                                    <L7p:TransformType transformType=\"URL_ENCODE\"/>\n                                </L7p:EncodeDecode>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvci5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"error_type\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtlcnJvcl9kZXNjcmlwdGlvbi5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"error_description\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ZXJyb3I9JHtlcnJvcl90eXBlX2VuY29kZWR9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb25fZW5jb2RlZH0meC1jYS1lcnI9JHtlcnJvci5jb2RlfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"path\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"ImVycm9yIjogIiR7ZXJyb3JfdHlwZX0iLA0KImVycm9yX2Rlc2NyaXB0aW9uIjogIiR7ZXJyb3JfZGVzY3JpcHRpb259IiwNCiJ4LWNhLWVyciI6ICIke2Vycm9yLmNvZGV9Ig==\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtError\"/>\n                                </L7p:SetVariable>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iZXJyb3IiIHZhbHVlPSIke2Vycm9yX3R5cGV9Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJlcnJvcl9kZXNjcmlwdGlvbiIgdmFsdWU9IiR7ZXJyb3JfZGVzY3JpcHRpb259Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ4LWNhLWVyciIgdmFsdWU9IiR7ZXJyb3IuY29kZX0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/html; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"form_resp_error\"/>\n                                </L7p:SetVariable>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${authorizeStateDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtwYXRofSZzdGF0ZT0ke2F1dGhvcml6ZVN0YXRlLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"path\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtqd3RFcnJvcn0sDQoic3RhdGUiOiAiJHthdXRob3JpemVTdGF0ZURlY29kZWR9Ig==\"/>\n                                    <L7p:VariableToSet stringValue=\"jwtError\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iZXJyb3IiIHZhbHVlPSIke2Vycm9yX3R5cGV9Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJlcnJvcl9kZXNjcmlwdGlvbiIgdmFsdWU9IiR7ZXJyb3JfZGVzY3JpcHRpb259Ii8+DQogICAgICAgICAgICA8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ4LWNhLWVyciIgdmFsdWU9IiR7ZXJyb3IuY29kZX0iLz4NCiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InN0YXRlIiB2YWx1ZT0iJHthdXRob3JpemVTdGF0ZS5yZXN1bHR9Ii8+DQogICAgICAgIDwvZm9ybT4NCiAgICA8L2JvZHk+DQo8L2h0bWw+\"/>\n                                    <L7p:ContentType stringValue=\"text/html; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"form_resp_error\"/>\n                                    </L7p:SetVariable>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"state\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"add state parameter if sent in request message\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"action denied\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"fragment\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9IyR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"query\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JiR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9PyR7cGF0aH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=query\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:HardcodedResponse>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64ResponseBody stringValue=\"JHtmb3JtX3Jlc3BfZXJyb3J9\"/>\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n                                    <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                </L7p:HardcodedResponse>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=form_post\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"fragment.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"#\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"#\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JnJlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new fragment or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9I3Jlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=fragment.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"query.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${authorizeRedirectURIDecoded}\"/>\n                                    <L7p:Expression2 stringValue=\"?\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n                                    <L7p:RightValue stringValue=\"?\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9JnJlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"send error as new query or attach to existing\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHthdXRob3JpemVSZWRpcmVjdFVSSURlY29kZWR9P3Jlc3BvbnNlPSR7YXV0aHpfcmVzcG9uc2Vfand0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"location\"/>\n                                    </L7p:SetVariable>\n                                </wsp:OneOrMore>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=query.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${response_mode}\"/>\n                                    <L7p:Operator operatorNull=\"null\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"string\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"form_post.jwt\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"0591cfc9-7ee3-4d8b-97e9-60cf3721dcf9\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Generate JWT Authorization Response\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_id\"/>\n                                    <L7p:value stringValue=\"${authorizeClientIDDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"client_key_custom\"/>\n                                    <L7p:value stringValue=\"${authorizeClientKeyCustomDecoded}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"payload\"/>\n                                    <L7p:value stringValue=\"${jwtError}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PGh0bWw+DQogICAgPGhlYWQ+DQogICAgICAgIDx0aXRsZT5FcnJvciBSZXNwb25zZTwvdGl0bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5IG9ubG9hZD0iamF2YXNjcmlwdDpkb2N1bWVudC5mb3Jtc1swXS5zdWJtaXQoKSI+DQogICAgICAgIDxmb3JtIG1ldGhvZD0icG9zdCIgYWN0aW9uPSIke2F1dGhvcml6ZVJlZGlyZWN0VVJJRGVjb2RlZH0iPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0icmVzcG9uc2UiIHZhbHVlPSIke2F1dGh6X3Jlc3BvbnNlX2p3dH0iLz4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvYm9keT4NCjwvaHRtbD4=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"response\"/>\n                                </L7p:SetVariable>\n                                <L7p:HardcodedResponse>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"400\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no redirect\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64ResponseBody stringValue=\"JHtyZXNwb25zZX0=\"/>\n                                    <L7p:EarlyResponse booleanValue=\"true\"/>\n                                    <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n                                    <L7p:ResponseStatus stringValue=\"400\"/>\n                                </L7p:HardcodedResponse>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"response_mode=form_post.jwt\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"location\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"build location\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"session lookup\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Get the redirect URI and state value\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error code is provide by authentication assertion, API-ID 3002\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"110\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:AddHeader>\n                                <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                <L7p:RemoveExisting booleanValue=\"true\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:AddHeader>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message, session has expired\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"302 or HTML\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Create the redirect location\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8d06714c-d54c-48e5-a454-e3c036b67f98\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Session - Delete\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${sessionIdCacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheId\"/>\n                            <L7p:value stringValue=\"authorizeCache\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheKey\"/>\n                            <L7p:value stringValue=\"${sessionID}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheMaxEntries\"/>\n                            <L7p:value stringValue=\"10000\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheMaxSize\"/>\n                            <L7p:value stringValue=\"10000\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:HardcodedResponse>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"302\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"Redirect\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:ResponseContentType stringValue=\"text/plain; charset=UTF-8\"/>\n                    <L7p:ResponseStatus stringValue=\"302\"/>\n                </L7p:HardcodedResponse>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Pragma\"/>\n                    <L7p:HeaderValue stringValue=\"no-cache\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Cache-Control\"/>\n                    <L7p:HeaderValue stringValue=\"no-store\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:AddHeader>\n                    <L7p:HeaderName stringValue=\"Location\"/>\n                    <L7p:HeaderValue stringValue=\"${location}\"/>\n                    <L7p:Target target=\"RESPONSE\"/>\n                </L7p:AddHeader>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"deny\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Access was denied\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${error.code}\"/>\n                    <L7p:Expression2 stringValue=\"\"/>\n                    <L7p:Operator operator=\"EMPTY\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:RightValue stringValue=\"\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${action}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"action but no session\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"action, no session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Invalid combination of parameters was used\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${sessionID}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${action}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:Detail stringValue=\"no action but session\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"no action, session\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"Invalid combination of parameters was used\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"103\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"parameters\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"wrong parameter combination\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:Detail stringValue=\"Something went totally wrong!\"/>\n                        </L7p:AuditDetailAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${error.code}\"/>\n                                <L7p:Expression2 stringValue=\"\"/>\n                                <L7p:Negate booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"000\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"API-ID 3002\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"apiPrefix\"/>\n                                    <L7p:value stringValue=\"3002\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"givenErrorCode\"/>\n                                    <L7p:value stringValue=\"000\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:Encapsulated>\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"09faa5d6-e22c-4d4d-812d-32603331c136\"/>\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Authorization Server Website Template\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"content\"/>\n                                    <L7p:value stringValue=\"${errorDetail}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"error.content\"/>\n                                    <L7p:value stringValue=\"${error.msg}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"new.content\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                </L7p:Encapsulated>\n                                <L7p:AddHeader>\n                                    <L7p:HeaderName stringValue=\"x-ca-err\"/>\n                                    <L7p:HeaderValue stringValue=\"${error.code}\"/>\n                                    <L7p:RemoveExisting booleanValue=\"true\"/>\n                                    <L7p:Target target=\"RESPONSE\"/>\n                                </L7p:AddHeader>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"error\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"get the error message\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                    <L7p:value stringValue=\"unknown\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"something unknown happened\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                                <L7p:value stringValue=\"error type\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"error\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"Unknown action\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"Tasks\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>"
  }
}