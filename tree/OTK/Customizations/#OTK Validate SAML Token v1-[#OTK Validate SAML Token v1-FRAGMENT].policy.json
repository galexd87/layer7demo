{
  "goid": "63d1084dbcdad00797aef0f6a3c4097a",
  "guid": "992c95a1-c4d4-47e1-9097-5707f4aa595e",
  "name": "#OTK Validate SAML Token v1",
  "policyType": "FRAGMENT",
  "checksum": "8c9c2c12cb5c8fcb9225130ffcd193cf12582e08",
  "folderPath": "/OTK/Customizations",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"== Target Policy:  &quot;OTK grant_type=TOKEN_EXCHANGE&quot;\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"========== Validate the SAML Token v1 ======================\"/>\n        </L7p:CommentAssertion>\n        <L7p:ValidateNonSoapSamlToken>\n            <L7p:AudienceRestriction stringValue=\"${conditions}\"/>\n            <L7p:AuthenticationStatement samlAuthenticationInfo=\"included\">\n                <L7p:AuthenticationMethods stringArrayValue=\"included\">\n                    <L7p:item stringValue=\"urn:ietf:rfc:1510\"/>\n                    <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.0:am:unspecified\"/>\n                    <L7p:item stringValue=\"urn:ietf:rfc:2246\"/>\n                    <L7p:item stringValue=\"urn:ietf:rfc:2945\"/>\n                    <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.0:am:PGP\"/>\n                    <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.0:am:SPKI\"/>\n                    <L7p:item stringValue=\"urn:ietf:rfc:3075\"/>\n                    <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.0:am:X509-PKI\"/>\n                    <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.0:am:password\"/>\n                </L7p:AuthenticationMethods>\n            </L7p:AuthenticationStatement>\n            <L7p:MaxExpiry longValue=\"3600000\"/>\n            <L7p:NameFormats stringArrayValue=\"included\">\n                <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\"/>\n            </L7p:NameFormats>\n            <L7p:NameQualifier stringValue=\"\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"bearerToken\"/>\n            <L7p:SubjectConfirmationDataCheckValidity booleanValue=\"false\"/>\n            <L7p:SubjectConfirmations stringArrayValue=\"included\">\n                <L7p:item stringValue=\"urn:oasis:names:tc:SAML:1.0:cm:bearer\"/>\n            </L7p:SubjectConfirmations>\n            <L7p:Target target=\"OTHER\"/>\n            <L7p:Version boxedIntegerValue=\"1\"/>\n        </L7p:ValidateNonSoapSamlToken>\n        <L7p:ResponseXpathAssertion>\n            <L7p:VariablePrefix stringValue=\"\"/>\n            <L7p:XmlMsgSrc stringValue=\"bearerToken\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/saml:Assertion/saml:AuthenticationStatement/saml:Subject/saml:NameIdentifier\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"saml\"/>\n                        <L7p:value stringValue=\"urn:oasis:names:tc:SAML:1.0:assertion\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0=\"/>\n            <L7p:VariableToSet stringValue=\"owner\"/>\n        </L7p:SetVariable>\n    </wsp:All>\n</wsp:Policy>"
  }
}