{
  "goid": "bc9a31b7578652a08a514d7d4fef3147",
  "guid": "59b9ada1-ac0f-4e8d-a6d4-ddb7544e9eca",
  "name": "OTK grant_type=SAML Authentication",
  "policyType": "FRAGMENT",
  "checksum": "11befa018b7ac14f2de9dd6982b4d50e6de02f07",
  "folderPath": "/OTK/Customizations/grant_types",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"== Target Policy:  &quot;OTK grant_type=SAML&quot;\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"============================\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"========== Validate the trusted issuer by adding a FIP here ==========\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"A FIP has to be introduced in order to accept only trusted clients\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Remove the Stop assertion once the FIP is configured\"/>\n        </L7p:CommentAssertion>\n        <L7p:FalseAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                        <L7p:value stringValue=\"WARNING\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"Replace this assertion with a federated identity assertion. Do not just delete it!\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n        </L7p:FalseAssertion>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtiZWFyZXJUb2tlbi5tYWlucGFydH0=\"/>\n            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"bearerToken\"/>\n        </L7p:SetVariable>\n        <L7p:ResponseXpathAssertion>\n            <L7p:VariablePrefix stringValue=\"\"/>\n            <L7p:XmlMsgSrc stringValue=\"bearerToken\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"count(//saml2:Assertion)=1\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"s\"/>\n                        <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"saml2\"/>\n                        <L7p:value stringValue=\"urn:oasis:names:tc:SAML:2.0:assertion\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"ds\"/>\n                        <L7p:value stringValue=\"http://www.w3.org/2000/09/xmldsig#\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n    </wsp:All>\n</wsp:Policy>"
  }
}