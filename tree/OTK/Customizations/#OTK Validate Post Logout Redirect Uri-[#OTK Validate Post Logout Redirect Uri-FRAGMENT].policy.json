{
  "goid": "3f141c8de28fbc75498b7cf16cd057c1",
  "guid": "f52072e3-0294-47e6-abcc-c55e5eadf440",
  "name": "#OTK Validate Post Logout Redirect Uri",
  "policyType": "FRAGMENT",
  "checksum": "0cc2357392fc5087ac5383bb2b8ec9a727219a87",
  "folderPath": "/OTK/Customizations",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Policy Fragment: # OTK Validate Post Logout Redirect Uri\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Customize this policy to validate request post logout redirect uri\"/>\n        </L7p:CommentAssertion>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// select the client key custom\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"xpathClientKeyCustom\"/>\n            <L7p:XmlMsgSrc stringValue=\"client_resp\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/ns:values/ns:keys/ns:values/ns:value/ns:client_key_custom\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"ns\"/>\n                        <L7p:value stringValue=\"http://ns.l7tech.com/2012/11/otk-clientstore\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"s\"/>\n                        <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHt4cGF0aENsaWVudEtleUN1c3RvbS5yZXN1bHR9\"/>\n            <L7p:ContentType stringValue=\"application/json; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"clientKeyCustom\"/>\n        </L7p:SetVariable>\n        <L7p:EvaluateJsonPathExpression>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// post_logout_redirect_uris(s) exist?\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Expression stringValue=\"$..response.post_logout_redirect_uris\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"clientKeyCustom\"/>\n            <L7p:Target target=\"OTHER\"/>\n            <L7p:VariablePrefix stringValue=\"post_logout_redirect_uris\"/>\n        </L7p:EvaluateJsonPathExpression>\n        <L7p:ComparisonAssertion>\n            <L7p:CaseSensitive booleanValue=\"false\"/>\n            <L7p:Expression1 stringValue=\"${post_logout_redirect_uris.results}\"/>\n            <L7p:Expression2 stringValue=\"${req_post_logout_redirect_uri}\"/>\n            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n            <L7p:Predicates predicates=\"included\">\n                <L7p:item binary=\"included\">\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:RightValue stringValue=\"${req_post_logout_redirect_uri}\"/>\n                </L7p:item>\n            </L7p:Predicates>\n        </L7p:ComparisonAssertion>\n    </wsp:All>\n</wsp:Policy>"
  }
}