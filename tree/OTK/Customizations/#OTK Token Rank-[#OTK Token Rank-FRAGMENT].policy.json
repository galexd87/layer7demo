{
  "goid": "3acf249dd6767f64a5a1ac9e513f6411",
  "guid": "b17f391d-6e8a-4bb7-8411-2de47657e8fb",
  "name": "#OTK Token Rank",
  "policyType": "FRAGMENT",
  "checksum": "735d44884a47210a88e4b1d1b487479b22b390e5",
  "folderPath": "/OTK/Customizations",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Policy Fragment: #OTK Token Rank\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"This policy is used for mapping authentication metadata like acr to token rank\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"The example in disabled block calculates token_rank based on the acr value\"/>\n        </L7p:CommentAssertion>\n        <wsp:OneOrMore L7p:Enabled=\"false\" wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${acr}\"/>\n                    <L7p:Expression2 stringValue=\"0\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"0\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"MA==\"/>\n                    <L7p:DataType variableDataType=\"int\"/>\n                    <L7p:VariableToSet stringValue=\"token_rank\"/>\n                </L7p:SetVariable>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${acr}\"/>\n                    <L7p:Expression2 stringValue=\"1\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"1\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"MQ==\"/>\n                    <L7p:DataType variableDataType=\"int\"/>\n                    <L7p:VariableToSet stringValue=\"token_rank\"/>\n                </L7p:SetVariable>\n            </wsp:All>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"MA==\"/>\n            <L7p:DataType variableDataType=\"int\"/>\n            <L7p:VariableToSet stringValue=\"token_rank\"/>\n        </L7p:SetVariable>\n    </wsp:All>\n</wsp:Policy>"
  }
}