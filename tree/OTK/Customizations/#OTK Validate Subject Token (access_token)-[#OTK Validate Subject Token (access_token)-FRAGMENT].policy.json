{
  "goid": "6739370b5f78f5d0126041fd5adb204e",
  "guid": "2cc01234-f3dc-447a-94a2-bcb11454a149",
  "name": "#OTK Validate Subject Token (access_token)",
  "policyType": "FRAGMENT",
  "checksum": "4556e5c55be30391bceb0812cf2ba19eacbc3da5",
  "folderPath": "/OTK/Customizations",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Policy Fragment: #OTK Validate Subject Token (access_token)\"/>\n        </L7p:CommentAssertion>\n        <L7p:ComparisonAssertion>\n            <L7p:Expression1 stringValue=\"${subject_token_type}\"/>\n            <L7p:Expression2 stringValue=\"urn:ietf:params:oauth:token-type:access_token\"/>\n            <L7p:Predicates predicates=\"included\">\n                <L7p:item binary=\"included\">\n                    <L7p:RightValue stringValue=\"urn:ietf:params:oauth:token-type:access_token\"/>\n                </L7p:item>\n            </L7p:Predicates>\n        </L7p:ComparisonAssertion>\n        <L7p:AddHeader>\n            <L7p:HeaderName stringValue=\"Authorization\"/>\n            <L7p:HeaderValue stringValue=\"\"/>\n            <L7p:Operation operation=\"REMOVE\"/>\n            <L7p:RemoveExisting booleanValue=\"true\"/>\n        </L7p:AddHeader>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"393bcb93-82ad-4b55-8333-1119f607a560\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Require OAuth 2.0 Token\"/>\n            <L7p:Parameters mapValue=\"included\">\n                <L7p:entry>\n                    <L7p:key stringValue=\"any_resource_required\"/>\n                    <L7p:value stringValue=\"false\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"cache_lifetime\"/>\n                    <L7p:value stringValue=\"30\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"custom\"/>\n                    <L7p:value stringValue=\"\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"disable_audience_check\"/>\n                    <L7p:value stringValue=\"true\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"disallow_query\"/>\n                    <L7p:value stringValue=\"false\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"given_access_token\"/>\n                    <L7p:value stringValue=\"${subject_token}\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"onetime\"/>\n                    <L7p:value stringValue=\"false\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"resource_required\"/>\n                    <L7p:value stringValue=\"\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"scope_fail\"/>\n                    <L7p:value stringValue=\"false\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"scope_required\"/>\n                    <L7p:value stringValue=\"\"/>\n                </L7p:entry>\n            </L7p:Parameters>\n        </L7p:Encapsulated>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uLnNjb3BlfQ==\"/>\n            <L7p:VariableToSet stringValue=\"scope.permitted\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uLmFjdF9jbGFpbX0=\"/>\n            <L7p:VariableToSet stringValue=\"act_claim\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uLm1heV9hY3RfY2xhaW19\"/>\n            <L7p:VariableToSet stringValue=\"may_act_claim\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHtzZXNzaW9uLnN1YnNjcmliZXJfaWR9\"/>\n            <L7p:VariableToSet stringValue=\"owner\"/>\n        </L7p:SetVariable>\n    </wsp:All>\n</wsp:Policy>"
  }
}