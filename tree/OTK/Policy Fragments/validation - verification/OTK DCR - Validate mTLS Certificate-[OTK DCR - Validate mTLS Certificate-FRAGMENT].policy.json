{
  "goid": "2ab3dd0e21ff9887303b082fa5fd93e7",
  "guid": "9cae1b04-2c0d-4b4c-97a1-4571458de987",
  "name": "OTK DCR - Validate mTLS Certificate",
  "policyType": "FRAGMENT",
  "checksum": "a00f325344fafd74d8afbfcdcaf307fc6229be9f",
  "folderPath": "/OTK/Policy Fragments/validation - verification",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"Policy Fragment: OTK Validate DCR - mTLS Certificate\"/>\n        </L7p:CommentAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:EncodeDecode>\n                    <L7p:CharacterEncoding stringValueNull=\"null\"/>\n                    <L7p:SourceVariableName stringValue=\"mtls_cert_base64\"/>\n                    <L7p:TargetDataType variableDataType=\"cert\"/>\n                    <L7p:TargetVariableName stringValue=\"mtls_cert\"/>\n                    <L7p:TransformType transformType=\"BASE64_DECODE\"/>\n                </L7p:EncodeDecode>\n                <L7p:Include>\n                    <L7p:PolicyGuid stringValue=\"d28b1029-386f-4d3d-9f83-cd06f16b4038\"/>\n                </L7p:Include>\n            </wsp:All>\n            <L7p:Encapsulated>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"LEFT.COMMENT\"/>\n                            <L7p:value stringValue=\"205\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"56bd8147-3ab4-4d09-9460-8b2de02b7a9e\"/>\n                <L7p:EncapsulatedAssertionConfigName stringValue=\"OTK Fail with error message\"/>\n                <L7p:Parameters mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"apiPrefix\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"custom\"/>\n                        <L7p:value stringValue=\"\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"givenErrorCode\"/>\n                        <L7p:value stringValue=\"205\"/>\n                    </L7p:entry>\n                </L7p:Parameters>\n            </L7p:Encapsulated>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>"
  }
}