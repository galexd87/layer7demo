{
  "goid": "0a88b3407d516d540e420ea353b48395",
  "guid": "0b4ee1df-e524-4595-93f4-afb9f7b47983",
  "name": "OTK Add or Update XML element",
  "policyType": "FRAGMENT",
  "checksum": "83bc77ed3c3848a019e1d034c4ed000e965a5c0d",
  "folderPath": "/OTK/Policy Fragments/pof",
  "soap": false,
  "policy": {
    "xml": "<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"Policy Fragment: OTK Add or Update XML element\"/>\n                        </L7p:CommentAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${ssa_element_json_path}\"/>\n                                <L7p:Expression2 stringValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                        <L7p:Operator operator=\"EMPTY\"/>\n                                        <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:EvaluateJsonPathExpressionV2>\n                                <L7p:Expression stringValue=\"${ssa_element_json_path}\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"ssa_json\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                                <L7p:VariablePrefix stringValue=\"ssa_element\"/>\n                            </L7p:EvaluateJsonPathExpressionV2>\n                            <L7p:TrueAssertion/>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${ssa_element.found}\"/>\n                                <L7p:Expression2 stringValue=\"false\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                        <L7p:Operator operator=\"EMPTY\"/>\n                                        <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:ComparisonAssertion>\n                                <L7p:Expression1 stringValue=\"${ssa_element.found}\"/>\n                                <L7p:Expression2 stringValue=\"false\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                        <L7p:RightValue stringValue=\"false\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <wsp:All wsp:Usage=\"Required\">\n                                <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                        <L7p:SetVariable>\n                                            <L7p:Base64Expression stringValue=\"JHtlbGVtZW50X3BhcmVudF9wYXRofS8ke2VsZW1lbnRfbmFtZX0=\"/>\n                                            <L7p:VariableToSet stringValue=\"elementPath\"/>\n                                        </L7p:SetVariable>\n                                        <L7p:ResponseXpathAssertion>\n                                            <L7p:VariablePrefix stringValue=\"elementXpath\"/>\n                                            <L7p:XmlMsgSrc stringValue=\"xml\"/>\n                                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                                <L7p:Expression stringValue=\"${elementPath}\"/>\n                                                <L7p:Namespaces mapValue=\"included\">\n                                                    <L7p:entry>\n                                                    <L7p:key stringValue=\"s\"/>\n                                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                                    </L7p:entry>\n                                                </L7p:Namespaces>\n                                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                            </L7p:XpathExpression>\n                                        </L7p:ResponseXpathAssertion>\n                                        <L7p:RemoveElement>\n                                            <L7p:ElementFromVariable stringValue=\"elementXpath.elements[0]\"/>\n                                            <L7p:ElementToInsertVariable stringValue=\"\"/>\n                                            <L7p:OtherTargetMessageVariable stringValue=\"xml\"/>\n                                            <L7p:Target target=\"OTHER\"/>\n                                        </L7p:RemoveElement>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                        <L7p:Properties mapValue=\"included\">\n                                            <L7p:entry>\n                                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                                <L7p:value stringValue=\"//Remove element if present\"/>\n                                            </L7p:entry>\n                                        </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:OneOrMore>\n                                <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"parentXpath\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                        <L7p:Expression stringValue=\"${element_parent_path}\"/>\n                                        <L7p:Namespaces mapValue=\"included\">\n                                            <L7p:entry>\n                                                <L7p:key stringValue=\"s\"/>\n                                                <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                            </L7p:entry>\n                                        </L7p:Namespaces>\n                                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                </L7p:ResponseXpathAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PCR7ZWxlbWVudF9uYW1lfT4ke3NzYV9lbGVtZW50LnJlc3VsdH08LyR7ZWxlbWVudF9uYW1lfT4=\"/>\n                                    <L7p:VariableToSet stringValue=\"addXML\"/>\n                                </L7p:SetVariable>\n                                <L7p:RemoveElement>\n                                    <L7p:ElementFromVariable stringValue=\"parentXpath.elements[0]\"/>\n                                    <L7p:ElementToInsertVariable stringValue=\"addXML\"/>\n                                    <L7p:InsertedElementLocation insertedElementLocation=\"FIRST_CHILD\"/>\n                                    <L7p:OtherTargetMessageVariable stringValue=\"xml\"/>\n                                    <L7p:Target target=\"OTHER\"/>\n                                </L7p:RemoveElement>\n                            </wsp:All>\n                        </wsp:OneOrMore>\n                        <L7p:ExportVariables>\n                            <L7p:ExportedVars stringArrayValue=\"included\">\n                                <L7p:item stringValue=\"xml\"/>\n                            </L7p:ExportedVars>\n                        </L7p:ExportVariables>\n                    </wsp:All>\n                </wsp:Policy>"
  }
}